<!DOCTYPE html>
<!-- saved from url=(0042)https://juejin.cn/post/6956793861570035742 -->
<html lang="zh" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22zh%22%7D%7D"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>如何用 Groovy 闭包优雅地 FP 编程？ - 掘金</title><meta data-n-head="ssr" name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, viewport-fit=cover"><meta data-n-head="ssr" name="apple-itunes-app" content="app-id=987739104"><meta data-n-head="ssr" name="theme-color" content="#ffffff"><meta data-n-head="ssr" name="msapplication-TileColor" content="#da532c"><meta data-n-head="ssr" vmid="description" name="description" content="和 Java 的函数式接口相比，Groovy 的闭包结合动态特性让人眼前一亮。文末通过一道线性规划题阐述了 Groovy 的优雅解决之道。"><meta data-n-head="ssr" vmid="keywords" name="keywords" content="Groovy"><link data-n-head="ssr" rel="preconnect" href="https://lf3-cdn-tos.bytescm.com/" crossorigin="anonymous"><link data-n-head="ssr" rel="preconnect" href="https://mcs.snssdk.com/" crossorigin="anonymous"><link data-n-head="ssr" rel="preconnect" href="https://i.snssdk.com/" crossorigin="anonymous"><link data-n-head="ssr" rel="dns-prefetch" href="https://lf3-cdn-tos.bytescm.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://api.juejin.cn/"><link data-n-head="ssr" rel="dns-prefetch" href="https://lf-cdn-tos.bytescm.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://unpkg.byted-static.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://p1-juejin.byteimg.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://p3-juejin.byteimg.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://p6-juejin.byteimg.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://p9-juejin.byteimg.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://p1-jj.byteimg.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://mcs.snssdk.com/"><link data-n-head="ssr" rel="dns-prefetch" href="https://i.snssdk.com/"><link data-n-head="ssr" rel="apple-touch-icon" sizes="180x180" href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web//static/favicons/apple-touch-icon.png"><link data-n-head="ssr" rel="icon" type="image/png" sizes="32x32" href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web//static/favicons/favicon-32x32.png"><link data-n-head="ssr" rel="icon" type="image/png" sizes="16x16" href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web//static/favicons/favicon-16x16.png"><link data-n-head="ssr" rel="mask-icon" href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web//static/favicons/safari-pinned-tab.svg" color="#1E80FF"><link data-n-head="ssr" rel="manifest" href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web//static/favicons/site.webmanifest"><link data-n-head="ssr" rel="search" title="掘金" href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web//static/search.xml" type="application/opensearchdescription+xml"><link data-n-head="ssr" rel="stylesheet" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/ionicons.min.css"><link data-n-head="ssr" rel="stylesheet" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/index.css"><link data-n-head="ssr" rel="stylesheet" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/iconfont.css"><link data-n-head="ssr" rel="stylesheet" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/bytedesign.min.css"><link data-n-head="ssr" rel="canonical" href="https://juejin.cn/post/6956793861570035742"><script async="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/browser.cn.js.下载" crossorigin="anonymous"></script><script async="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/analytics.js.下载"></script><script data-n-head="ssr" type="text/javascript" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/acrawler.js.下载"></script><style type="text/css" abt="234"></style><script data-n-head="ssr" vmid="slardar" type="text/javascript" crossorigin="anonymous">;(function (w, d, u, b, n, pc, ga, ae, po, s, p, e, t, pp) {pc = 'precollect';ga = 'getAttribute';ae = 'addEventListener';po = 'PerformanceObserver';s = function (m) {p = [].slice.call(arguments);p.push(Date.now(), location.href);(m == pc ? s.p.a : s.q).push(p)};s.q = [];s.p = { a: [] };w[n] = s;e = document.createElement('script');e.src = u + '?bid=' + b + '&globalName=' + n;e.crossOrigin = u.indexOf('sdk-web') > 0 ? 'anonymous' : 'use-credentials';d.getElementsByTagName('head')[0].appendChild(e);if (ae in w) {s.pcErr = function (e) {e = e || w.event;t = e.target || e.srcElement;if (t instanceof Element || t instanceof HTMLElement) {if (t[ga]('integrity')) {w[n](pc, 'sri', t[ga]('href') || t[ga]('src'))} else {w[n](pc, 'st', { tagName: t.tagName, url: t[ga]('href') || t[ga]('src') })}} else {w[n](pc, 'err', e.error || e.message)}};s.pcRej = function (e) {e = e || w.event;w[n](pc, 'err', e.reason || (e.detail && e.detail.reason))};w[ae]('error', s.pcErr, true);w[ae]('unhandledrejection', s.pcRej, true);};if('PerformanceLongTaskTiming' in w) {pp = s.pp = { entries: [] };pp.observer = new PerformanceObserver(function (l) {pp.entries = pp.entries.concat(l.getEntries())});pp.observer.observe({ entryTypes: ['longtask', 'largest-contentful-paint','layout-shift'] })}})(window,document,'https://lf3-short.ibytedapm.com/slardar/fe/sdk-web/browser.cn.js','2608','SlardarWeb')</script><script src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/browser.cn.js(1).下载" crossorigin="anonymous"></script><script data-n-head="ssr" type="application/ld+json">[{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://juejin.cn/post/6956793861570035742"},"headline":"如何用 Groovy 闭包优雅地 FP 编程？","description":"和 Java 的函数式接口相比，Groovy 的闭包结合动态特性让人眼前一亮。文末通过一道线性规划题阐述了 Groovy 的优雅解决之道。","image":["https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aa49eeb1a77746e7a02189e2b347c103~tplv-k3u1fbpfcp-watermark.image"],"author":{"@type":"Organization","name":"花花子"},"publisher":{"@type":"Organization","name":"掘金","logo":{"@type":"ImageObject","url":"//lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web/e08da34488b114bd4c665ba2fa520a31.svg"}},"datePublished":"2021年04月30日","dateModified":"2021年05月06日"},{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","name":"稀土掘金","position":1,"item":"https://juejin.cn"},{"@type":"ListItem","name":"后端","position":2,"item":"https://juejin.cn/backend"},{"@type":"ListItem","name":"文章","position":3}]}]</script><link rel="preload" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/1962f0f.js.下载" as="script"><link rel="preload" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/2d95a65.js.下载" as="script"><link rel="preload" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/4809dd4.js.下载" as="script"><link rel="preload" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/app.89b9488.css" as="style"><link rel="preload" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/def72f5.js.下载" as="script"><link rel="preload" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/default.2050f18.css" as="style"><link rel="preload" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/7e1140b.js.下载" as="script"><link rel="preload" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/51.8344ef6.css" as="style"><link rel="preload" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/7b24b05.js.下载" as="script"><link rel="preload" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/198.3d69a3b.css" as="style"><link rel="preload" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/8abf2a2.js.下载" as="script"><link rel="stylesheet" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/app.89b9488.css"><link rel="stylesheet" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/default.2050f18.css"><link rel="stylesheet" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/51.8344ef6.css"><link rel="stylesheet" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/198.3d69a3b.css">
  <script charset="utf-8" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/d515672.js.下载"></script><script charset="utf-8" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/9140e03.js.下载"></script><script charset="utf-8" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/e7d967e.js.下载"></script><script charset="utf-8" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/0d7c96c.js.下载"></script><script>//remove baidu search ad
var _countAA = 0
function doBBBd(){}
doBBBd()
document.addEventListener('keyup', function(){_countAA-=10;doBBBd()}, false)
document.addEventListener('click', function(){_countAA-=10;doBBBd()}, false)

</script><style>hcfy-result.__hcfy__result__loaded__.__hcfy__result__both__{border: 1px dotted}</style><link rel="preload" as="style" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/134.092fb39.css"><script charset="utf-8" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/5b24037.js.下载"></script><link rel="preload" as="style" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/177.290e99d.css"><script charset="utf-8" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/0746dfa.js.下载"></script><style type="text/css">.code-editor-container{display:block;position:relative;overflow:hidden;box-sizing:border-box;}iframe.code-editor-frame{width:100%;height:100%;border:none;border-radius:8px;box-sizing:border-box;border:0.5px solid rgba(128,128,128,0.4);}</style><script charset="utf-8" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/1fa3a18.js.下载"></script><link rel="preload" as="style" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/22.f94fff0.css"><script charset="utf-8" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/9cb583c.js.下载"></script><link rel="preload" as="style" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/36.6f090be.css"><script charset="utf-8" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/df588cb.js.下载"></script><script src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/monitors.3.7.0.cn.js.下载" async="" crossorigin="anonymous"></script><script src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/sentry.3.7.0.cn.js.下载" async="" crossorigin="anonymous"></script><script src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/common-monitors.1.1.8.js.下载" crossorigin="anonymous"></script><link rel="preload" as="style" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/153.4faa841.css"><script charset="utf-8" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/aeca132.js.下载"></script><link rel="preload" as="style" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/9.4cd501f.css"><link rel="preload" as="style" href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/83.ca68669.css"><script charset="utf-8" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/e1babf3.js.下载"></script></head>
  <body>
    <div id="__nuxt"><div id="__layout"><div id="juejin"><!----> <div class="view-container" data-v-4b9f9746="" data-v-020666e8=""><div class="main-header-box" data-v-4b9f9746=""><header visible="visible" data-fetch-key="0" class="main-header main-header unauthorized visible" data-v-62a2b6bf="" data-v-4b9f9746=""><div class="container" data-v-62a2b6bf=""><a href="https://juejin.cn/" class="logo" data-v-62a2b6bf=""><img src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/e08da34488b114bd4c665ba2fa520a31.svg" alt="稀土掘金" class="logo-img" data-v-62a2b6bf=""> <img src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/6c61ae65d1c41ae8221a670fa32d05aa.svg" alt="稀土掘金" class="mobile" data-v-62a2b6bf=""></a> <!----> <!----> <nav role="navigation" class="main-nav" data-v-62a2b6bf=""><ul class="nav-list" data-v-62a2b6bf=""><!----> <li class="main-nav-list" data-v-62a2b6bf=""><div class="phone-show-menu isResourceVisible" data-v-62a2b6bf=""><span data-v-62a2b6bf="">首页</span> <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" class="unfold16-icon" data-v-62a2b6bf=""><path d="M2.45025 4.82431C2.17422 4.49957 2.40501 4.00049 2.83122 4.00049H9.16878C9.59498 4.00049 9.82578 4.49957 9.54975 4.82431L6.38097 8.55229C6.1813 8.78719 5.8187 8.78719 5.61903 8.55229L2.45025 4.82431Z" data-v-62a2b6bf=""></path></svg></div> <ul class="phone-hide isResourceVisible" data-v-62a2b6bf=""><li class="nav-item link-item route-active" data-v-62a2b6bf=""><a href="https://juejin.cn/" data-v-62a2b6bf="">首页</a></li> <li class="nav-item link-item activities" data-v-62a2b6bf=""><a href="https://juejin.cn/pins" data-v-62a2b6bf=""><span class="text" data-v-62a2b6bf="">
                  沸点
                  <span data-v-62a2b6bf="" class="tablead">
                      嘉年华
                    </span></span></a></li> <li class="nav-item link-item book" data-v-62a2b6bf=""><a href="https://juejin.cn/course" data-v-62a2b6bf="">
                课程
                </a></li> <li class="nav-item link-item" data-v-62a2b6bf=""><a href="https://juejin.cn/live" data-v-62a2b6bf="">直播</a></li> <li class="nav-item link-item" data-v-62a2b6bf=""><a href="https://juejin.cn/events/all" data-v-62a2b6bf="">活动</a></li> <nav class="nav-item link-item" data-v-62a2b6bf=""><a href="https://detail.youzan.com/show/goods/newest?kdt_id=104340304" target="_blank" rel="nofollow noopener noreferrer" class="nav-item link-item no-border" data-v-62a2b6bf=""><span data-v-62a2b6bf="">商城</span></a> <!----></nav> <nav class="nav-item link-item download-icon isResourceVisible" data-v-62a2b6bf=""><a href="https://juejin.cn/app?utm_source=jj_nav" target="_blank" class="download-app no-border" data-v-62a2b6bf="">
                APP
              </a> <span data-v-62a2b6bf="" class="tablead">邀请有礼</span></nav> <nav class="nav-item link-item extension-icon" data-v-62a2b6bf=""><a href="https://juejin.cn/extension?utm_source=jj_nav" target="_blank" rel="nofollow noopener noreferrer" class="broswer-extension no-border isResourceVisible" data-v-62a2b6bf=""><span data-v-62a2b6bf="">插件</span></a></nav> <li tag="li" class="nav-item link-item" data-v-62a2b6bf=""><a target="_blank" href="https://juejin.cn/challenge/1?utm_source=web_nav" class="activity no-hover special-activity" data-v-62a2b6bf=""><img src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/759e2aa805c0461b840e0f0f09ed05fa_tplv-k3u1fbpfcp-zoom-1.image" style="max-width: 115px; vertical-align: middle" data-v-62a2b6bf=""></a></li></ul></li> <ul class="right-side-nav" data-v-62a2b6bf=""><li class="search-add" data-v-62a2b6bf=""><ul class="search-add-ul isResourceVisible" data-v-62a2b6bf=""><li class="nav-item search" data-v-62a2b6bf=""><form role="search" class="search-form isResourceVisible" data-v-62a2b6bf=""><input type="search" maxlength="32" placeholder="探索稀土掘金" value="" class="search-input isResourceVisible" data-v-62a2b6bf=""> <div class="seach-icon-container" data-v-62a2b6bf=""><img src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/1e8ab9a22f0ddc36349f60b38900d0bd.svg" alt="搜索" class="search-icon" data-v-62a2b6bf=""></div> <div class="typehead" style="display:none;" data-v-62a2b6bf=""><!----> <div class="title" data-v-62a2b6bf=""><span data-v-62a2b6bf="">搜索历史</span> <span class="clear" data-v-62a2b6bf="">
                        清空
                      </span></div> <div class="list" data-v-62a2b6bf=""><div data-v-62a2b6bf="">
                        TV
                      </div><div data-v-62a2b6bf="">
                        dataBinding
                      </div><div data-v-62a2b6bf="">
                        Compose desktop
                      </div><div data-v-62a2b6bf="">
                        flutter web
                      </div><div data-v-62a2b6bf="">
                        window 11
                      </div><div data-v-62a2b6bf="">
                        爬虫
                      </div></div></div></form></li> <li class="nav-item add creator-item" data-v-62a2b6bf=""><div class="add-group" data-v-3a3133c9="" data-v-62a2b6bf=""><!----> <button class="add-btn" data-v-3a3133c9="">
    创作者中心
  </button> <div class="more" data-v-3a3133c9=""><svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" class="unfold12-icon" data-v-3a3133c9=""><path d="M2.45025 4.82383C2.17422 4.49908 2.40501 4 2.83122 4H9.16878C9.59499 4 9.82578 4.49908 9.54975 4.82382L6.38097 8.5518C6.1813 8.7867 5.8187 8.7867 5.61903 8.5518L2.45025 4.82383Z" fill="white" data-v-3a3133c9=""></path></svg></div> <ul class="more-list" data-v-3a3133c9=""><li class="item" data-v-3a3133c9=""><span class="icon write-article" data-v-3a3133c9="">写文章</span></li><li class="item" data-v-3a3133c9=""><span class="icon issue-points" data-v-3a3133c9="">发沸点</span></li><li class="item" data-v-3a3133c9=""><span class="icon write-note" data-v-3a3133c9="">写笔记</span></li><li class="item" data-v-3a3133c9=""><span class="icon create-jcode" data-v-3a3133c9="">写代码</span></li><li class="item" data-v-3a3133c9=""><span class="icon drafts" data-v-3a3133c9="">草稿箱</span></li></ul> <!----> </div></li></ul></li> <!----> <li class="nav-item vip-entry" data-v-62a2b6bf=""><div class="vip-title" data-v-62a2b6bf=""><img src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/24127194d5b158d7eaf8f09a256c5d01.svg" alt="vip" class="vip-img" data-v-62a2b6bf=""> <div class="vip-words" data-v-62a2b6bf="">会员</div></div> <div class="vip-content" style="display:none;" data-v-62a2b6bf=""><img src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/a0ef799e93fdbfcffe8553ecf2beb5ba.svg" alt="doll" class="icon" data-v-62a2b6bf=""> <div class="content" data-v-62a2b6bf=""><span data-v-62a2b6bf="">掘金会员，新权益到账啦~!</span> <span data-v-62a2b6bf="">字节内部课程，VIP免费学习</span></div> <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="close" data-v-62a2b6bf=""><path d="M14.3029 3.69629L8.99959 8.99957L3.69629 14.3029" stroke="#8A919F" stroke-width="1.5" stroke-linecap="round" data-v-62a2b6bf=""></path><path d="M3.69629 3.69629L8.99959 8.99957L14.3029 14.3029" stroke="#8A919F" stroke-width="1.5" stroke-linecap="round" data-v-62a2b6bf=""></path></svg> <img src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/fef2eb8d28949cc43248bad54cb1579a.svg" class="mask" data-v-62a2b6bf=""></div></li> <!----> <!----> <li class="nav-item auth" data-v-62a2b6bf=""><div class="login-button-wrap" data-v-62a2b6bf=""><button class="login-button" data-v-62a2b6bf="">
                登录
                <div data-v-62a2b6bf="" class="login-button-inner"><div data-v-62a2b6bf="" class="login-button-line"></div>
                  注册
                </div></button> <div data-v-62a2b6bf="" class="login-popover"><div data-v-69807493="" data-v-62a2b6bf="" class="login-guide-wrap login-guide-popover-wrap"><!----> <div data-v-69807493="" class="login-guide-title">登录掘金后可立即获得以下权益：</div> <ul data-v-69807493="" class="login-guide-list"><li data-v-69807493="" class="login-guide-list-item"><div data-v-69807493="" class="login-guide-icon-wrap"><svg data-v-69807493="" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="login-guide-icon"><path data-v-69807493="" d="M4.62218 2.68165C3.64897 2.29236 2.59033 3.0091 2.59033 4.05728V13.961C2.59033 14.2639 2.77476 14.5363 3.05601 14.6488L8.88416 16.98C9.59939 17.2661 10.3973 17.2661 11.1125 16.98L16.9406 14.6488C17.2219 14.5363 17.4063 14.2639 17.4063 13.961V4.05728C17.4063 3.0091 16.3477 2.29236 15.3745 2.68165L11.1125 4.38644C10.3973 4.67253 9.59939 4.67253 8.88416 4.38644L4.62218 2.68165Z" stroke="currentColor" stroke-width="1.2"></path><path data-v-69807493="" d="M9.99609 7.42676V14.094" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"></path></svg></div> <span data-v-69807493="" class="login-guide-text">免费试学课程</span></li><li data-v-69807493="" class="login-guide-list-item"><div data-v-69807493="" class="login-guide-icon-wrap"><svg data-v-69807493="" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="login-guide-icon"><path data-v-69807493="" fill-rule="evenodd" clip-rule="evenodd" d="M8.99999 3.37781L7.26101 6.9014C7.15913 7.10768 6.96219 7.25119 6.73392 7.28433L2.84544 7.84938L5.65897 10.5919C5.65903 10.592 5.6589 10.5919 5.65897 10.5919C5.82418 10.7529 5.89936 10.9849 5.8605 11.2116L5.19624 15.0845L8.67423 13.256C8.87818 13.1488 9.12181 13.1488 9.32576 13.256L12.8037 15.0845L12.1395 11.2117C12.1006 10.9849 12.1756 10.7531 12.3408 10.5921C12.3409 10.592 12.3408 10.5922 12.3408 10.5921L15.1545 7.84938L11.2663 7.28437C11.038 7.25122 10.8409 7.10782 10.739 6.90153L8.99999 3.37781ZM9.26883 2.83308C9.26888 2.83298 9.26878 2.83318 9.26883 2.83308V2.83308ZM9.62775 2.39022C9.37097 1.86993 8.62901 1.86993 8.37224 2.39022L6.43408 6.3174L2.10014 6.94718C1.52608 7.03061 1.29661 7.73615 1.71217 8.14119C1.71216 8.14118 1.71219 8.14121 1.71217 8.14119L4.84822 11.1981L4.10789 15.5145C4.00989 16.0863 4.61 16.5224 5.12357 16.2525L8.99999 14.2145L12.8764 16.2525C13.3899 16.5224 13.9901 16.0863 13.8921 15.5146L13.1518 11.1981L16.2877 8.14126C16.7035 7.73618 16.4739 7.0306 15.8999 6.94718L11.5659 6.3174L9.62775 2.39022ZM4.96134 11.3084C4.96141 11.3084 4.96128 11.3083 4.96134 11.3084V11.3084Z" fill="currentColor"></path></svg></div> <span data-v-69807493="" class="login-guide-text">收藏有用文章</span></li><li data-v-69807493="" class="login-guide-list-item"><div data-v-69807493="" class="login-guide-icon-wrap"><svg data-v-69807493="" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="login-guide-icon"><path data-v-69807493="" fill-rule="evenodd" clip-rule="evenodd" d="M12.1337 10.5801C12.4205 10.5801 12.653 10.8125 12.653 11.0993V11.8658H13.4194C13.7062 11.8658 13.9387 12.0983 13.9387 12.385C13.9387 12.6718 13.7062 12.9043 13.4194 12.9043H12.1337C11.847 12.9043 11.6145 12.6718 11.6145 12.385V11.0993C11.6145 10.8125 11.847 10.5801 12.1337 10.5801Z" fill="currentColor"></path><path data-v-69807493="" fill-rule="evenodd" clip-rule="evenodd" d="M2.05225 4.64889C2.05225 3.21507 3.21458 2.05273 4.6484 2.05273H11.4231C12.8569 2.05273 14.0193 3.21507 14.0193 4.64889V9.32197H12.9808V4.64889C12.9808 3.7886 12.2834 3.0912 11.4231 3.0912H4.6484C3.78811 3.0912 3.09071 3.7886 3.09071 4.64889V13.3522C3.09071 14.2125 3.78811 14.9099 4.6484 14.9099H12.2143V15.9483H4.6484C3.21459 15.9483 2.05225 14.786 2.05225 13.3522V4.64889Z" fill="currentColor"></path><path data-v-69807493="" fill-rule="evenodd" clip-rule="evenodd" d="M12.214 9.51893C10.7255 9.51893 9.51893 10.7255 9.51893 12.214C9.51893 13.7024 10.7255 14.909 12.214 14.909C13.7024 14.909 14.909 13.7024 14.909 12.214C14.909 10.7255 13.7024 9.51893 12.214 9.51893ZM8.48047 12.214C8.48047 10.152 10.152 8.48047 12.214 8.48047C14.2759 8.48047 15.9475 10.152 15.9475 12.214C15.9475 14.2759 14.2759 15.9475 12.214 15.9475C10.152 15.9475 8.48047 14.2759 8.48047 12.214Z" fill="currentColor"></path><path data-v-69807493="" fill-rule="evenodd" clip-rule="evenodd" d="M4.82129 5.4372C4.82129 5.15044 5.05376 4.91797 5.34052 4.91797L10.7306 4.91797C11.0174 4.91797 11.2499 5.15044 11.2499 5.4372C11.2499 5.72396 11.0174 5.95643 10.7306 5.95643L5.34052 5.95643C5.05376 5.95643 4.82129 5.72396 4.82129 5.4372Z" fill="currentColor"></path><path data-v-69807493="" fill-rule="evenodd" clip-rule="evenodd" d="M4.78394 8.35712C4.78394 8.07035 5.01641 7.83789 5.30317 7.83789L8.03531 7.83791C8.32208 7.83791 8.55454 8.07038 8.55454 8.35715C8.55454 8.64391 8.32207 8.87637 8.03531 8.87637L5.30316 8.87635C5.0164 8.87635 4.78393 8.64388 4.78394 8.35712Z" fill="currentColor"></path></svg></div> <span data-v-69807493="" class="login-guide-text">查阅浏览足迹</span></li><li data-v-69807493="" class="login-guide-list-item"><div data-v-69807493="" class="login-guide-icon-wrap"><svg data-v-69807493="" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="login-guide-icon"><path data-v-69807493="" fill-rule="evenodd" clip-rule="evenodd" d="M5.21627 3.23729H2.91894L2.91894 14.2645H5.21627V3.23729ZM2.91894 2.31836C2.41142 2.31836 2 2.72978 2 3.23729V14.2645C2 14.772 2.41142 15.1835 2.91894 15.1835H5.21627C5.72379 15.1835 6.13521 14.772 6.13521 14.2645V3.23729C6.13521 2.72978 5.72379 2.31836 5.21627 2.31836H2.91894Z" fill="currentColor"></path><path data-v-69807493="" fill-rule="evenodd" clip-rule="evenodd" d="M8.43258 3.23729H6.13524L6.13524 14.2645H8.43258V3.23729ZM6.13524 2.31836C5.62773 2.31836 5.21631 2.72978 5.21631 3.23729V14.2645C5.21631 14.772 5.62773 15.1835 6.13524 15.1835H8.43258C8.9401 15.1835 9.35152 14.772 9.35152 14.2645V3.23729C9.35152 2.72978 8.9401 2.31836 8.43258 2.31836H6.13524Z" fill="currentColor"></path><path data-v-69807493="" fill-rule="evenodd" clip-rule="evenodd" d="M12.0205 3.1255L9.80149 3.7201L12.6555 14.3716L14.8746 13.777L12.0205 3.1255ZM9.56365 2.83247C9.07343 2.96383 8.78251 3.46772 8.91386 3.95794L11.7679 14.6094C11.8993 15.0996 12.4032 15.3906 12.8934 15.2592L15.1124 14.6646C15.6027 14.5333 15.8936 14.0294 15.7622 13.5391L12.9082 2.88767C12.7768 2.39744 12.2729 2.10653 11.7827 2.23788L9.56365 2.83247Z" fill="currentColor"></path></svg></div> <span data-v-69807493="" class="login-guide-text">订阅优质专栏</span></li><li data-v-69807493="" class="login-guide-list-item"><div data-v-69807493="" class="login-guide-icon-wrap"><svg data-v-69807493="" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="login-guide-icon"><path data-v-69807493="" fill-rule="evenodd" clip-rule="evenodd" d="M13.2368 3.03451C12.587 2.18471 11.3966 2.05398 10.5779 2.74252L8.99865 4.07065L7.41943 2.74252C6.60071 2.05398 5.41026 2.18471 4.76048 3.03451C4.40851 3.49484 4.28737 4.07174 4.38041 4.61328H3.42708C2.6907 4.61328 2.09375 5.21023 2.09375 5.94661V7.78026C2.09375 8.50852 2.67761 9.10041 3.40278 9.11338V14.285C3.40278 15.3896 4.29821 16.285 5.40278 16.285H12.5945C13.6991 16.285 14.5945 15.3896 14.5945 14.285V9.11342C15.3209 9.10187 15.9062 8.50942 15.9062 7.78026V5.94661C15.9062 5.21024 15.3093 4.61328 14.5729 4.61328H13.6169C13.7099 4.07174 13.5888 3.49484 13.2368 3.03451ZM12.61 4.61328C12.7209 4.3068 12.6796 3.95035 12.4715 3.67815C12.1572 3.26708 11.5813 3.20384 11.1853 3.53691L9.90541 4.61328H12.61ZM8.09189 4.61328L6.81202 3.53691C6.41598 3.20384 5.84013 3.26708 5.52581 3.67815C5.31768 3.95035 5.27642 4.3068 5.38727 4.61328H8.09189ZM3.09375 5.94661C3.09375 5.76252 3.24299 5.61328 3.42708 5.61328H8.49863V8.11359H3.42708C3.24299 8.11359 3.09375 7.96435 3.09375 7.78026V5.94661ZM9.49863 8.11359V5.61328H14.5729C14.757 5.61328 14.9062 5.76252 14.9062 5.94661V7.78026C14.9062 7.96435 14.757 8.11359 14.5729 8.11359H9.49863ZM4.40278 9.11719H8.49863L8.49863 15.285H5.40278C4.85049 15.285 4.40278 14.8373 4.40278 14.285V9.11719ZM9.49863 9.11719L9.49863 15.285H12.5945C13.1468 15.285 13.5945 14.8373 13.5945 14.285V9.11719H9.49863Z" fill="currentColor"></path></svg></div> <span data-v-69807493="" class="login-guide-text">体验签到抽奖</span></li><li data-v-69807493="" class="login-guide-list-item"><div data-v-69807493="" class="login-guide-icon-wrap"><svg data-v-69807493="" width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg" class="user-level-icon login-guide-icon"><path data-v-69807493="" d="M17.2673 10.1562H19.7673V12.6562" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path data-v-69807493="" d="M8.5625 8.25V18.375C8.5625 18.9273 9.01022 19.375 9.5625 19.375H20.4375" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path data-v-69807493="" d="M10.5625 16.0938L13.888 12.36L16.0216 14.2603L18.9739 10.9455" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <span data-v-69807493="" class="login-guide-text">提升成长等级</span></li></ul> <button data-v-69807493="" type="button" class="login-guide-login-button byte-btn byte-btn--primary byte-btn--normal"><!----><!----><span>
    立即登录
  </span></button> <div data-v-69807493="" class="login-guide-register">
    首次使用？
    <div data-v-69807493="" class="login-guide-register-button">
      点我注册
    </div></div></div></div></div></li></ul></ul></nav></div> <!----></header></div>  <main class="container main-container" style="max-width:1140px;" data-v-4b9f9746=""><div class="view column-view" data-v-4b9f9746="" data-v-020666e8=""><div class="main-area article-area" data-v-4b9f9746="" data-v-020666e8=""><article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="6956793861570035742" data-draft-id="6956791929593921567" data-original-type="0" class="article" data-v-020666e8="" data-v-4b9f9746=""><!----> <meta itemprop="headline" content="如何用 Groovy 闭包优雅地 FP 编程？"> <meta itemprop="keywords" content="Groovy"> <meta itemprop="datePublished" content="2021-04-30T03:58:34.000Z"> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="花花子"> <meta itemprop="url" content="https://juejin.cn/user/465848663023160"></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"> <meta itemprop="width" content="180"> <meta itemprop="height" content="180"></div></div> <h1 class="article-title" data-v-020666e8="">
            如何用 Groovy 闭包优雅地 FP 编程？
            <!----></h1> <div class="author-info-block" data-v-020666e8=""><a href="https://juejin.cn/user/465848663023160" target="_blank" rel="" class="avatar-link" data-v-020666e8=""><img loading="eager" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/2c3d36ac68756ea7f747669b94554d42_100x100.awebp" alt="" class="lazy avatar avatar" data-v-248050e4="" data-v-47508ed8="" data-v-020666e8=""></a> <div class="author-info-box" data-v-020666e8=""><div class="author-name" data-v-020666e8=""><a href="https://juejin.cn/user/465848663023160" target="_blank" rel="" class="username username ellipsis" data-v-0ef8bafa="" data-v-020666e8=""><span class="name" style="max-width:128px;" data-v-0ef8bafa="">
    花花子
  </span> <span blank="true" class="rank" data-v-3de16c56="" data-v-0ef8bafa=""><img src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/lv-4.a78c420.png" alt="lv-4" title="创作等级" data-v-3de16c56=""></span> <!----> <div class="vip-level" data-v-38a29e30="" data-v-0ef8bafa=""><span class="tooltip" data-v-38a29e30=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.4 融会贯通
      </div><span class="byte-tooltip__wrapper"><img src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/07302452a7ad81cb43a173b5cd580237.svg" alt="" data-v-38a29e30=""></span></span></div> </a> <!----></div> <div class="meta-box" data-v-020666e8=""><time datetime="2021-04-30T03:58:34.000Z" title="Fri Apr 30 2021 11:58:34 GMT+0800 (China Standard Time)" class="time" data-v-020666e8="">
                    2021年04月30日 11:58
                  </time> <span class="views-count" data-v-020666e8="">
                    ·&nbsp;&nbsp;阅读 1024
                  </span> <!----></div> <!----></div> <button class="follow-button follow" data-v-565dd611="" data-v-020666e8=""><span class="icon icon-follow" data-v-565dd611=""></span> <span data-text="取消关注" class="text" data-v-565dd611="">关注</span></button></div> <img loading="eager" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/aa49eeb1a77746e7a02189e2b347c103_tplv-k3u1fbpfcp-zoom-crop-mark_3024_3024_3024_1702.awebp" alt="如何用 Groovy 闭包优雅地 FP 编程？" class="lazy article-hero" data-v-248050e4="" data-v-020666e8=""> <!----> <!----> <div itemprop="articleBody" class="article-content" data-v-020666e8=""><div class="markdown-body cache"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;margin-bottom:5px}.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{font-size:20px}.markdown-body h2{padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre>code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote>p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><h1 data-id="heading-0">4. 闭包</h1>
<p>闭包的通俗解释，就是内部状态与外部隔离，仅通过参数列表和返回值与外界进行交互的<strong>高阶函数</strong>，用于保护内部的函数不受外界影响。其概念派生自 Lambda 表达式。对于 Java 这类 OOP 语言来说，"闭包" 的概念则被 "类" 所代替：闭包的局部变量变成了 "属性"，而内部函数变成了 "方法"。方法的结果往往取决于属性，而属性又通常是不对外开放的 ( <code>private </code> )。</p>
<p>FP 的一些基本概念或术语，笔者其实主要是从 Scala 的角度切入的。详情见：<a href="https://juejin.cn/post/6886336268385550349" target="_blank" title="https://juejin.cn/post/6886336268385550349">Scala 之：函数式编程之始</a></p>
<h2 data-id="heading-1">4.1 Groovy 中的闭包</h2>
<p>Groovy 允许我们以函数式风格使用闭包 ( 至少看起来是那样 ) 并在各处传递。换句话说，Groovy 也支持函数式编程 FP，并具备所有 FP 应当具备的特性。我们在 Java 中曾感慨过 Lambda 表达式的简洁，而在 Groovy 中，它已是家常便饭。假定我们想自定义一个对数组进行遍历操作的 <code>foreach</code> 函数，该函数对内部的元素操作取决于传入的闭包 <code>action</code>：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">nums = 1..10

// 这段代码完全没有声明任何类型，我好像在写 javaScript.......
void foreach(nums ,action){
    for(i in nums){
        // 这个传入的 i 就是 i-&gt; print "${i}" 当中的那个 i。
        action(i)
    }
}

foreach(nums,{i -&gt; print "${i} "})
<span class="copy-code-btn">复制代码</span></code></pre>
<p>前面的文章曾提到过，如果参数列表的最后几个参数是闭包，可以选择性的将这些闭包移动到函数调用后面，英语老师管这种表达方法叫 "定语后置"。尤其是当闭包较长时，这种表述方式要更加优雅。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">//对那个数组进行 foreach 操作 | 怎么操作
foreach(nums) {i -&gt; print "${i} "}

foreach(nums) {
	i-&gt;
	print i
	print "当闭包很长时，这种写法看起来可读性更高"
	print "这个写法已经很接近平日所用的 for-each 循环了。"
	print "这就是闭包后置带来的惊喜。"
}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>甚至可以再抽象一点，将 <code>nums</code> 数组本身也看作是一个 <code>{()-&gt;nums}</code> 的闭包：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">static foreach(nums,action){
    // nums() 表示它是一个 ()-&gt;nums 的 supplyer.
    def seq = nums()
    for(i in seq) {action(i)}
}
// {nums} 实际上是 {-&gt;nums}，这里可以省略掉 -&gt; 箭头。
foreach {nums} {i-&gt;print("${i} ")}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>在这个例子中，我们隐约能感受到由 Groovy 创建出的 DSL 将是何其优雅而强大。其中，<code>foreach</code> 接收 <code>action</code> 闭包 ( 也可以称作是函数 )，因此 <code>foreach</code> 也被称作是<strong>高阶函数</strong> 。高阶函数的更直接解释是：一个接收函数，或者是返回另一个函数的函数。</p>
<p>在 Java 中，一个 Lambda 表达式的写法是这样的：<code>(...) -&gt; {...}</code>，即便在没有任何参数的情况下，也得写成 <code>()-&gt;{...}</code> 的形式。而在 Groovy 中，闭包的参数不需要小括号括起来，形式上类似 <code>{ p1,p2 -&gt;...}</code> 。</p>
<p>当这个闭包不需要任何参数时，写法形如 <code>{ -&gt; ...}</code>，或者是省略掉箭头符号而直接写成 <code>{...}</code> 。</p>
<p>小小的特殊情况：如果闭包只需要一个参数，我们就可以在内部以 <code>it</code> 来称呼它，然后忽略掉参数命名和小箭头。比如：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">// {i -&gt; print{"${i}"} =====&gt; {print "${it}"}
// foreach nums, print it. 
foreach {nums} {print("${it} ")}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>需要注意的是，如果闭包确实没有接收参数，但是写法却形如 <code>{...}</code>，那么 Groovy 还是会隐式地赋予这个闭包一个值为 <code>null</code> 的 <code>it</code> 参数。这会影响到程序在运行期对闭包的动态判断，见后文的动态闭包。</p>
<p>闭包的参数可以声明严格的类型，比如：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">foreach {nums} {Integer i -&gt; print "${i} "}
<span class="copy-code-btn">复制代码</span></code></pre>
<h2 data-id="heading-2">4.2  Execute Around Method &amp; AOP</h2>
<p>在 JVM 语言当中，只要我们能够将不需要的对象标记为不可达，那么它们就可以在适当的时机被 GC 回收。但是在 I/O 密集型任务中，我们希望 InputStream 和 OutputStream 在完成任务之后<strong>马上关闭</strong>，否则它们占据的文件句柄就仍然会在 GC 主动回收之前一直处于打开状态。</p>
<p>这也是为什么 Java ( 以及其它语言的 ) I/O 工具要设计 <code>close()</code> 或者是 <code>destory()</code> 这样的方法。然而，偶尔我们可能过分专注于功能业务，而忘记主动地调用这些方法 ......</p>
<p>这种琐碎的劳动不如交给程序来解决。假定所有需要主动关闭的资源都实现了 <code>MustClosed()</code> 接口：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">interface MustClosed {
    def close()
}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>然后，定义一个高阶函数，它接收 <code>MustClosed</code> 的实现类，并保证总是在最后调用其 <code>close()</code> 方法关闭资源，无论在使用过程中是否发生异常。至于使用这个 <code>MustClosed</code> 资源的具体细节，将它封装到另一个闭包 <code>action</code> 当中。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">// r 指 Resource,指必须要主动关闭的 I/O 型资源。
def static safeUse(MustClosed r, action) {
    try{
        action(r)
    }catch (Exception e){
        e.printStackTrace()
    }finally{
        r.close()
        print "${r.getClass().typeName} 实例已经被关闭。"
    }
}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>一个简单的测试：自定义一个 <code>MustClosed</code> 的简单实现，传入 <code>safeUse</code> 函数当中观察控制台的打印顺序：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">MustClosed resource = [
        close: { println "doing close()..." }
] as MustClosed

def action = { MustClosed r -&gt;
    println "use resource r to do something..."
}

// 演示了如何调用一个闭包变量
safeUse(re) {action(re)}

/*
	等价于... 这里的 re 和 r 其实都指代一个引用。
	safeUse(re){
		MustClosed r -&gt;
			println "use resource r to do something..."
	}	

*/
<span class="copy-code-btn">复制代码</span></code></pre>
<p>一个更加真实的测试：将 Java 提供的 <code>OutputStream</code> 视作是一个 <code>MustClosed</code> 的实现类传入进去，然后感受一下：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">fos = new FileOutputStream(new File("README.md"))

// 依赖于 Groovy 的动态类型判断
safeUse(fos as MustClosed){r -&gt; r.write("Groovy!".bytes)}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>现在，我们无需再手动关闭传入的各种 I/O 资源，<code>safeUse</code> 会帮助搞定一切。诸如这种闭包的使用风格就是 Execute Around Method ( 环绕执行 ) 模式。把思维再发散一些，假设我们在完成一系列业务之前和之后总是要进行一些重复处理，则可以利用这种模式设计出一个模板，只需要替换掉中间不一样的业务。</p>
<p>这种方式有点似曾相识 ...... 直觉是正确的。它的设计理念和 Spring 框架中的面向切面编程 AOP 没有什么不同，凡是支持 FP 的语言都可以通过环绕执行模式来实现切面化编程。</p>
<h2 data-id="heading-3">4.3 可利用闭包自动清理资源</h2>
<p>Groovy 鉴于 I/O 资源类工具的这些 "痛点" 给出了相当体面的实现：它在原有的 I/O 工具类的基础上做了一些包装，我们可以在 FileOutputStream / FileInputStream 工具中，直接调用 <code>withWriter</code> 或者 <code>withReader</code> ( 字符操作 )，<code>withStream</code> ( 字节操作 ) 方法，并直接以闭包的形式告知 FileOutputStream 或者是 FileInputStream 作为 Reader / Writer / Stream 处理数据，并免去原来的装饰者模式带来的一个副作用 —— 不断地创建包装对象。在执行完之后，I/O流会自行关闭。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">f = new File("README.md")
assert f.exists()

fos = new FileOutputStream(f)
String data = """{
    status:200,
    msg:"ok"
}
"""

// need no more fuxking close() and flush()
fos.withWriter {
    // 其实 w -&gt; w.write(data) 可以一次将长字符串全写进去。
    // 这里主要是为了演示闭包的嵌套调用。
    w -&gt;
        data.eachLine {
            w.write("${it}\n")
        }
}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>尤其是使用<strong>带缓冲的输出流</strong>时，我们再也不用担心因为忘记 <code>close()</code> 或者 <code>flush()</code> 而导致内容丢失的问题了。</p>
<h2 data-id="heading-4">4.4 闭包柯里化</h2>
<p>凡是涉及函数式编程的语言都能进行柯里化 ( Curry ) 变换。我们对函数 ( 或称之闭包 ) 进行柯里化变换的的目的有二：要么是希望记忆 ( 缓存) 一些参数，要么是希望推迟执行某个闭包。举个例子，下面是一个平平无奇的表达式：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">Closure&lt;Integer&gt; expr = { x, y, z -&gt; (x + y) * z }
<span class="copy-code-btn">复制代码</span></code></pre>
<p>假设在实际的运行当中，我们发现参数 <code>z</code> 相较 <code>x</code> 和 <code>y</code> 而言，它的值似乎不总是变化：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">// z 不总是变化
expr(2,3,3)
expr(1,6,3)
expr(1,5,3)
expr(5,9,3)
<span class="copy-code-btn">复制代码</span></code></pre>
<p>因此，我们希望闭包 <code>expr</code> 在一段时间之内记住 <code>z</code> 的值，以此来避免枯燥的重复传参。于是 <code>expr</code> 首先被改写成了这个样子：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">Closure&lt;Closure&lt;Integer&gt;&gt; expr = {
    z -&gt;
        // 对于这个闭包而言，z 是自由变量。
        return { x, y -&gt;
            (x + y) * z
        }
}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>现在，<code>expr</code> 首先要求提供 <code>z</code>，然后再返回一个参数是 <code>x</code> 和 <code>y</code> 的子闭包，根据描述来看，赋值的过程显然是被拆分成了两步。同时，<code>expr</code> 演变成了一个高阶函数 ( 高阶闭包 ) 。如果将求值过程比作是开箱子，那么原本只需要一次开箱的取值操作变成了两次。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">// 之前:expr(2,3,3)
// 之后: 
def result = expr(3)(2,3)
<span class="copy-code-btn">复制代码</span></code></pre>
<p>事情变得更麻烦了吗？并不是如此。如果我们率先获取 <code>expr(3)</code> ，就能提前获取被保存的 <code>z</code>  的状态。因此在后续调用中，我们只管传入不同的 <code>x</code> 和 <code>y</code> 即可。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">// (x + y) * 3
def memoried_z = expr 3
memoried_z(2,3)  // expr(2,3,3)
memoried_z(1,6)  // expr(1,6,3)
memoried_z(1,5)  // expr(1,5,3)
memoried_z(5,9)  // expr(5,9,3)
<span class="copy-code-btn">复制代码</span></code></pre>
<p>对于更加深层次的柯里化函数而言，随着函数参数不断被记忆，后续的调用将会变得越来越简单，所需的参数越来越少。而传递的参数越是复杂，或者传参的条目越多，函数柯里化体现出的优势就会越大。在获得所有的参数之前，柯里化函数总是返回闭包，而非真正执行，因此我们也称柯里化函数被推迟调用了。</p>
<h3 data-id="heading-5">4.4.1 便捷的柯里化转换方法</h3>
<p>如果函数的功能再复杂一些，那么手动重构一个柯里化实现可能要花上一点时间 ( 更多的是思绪上的混乱 )。好在 Groovy 提供了一系列便捷的方法来代替我们完成柯里化转换。对于一个参数个数为 n 的函数，如果想将其前 k 个参数进行柯里化，可以调用<code>curry()</code> 方法来完成，其中 <code>0 &lt;= k &lt;= n</code>。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">expr = {x, y, z -&gt; (x + y) * z}

// 返回一个新的表达式： ( 3 + 2 ) * z =&gt; 5z
expr1 = expr.curry(3,2)

// 10
println expr1(2)

// 返回一个新的表达式: (1 + 2) * 3 = 9
println expr.curry(1,2,3)()
<span class="copy-code-btn">复制代码</span></code></pre>
<p>如果要从后向前开始柯里化，则需使用 <code>rcurry()</code> 方法：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">expr = {x, y, z -&gt; (x + y) * z}

// expr = (x + 3) * 2
expr1 = expr.rcurry(3,2)

// 12
println expr1(3)
<span class="copy-code-btn">复制代码</span></code></pre>
<p>如果要从前面的第 k 个参数开始柯里化，则需要使用 <code>ncurry()</code> 方法，其中 <code>0 &lt;= k &lt;= n</code>，当 <code>k = 0</code> 时，指从第一个参数开始柯里化，此时等价于 <code>curry()</code> 方法。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">expr = {x,y,z -&gt; (x + y) * z}

// expr1 = (x + 3) * 2
expr1 = expr.ncurry(1,3,2)

// 10
println expr1(2)
<span class="copy-code-btn">复制代码</span></code></pre>
<h2 data-id="heading-6">4.5 动态闭包</h2>
<p>Groovy 可以在程序运行时动态地判断传入闭包的参数列表长度，甚至是参数类型，我们可以利用这个特性赋予程序动态决策的能力。比如：假定公司要根据营收额来统计交税额。我们想以闭包的形式将税额计算方法传递到一个高阶函数当中去计算。然而，这个闭包有可能不需要提供税率 ( 用户直接给出计算公式 )，也有可能需要 ( 用户仅提供计算方法，此时由高阶函数提供一个默认值)：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">def tax(Double amount,Closure computer){
    switch (computer.maximumNumberOfParameters){
        case 1 : return computer(amount)
        case 2 : return computer(amount,15)
        default: throw new Exception("need 1 or 2 args.")
    }
}


// 这个闭包传入了税率计算方式以及税率，只需要 1 个参数
println tax(14000.0) {
        amount -&gt; amount * 0.13
}

// 这个闭包不主动传入税率 rage，有 2 个参数
println tax(14000.0) {
    amount,rage -&gt; amount * (rage/100)
}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>如果 Groovy 能够确定一个参数是闭包，那么可以访问其 <code>.maxinumNumberOfParameters</code> 属性来判断闭包传入时实际的参数个数。如果用户不提供税率，那么就直接按照用户的公式计算交税额。否则，由高阶函数给出一个默认税率并计算。</p>
<p>除了动态判断参数的个数，还可以使用 <code>parameterTypes</code> 属性来动态获取参数的实际类型。比如：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">def check(Closure cls){
    int i = 1
    for(args in cls.parameterTypes) { println "type[${i}] = ${args.typeName}";i++}
    //.. 什么也不做
}

// type[1] = java.lang.String
check {
    String i -&gt; //.. 什么都不做
}

// type[1] = java.lang,Integer
check {
    Integer i -&gt; //.. 还是什么也不做
}

//type[1] = java.lang.Integer
//type[2] = java.lang.String
check {
    Integer i , String s -&gt; //.. 仍然什么也不做
}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>注意，前文曾提到过，如果闭包不需要任何参数，那么形式上可以写为 <code>{...}</code> 或者是 <code>{ -&gt; ...}</code>，两者的区别是：Groovy 仍然会为前者赋予一个隐含的参数 <code>it</code>，只不过这个值是 <code>null</code>。但对于后者，Groovy 则认为这个它是一个严格的无参数闭包。</p>
<h2 data-id="heading-7">4.6 闭包执行上下文与闭包委托</h2>
<p>假设这是一个闭包：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">def closure = {
	func()
}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>显然，如果没有其它的线索，那么就很难说 <code>func()</code> 调用是从哪来的。先把这个问题搁置在一边，我们有更重要的概念需要提及。</p>
<p>Groovy 为每一个闭包都定义了三个属性：<code>thisObject</code>，<code>owner</code>，<code>delegate</code>。所有的闭包都和它所在类的实例相绑定，并且会被 Groovy 编译成一个内部类的实例。对于一般的闭包，<code>this == owner == delegate</code> ，比如说外部的 <code>out</code> 闭包。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">class _Example_{
    def out = {
        // 这是相对而言的内部闭包。
        def inner = {}
        //------test of thisObject, owner, delegate----------//
        println out.thisObject.getClass().name		//_Example_
        println out.owner.getClass().name			//_Example_
        println out.delegate.getClass().name		//_Example_
    }
}

new _Example_().out()
<span class="copy-code-btn">复制代码</span></code></pre>
<p>但对于一些特殊情况就有所不同了：第一种情况是闭包嵌套的情况。比如说 <code>out</code> 闭包内部定义的  <code>inner</code> 闭包。如果访问该 <code>inner</code> 闭包的 <code>owner</code> ，它将指向外部闭包 <code>out</code> 的实例。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">class _Example_{
    def out = {
        // 这是相对而言的内部闭包。
        def inner = {}

        //------test of thisObject, owner, delegate----------//
        println out.thisObject.getClass().name		//_Example_
        println out.thisObject.hashCode()           // == inner.thisObject.hashCode
        println out.owner.getClass().name			//_Example_
        println out.delegate.getClass().name		//_Example_

        println inner.thisObject.getClass().name    //_Example_
        println inner.thisObject.hashCode()         // == out.thisObject.hashCode
        println inner.owner.getClass().name         //_Example_$_closure1 (指外部闭包被编译的内部类)
        println inner.delegate.getClass().name      //_Example_$_closure1 (指外部闭包被编译的内部类)
    }
}

new _Example_().out()
<span class="copy-code-btn">复制代码</span></code></pre>
<p>在第二种特殊情况下，<code>delegate</code> 将不再指向 <code>owner</code>，那就是进行<strong>闭包委托</strong>的情形。用简单的话来概述它，就是闭包内部调用的一些方法，<strong>可能</strong>来自于另一个委托类的实例。声明如下：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">// "代理类"
class _Proxy_{}
class _Example_{
    def out = {
        def inner = {}
        inner.delegate = new _Proxy_()
        
        // thisObject, owner, delegate 都不一样。
        println inner.thisObject.getClass().name
        println inner.owner.getClass().name
        println inner.delegate.getClass().name
    }
}

//_Example_
//_Example_$_closure1
//_Proxy_
new _Example_().out()
<span class="copy-code-btn">复制代码</span></code></pre>
<p>理解这三个闭包的基本属性之后，再去解释本节开头的那个问题就容易得多了：如果一个闭包内部使用的方法或变量在局部块内没有，那么 Groovy 优先在 <code>thisObject</code> 或者 <code>owner</code> 域查找；否则，试图从 <code>delegate</code> 那里查找；否则，就会报错返回。如果能在前两个域当中找到合适的内容，那么 Groovy 就绝对不会 "打扰" <code>delegate</code>。</p>
<p>观察下面的完整代码。由于 <code>_Example_ </code> 类定义了 <code>func1</code> ，<code>out</code> 闭包定义了<code>func2</code>，因此即便是 <code>inner</code> 设置了闭包代理，Groovy 也没有进行路由。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">class _Proxy_{
    def func1 = { println "this [func1] is from the instance of Class: _Proxy_" }
    def func2 = { println "this [func2] is still from the instance of Class: _Proxy_" }
}

class _Example_{

    def func1 = { println "this [func1] is from the instance of Class:_Example_."}
    def out = {
        def func2 = { println "this [func2] is from the instance of closure:out"}
        def inner = {
            func1()
            func2()
        }
        inner.delegate = new _Proxy_()
        inner()
    }
}

//this [func1] is from the instance of Class:_Example_.
//this [func2] is from the instance of closure:out
new _Example_().out()
<span class="copy-code-btn">复制代码</span></code></pre>
<p>一旦注释掉 <code>_Example_</code> 内部的 <code>func1</code> 或者是 <code>func2</code> 闭包，Groovy 就会从 <code>_Proxy_</code> 那里尝试弥补缺失的内容，从而给出不同的运行结果。比如：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">class _Proxy_{
    def func1 = { println "this [func1] is from the instance of Class: _Proxy_" }
    def func2 = { println "this [func2] is still from the instance of Class: _Proxy_" }
}

class _Example_{
    def out = {
        def inner = {
            func1()
            func2()
        }
        inner.delegate = new _Proxy_()
        inner()
    }
}

//this [func1] is from the instance of Class: _Proxy_
//this [func2] is still from the instance of Class: _Proxy_
new _Example_().out()
<span class="copy-code-btn">复制代码</span></code></pre>
<p>另一种闭包委托的声明方式会令 Groovy 倒置查找顺序：即优先选择 <code>delegate</code> 的方法，其次才是 <code>owner</code> 或 <code>thisObejct</code>。具体做法是通过调用一个对象的 <code>.with</code> 方法 "外挂" 闭包。如下所示：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">class _Proxy_{
    def func1 = { println "this [func1] is from the instance of Class: _Proxy_" }
    def func2 = { println "this [func2] is still from the instance of Class: _Proxy_" }
}

class _Example_{
    def func1 = { println "this [func1] is from the instance of Class: _Example_" }
    def func2 = { println "this [func2] is still from the instance of Class: _Example_" }
    def out = {
        def inner = {
            func1()
            func2()
        }
        new _Proxy_().with inner
    }
}

//this [func1] is from the instance of Class: _Proxy_
//this [func2] is still from the instance of Class: _Proxy_
new _Example_().out()
<span class="copy-code-btn">复制代码</span></code></pre>
<p>注，<code>delegate</code> 在涉及 DSL 的方面会变得非常有用。</p>
<h2 data-id="heading-8">4.7 尾递归</h2>
<p>递归代码常常被认为是 "有品位但是不好驾驭" 的典型，和迭代相比，递归从表达上可能更加晦涩，因此令大部分程序员避之不及。令一个经常遇到的麻烦是：当递归的层次过深时，JVM 会招架不住而抛出一个 <code>StackOverFlowError</code> 。我们都知道，JVM 的每一个线程都使用一个栈空间来管理它调用的函数，并为每一个函数分配一个栈帧。如果这个栈一直处于 "只进不出" 的状态，那么 JVM 理论上就有驾崩的危险。</p>
<p>解决栈溢出的思路却又很简单：只要让栈维持 "边进边出" 的状态就可以了。具体的做法是：将一般的递归函数改进成尾递归。尾递归的意思是：当调用下一个函数时，当前的调用直接将返回值传递给它，并且没有后续计算，线程也自然就认为没有必要保存当前调用的栈帧。</p>
<p>用一个例子来说明或许更实在一点：n 的阶乘。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">/**
 * 为什么这个方法不是尾递归？
 * 如果它的返回值是 n * factorial(n-1)，那么本次调用就需要等待下一次调用的 factorial(n-1) 来计算返回值。
 * 因此，假定 n == 3 , 那么线程就需要 3 层栈空间来解决它。
 * 假定 n 取了更大的值 , 那么 JVM 就会呻吟了。
 * @param n
 * @return
 */
int factorial(int n){
   return n &lt;= 1 ? 1 :n * factorial(n-1)
}

import groovy.transform.TailRecursive

/**
 * 为什么这个方法是尾递归？
 * 无论是哪个分支，该递归函数总是返回一个数值或者发起一个新的调用，且当前调用没有需要等待的后续运算了。
 * 而递归过程的中间结果会不断地被装入 acc 参数中并传递。
 * 所以，在当前调用结束之后，它可以安全地 "传宗接代且无后顾之忧"。 
 * 无论 n 取何值，这个尾递归始终只占用 1 层栈空间。
 * 唯一不太方便的是，用户调用这个函数需要主动为 acc 传递一个初始值，而我们一般都靠包装函数来解决这个瑕疵。
 * @param n
 * @return
 */
@TailRecursive
int factorial_t(int n,int acc){
    return n &lt;= 1 ? acc : factorial_t(n-1,acc * n)
}

// good
println factorial_t(10000,1)

// bad, 99.99% 报错
println factorial(10000)
<span class="copy-code-btn">复制代码</span></code></pre>
<p>其中，<code>@TailRecursive</code> 注解负责检查函数，如果它不是严格尾递归的，那么就会在编译器期间报错。闭包版本的尾递归则和函数版本不太一样，其尾递归需要借助 <code>trampoline</code> ( 意 "弹簧床" ) 方法来实现。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">// 对于递归闭包，我们必须先定义出一个变量作为它的名字，才能在闭包内部调用自身。
def f 

f = {
    i, BigInteger n -&gt; i &lt;= 1 ? n : f.trampoline(i - 1, n * i)
}.trampoline()

f(1000)
<span class="copy-code-btn">复制代码</span></code></pre>
<p>另外，考虑到用户体验，不妨将闭包的 <code>acc</code> 参数设置为默认值 1 ( 因为它是最后一个参数 )，因此该参数对用户来说可以是透明的。需要指出的是，同等的算法逻辑和入参，函数的执行速度要比闭包快得多。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">BigInteger factorial_func(int i, BigInteger n) {
    i &lt;= 1 ? n : factorial_func(i - 1, n * i)
}

factorial_closure = {
    i, BigInteger n = 1 -&gt; i &lt;= 1 ? n : factorial_closure.trampoline(i - 1, n * i)
}.trampoline()

l1 = System.currentTimeMillis()
println factorial_closure(1000)

// 250 ~ 300 millis
println System.currentTimeMillis() - l1

l1 = System.currentTimeMillis()
println factorial_func(1000, 1 as BigInteger)

// 4 ~ 10 millis
println System.currentTimeMillis() - l1
<span class="copy-code-btn">复制代码</span></code></pre>
<h2 data-id="heading-9">4.8 从钢条切割问题探讨递归优化</h2>
<blockquote>
<p>该问题参考自：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.cnblogs.com%2Ftgycoder%2Fp%2F4980655.html" target="_blank" rel="nofollow noopener noreferrer" title="https://www.cnblogs.com/tgycoder/p/4980655.html" ref="nofollow noopener noreferrer">动态规划-钢杆切割问题 - RunningSnail - 博客园 (cnblogs.com)</a></p>
</blockquote>
<p>假定我们是钢杆 ( 或者称钢条 ) 的卖家，不同长度的钢杆价位不同，**且钢杆长度和价格并不是线性相关的 ( 这就表明了整根卖不一定获利最大 ) **。现在给定一个长钢杆，我们希望对它做一些切割以获得最大利润。长度为 <code>n</code> 的钢杆，它的价格记作 <code>rodPrices[n]</code>  ：</p>
<pre><code class="hljs language-ini copyable" lang="ini">Integer<span class="hljs-section">[]</span> <span class="hljs-attr">rodPrices</span> = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">15</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">24</span>, <span class="hljs-number">26</span>, <span class="hljs-number">28</span>, <span class="hljs-number">29</span>, <span class="hljs-number">35</span>, <span class="hljs-number">37</span>, <span class="hljs-number">38</span>, <span class="hljs-number">39</span>, <span class="hljs-number">40</span>]
<span class="copy-code-btn">复制代码</span></code></pre>
<p>比如，长度为 2 的钢杆，它的价格为 3，而长度为 5 的钢杆，它的价格仅为 8 ( 性价比似乎还 "提高" 了) 。此外，这里为了消除 0 下标的 "错位" 影响，令 <code>rodPrices[0] == 0</code> 。第一问：首先求长度为 27 的钢杆，它所能获得的最大利润。</p>
<p>最朴素的想法是：穷举所有的切割方案并择优选取。一提及穷举，我们自然就会想到迭代，或者递归，或者<strong>两者兼具</strong>。</p>
<p>进一步思考，每次将一段长杆 <code>l</code> 切割，都会产生两个短杆 <code>s1</code> ，<code>s2</code> 。设长度为 <code>n</code> 的钢杆的最大利润为 <code>max(n)</code>，那显然我们只要求出 <code>max(s1)</code> 和 <code>max(s2)</code>，那么就能推算出 <code>max(l) = max(s1) + max(p2)</code> 。那 <code>max(s1)</code>又该怎么求呢？它肯定又能分出更短的杆 <code>ss1</code> 和 <code>ss2</code> ，我们继续求 <code>max(ss1)</code> 和 <code>max(ss2)</code> 就好了 ......</p>
<p>从这段描述中，我们能够提取出四个要点：</p>
<ol>
<li>大问题的目的是求最优解。</li>
<li>大问题可以分解成若干小问题。</li>
<li>大问题的最优解依赖于小问题的最优解。</li>
<li>我们现在正 "自上而下" 地将大问题不断分解成小问题。</li>
</ol>
<p>因此，钢杆 ( 钢条 ) 切割问题本质上是一道<strong>动态规划</strong>题。在下面的叙述中，我们将 "求长度为 <code>length</code> 的钢杆的最大利润" 封装为一个函数 <code>rodCut(length)</code> 。</p>
<p>设传进来长度为 <code>length</code> 的长杆，切割后的两杆其一为 <code>s1</code> ，长度记作 <code>i</code>；而另一个 <code>s2</code> 的长度则为 <code>length - i</code>。我们在一个<strong>迭代</strong>中动态平衡两杆的长度，且在每一次迭代内部，保留 <code>s1</code> 的长度不变，假设它的当前最优解就是 <code>max'(s1)</code> 。以此为前提去对 <code>s2</code> 进行<strong>递归切割</strong>，即调用 <code>rodCut(s2)</code>。</p>
<p>我们确信 <code>rodCut</code> 总能正确的返回 <code>max(s2)</code>，因此每次迭代的 <code>max'(length) = max'(s1) + rodCut(s2)</code> 。在迭代完成后，只需要从这些结果值中取出实际最大值作为当前 <code>rodCut(length)</code> 调用的返回值即可。</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>r</mi><mi>o</mi><mi>d</mi><mi>C</mi><mi>u</mi><mi>t</mi><mo stretchy="false">(</mo><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mi>M</mi><mi>a</mi><mi>x</mi><mo stretchy="false">{</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>r</mi><mi>o</mi><mi>d</mi><mi>C</mi><mi>u</mi><mi>t</mi><mo stretchy="false">(</mo><mi>s</mi><mn>2</mn><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi mathvariant="normal">∣</mi><mtext>&nbsp;</mtext><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo stretchy="false">}</mo><mspace linebreak="newline"></mspace><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo>=</mo><mi>s</mi><mn>1</mn><mo>+</mo><mi>s</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">rodCut(length) = Max\{max_i(s1) + rodCut(s2)\space|\space1≤i≤length\} \\ length = s1 + s2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mopen">{</span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace">&nbsp;</span><span class="mord">∣</span><span class="mspace">&nbsp;</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.79549em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mclose">}</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord">2</span></span></span></span></span></div>
<p>另外还有一个细节：如果在某一次迭代中  <code>s1 </code> 的长度 <code>i == length</code>，那么显然 <code>s2 == 0</code> 。这时表示不对长度 <code>length</code> 的杆进行切割，此时 <code>max(length) == rodPrices[length]</code> 。</p>
<p>根据上述思路，我们迅速给出了第一版解决方案：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">Integer rodCut(Integer[] rodPrices, length) {

    // 虽然 length[0] 即为 0，但是我们想让调用短路返回，而不是继续执行。
    // 这个 if 不可省略。
    if (length == 0) return 0

    def max = -1

    // "左杆" s1 的长度至少为 1，否则就没意义。
    // 当 length = 1 时， length -1 = 0， 调用会进入临界条件。
    for (i in 1..length) {
        def p = rodPrices[i] + rodCut(rodPrices, length - i)
        if (p &gt; max) max = p
    }

    return max
}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>现在提出一个新的要求：不仅要求出最大利润，还要给出详细的切割方案。比如：长度为 <code>27</code>  的杆，它的最大利润是 <code>43</code>，切割方案是：<code>[5,5,5,5,5,2]</code> ，数组内的每个元素是短杆的长度。</p>
<p>此时不仅要在迭代过程中寻求最优解，还要在此记录每一次求得最优解时短杆的长度。出于这个目的，我们设计出了如下数据结构：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">@Canonical
final class Plan {
    Integer amount
    ArrayList splits
}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>Plan 表示一个切割方案，比如 <code>new Plan(amount: 4, splits:[1,2])</code> 表示这个切割方案中有长度为 1 和 2 的两个子杆，这个方案的总收入为 4。</p>
<p><code>splits</code> 是线性表，用于记录短杆的长度。可以预见的是：长杆 Plan 的创建基于短杆 Plan，新的 <code>splits</code> 总是之前 Plan 的 <code>splits</code> 再插入一个新的元素，而链表能够从容地应对不断追加元素的场合，所以 <code>splits</code> 被设置为 ArrayList 类。</p>
<p>第二版解决方案也出炉了：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">@Newify(Plan)
def rodCut(rodPrices, length) {

    if (length == 0) return Plan(amount: 0, splits: [])

    def max = Plan(amount: -1, splits: [])

    // 至少切割成 (1,length-1)，否则没有意义。
    // 当 length = 1 时， length - 1 = 0， 要考虑到边界条件。
    for (i in 1..length) {
        
        // left : 这里是 "剩下的" 意思。
        // 获得 "右杆" s2 的最优 Plan
        def leftRod = rodCut(rodPrices, length - i)

        // 推算当前迭代中的 "最优" Plan = "左杆" Plan + "右杆" Plan
        def try_ = Plan(amount: rodPrices[i] + leftRod.amount, splits: leftRod.splits + i)

        if (try_.amount &gt; max.amount) max = try_
    }

    // 返回实际的长度 Length 的杆所对应的最优 Plan.
    return max
}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>注意，这里存在 Groovy 的语法糖：那就是 <code>leftRod.split + i</code>。这是一个操作符重载，实际上可理解为 <code>leftRod.splits.add(i)</code> 。该算法的 Groovy 闭包版本是：</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">def rodCuts

rodCut = {
    rod_prices, length -&gt;
        if (length == 0) return new Plan(amount: 0, splits: [])
        def max = new Plan(amount: -1, splits: [])
        for (i in 1..length) {
            def leftRod = rodCut(rodPrices, length - i)
            def try_ = new Plan(amount: rodPrices[i] + leftRod.amount, splits: leftRod.splits + i)
            if (try_.amount &gt; max.amount) max = try_
        }
        return max
}
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-10">4.8.1 利用记忆化改进性能</h3>
<p>人们常说：过早的优化是万恶之源。因此在之前笔者刻意回避了 <code>rodCut</code> 函数的运行效率。运行第二版的函数 / 闭包，程序需要运行大约 1 ~ 2 分钟的时间才能给出答案。</p>
<p>为什么会这样？我们其实还忽略了第五个要点：那就是将大问题分解为小问题时，应当避免对重复的小问题求解。比如："将长为 10 的杆分为两个 5"  和 "将长为 8 的杆分成 3 和 5" 的两个情形都涉及到 "求杆长为 5 的最优解"。很不巧的是，在目前的递归过程中，<code>rodCut</code> 函数对传进来的 <code>length</code> 几乎来者不拒，却从来不检讨这个计算有无必要。</p>
<p>一个简单却十分有效的办法是，在调用这个函数的同时，传入一个足够长的 <code>cache</code> 数组作为缓存。其中，<code>cache[n]</code> 存储了长为 <code>n</code> 的杆的最佳方案，但在最开始，所有位置都是 <code>null</code> 。不过每次在 <code>rodCut</code> 返回计算结果之前，都会顺带着将它写入到这个缓存的对应位置内。</p>
<p>在后续的递归调用中，程序优先从查找缓存的对应位置：如果该位置非 <code>null</code>，则意味着当前调用能够立刻返回计算结果，而非重新计算。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">def rodCuts_cached

rodCuts_cached = {

    Integer[] rod_prices, Integer length, Plan[] cache -&gt;

        if (cache[length] != null) return cache[length]
        if (length == 0) return new Plan(amount: 0, splits: [])
        def max = new Plan(amount: 0, splits: [])

        for (i in 1..length) {
            def leftRod = rodCuts_cached(rod_prices, length - i, cache)
            def try_ = new Plan(amount: rod_prices[i] + leftRod.amount, splits: leftRod.splits + i)
            if (try_.amount &gt; max.amount) {
                max = try_
            }
        }
        // 记录当前最优解。
        // 注意，传入的 cache 是引用，这意味着任意一处递归都能够随时感知 cache 的变化。
        cache[length] = max
        return max
}
<span class="copy-code-btn">复制代码</span></code></pre>
<p>依照这个思路，我们重新给出了第三版代码。在同等运行条件下，它的运算时间只相当于第二版的 1%。</p>
<p>这个套路其实和之前 n 阶乘的优化思路非常相像，那就是想方设法保存中间结果来节省后续递归的工作量，无论从形式上是值传递一个计算结果，还是引用传递一块缓存。如果为这个套路起一个专业点的名字，那么它就是 <strong>记忆化</strong> ( Memoization ) 。</p>
<h3 data-id="heading-11">4.8.2 画龙点睛之 memoize()</h3>
<p>我们已经从实例中理解并体会了函数记忆化带来的性能飞跃，体贴的 Groovy 同样也更理解我们。在其它语言中，我们可能会为了实现缓存而手写一段逻辑代码 ( 像第三版代码那样 ) 。但至少在 Groovy 中，实际的工作量就是在原有闭包的基础之上再补充上一个 <code>momonize()</code> 方法调用。</p>
<pre><code class="hljs language-groovy copyable" lang="groovy">def rodCuts
rodCut = {
    rod_prices, length -&gt;
        if (length == 0) return new Plan(amount: 0, splits: [])
        def max = new Plan(amount: -1, splits: [])
        for (i in 1..length) {
            def leftRod = rodCuts(rod_prices, length - i)
            def try_ = new Plan(amount: rodPrices[i] + leftRod.amount, splits: leftRod.splits + i)
            if (try_.amount &gt; max.amount) max = try_
        }
        return max
}.memoize()
<span class="copy-code-btn">复制代码</span></code></pre>
<p>Groovy 会为此创建一个自带缓存空间的闭包，然后就像我们所做的一样，闭包在递归自身时会优先从缓存中读取运算结果，除此之外，Groovy 还考虑到了一些线程安全的内容。由于机制大体相同，因此这一版的运行效率跟第三版代码几乎差不多，而区别是 "我们操心的活变得更少了"。</p>
<p>根据天下没有免费的午餐定理，争取运算时间的代价将是牺牲或多或少的空间。如果问题的规模变得夸张一些，那么对空间的占用就无法忽略 ( 尤其是在本例中，Plan 还是一个携带链表的类 ) 。Groovy 将选择的权利交给了我们，因此 <code>memonized()</code> 还衍生出了 <code>memonizeAtMost()</code> 方法以及其它变种。当缓存达到临界状态时，Groovy 采取 LRU ( Least Last Used ) 策略对缓存内容进行替换。</p></div><style>.markdown-body pre,.markdown-body pre>code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style></div></article> <div class="article-end" data-v-4b9f9746="" data-v-020666e8=""><div class="tag-list-box" data-v-4b9f9746="" data-v-020666e8=""><div class="tag-list" data-v-4b9f9746="" data-v-020666e8=""><div class="tag-list-title" data-v-4b9f9746="" data-v-020666e8="">分类：</div> <a href="https://juejin.cn/backend" target="_blank" rel="" class="item category-item" data-v-020666e8="" data-v-4b9f9746=""><span class="tag-title" data-v-020666e8="">后端</span></a></div> <div class="tag-list" data-v-4b9f9746="" data-v-020666e8=""><div class="tag-list-title" data-v-4b9f9746="" data-v-020666e8="">标签：</div> <div class="tag-list-container" data-v-4b9f9746="" data-v-020666e8=""><a href="https://juejin.cn/tag/Groovy" target="_blank" rel="" class="item tag-item" data-v-020666e8="" data-v-4b9f9746=""><span class="tag-title" data-v-020666e8="">Groovy</span></a></div></div></div> <div data-v-8c900db2="" data-v-020666e8="" class="column-container"><div data-v-8c900db2="" class="column-header"><span data-v-8c900db2="" class="column-title">文章被收录于专栏：</span></div> <div data-v-8c900db2="" class="column-content"><div data-v-79b79a50="" data-v-8c900db2="" class="item-container"><img data-v-248050e4="" data-v-79b79a50="" loading="eager" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/674d913150fa4dbcac9d0cc223160d6d_tplv-k3u1fbpfcp-no-mark_160_160_160_120.awebp" alt="cover" class="lazy"> <div data-v-79b79a50="" class="content"><div data-v-79b79a50="" class="title">
      Groovy 从入门到 MOP
    </div> <span data-v-79b79a50="" class="tooltip"><div class="byte-tooltip byte-tooltip--dark" style="display: none;">
        从基础开始，逐步了解这门运作在 JVM 之上的动态语言，并且尝试着利用动态特性进行元编程，或者是设计内部 DSL 。
      </div><span class="byte-tooltip__wrapper"><span data-v-79b79a50="" class="description">
        从基础开始，逐步了解这门运作在 JVM 之上的动态语言，并且尝试着利用动态特性进行元编程，或者是设计内部 DSL 。
      </span></span></span></div> <!----> <!----> <button data-v-05e27314="" data-v-79b79a50="" class="ui-btn btn follow-btn primary mini default attention"><!----> 
    关注专栏
  </button></div></div></div> <div data-fetch-key="1" class="extension-banner" data-v-bf9647a6="" data-v-020666e8="" data-v-4b9f9746=""><span class="banner-icon" data-v-bf9647a6=""></span> <div class="banner-wrapper" data-v-bf9647a6=""><a class="banner-title" data-v-bf9647a6="" href="https://juejin.cn/extension/?utm_source=standalone&amp;utm_medium=post&amp;utm_campaign=extension_promotion" target="_blank">
      安装掘金浏览器插件
    </a> <div class="banner-content" data-v-bf9647a6="">多内容聚合浏览、多引擎快捷搜索、多工具便捷提效、多模式随心畅享，你想要的，这里都有！</div></div> <a class="banner-action" data-v-bf9647a6="" href="https://juejin.cn/extension/?utm_source=standalone&amp;utm_medium=post&amp;utm_campaign=extension_promotion" target="_blank">前往安装</a></div></div> <div data-v-9bc035e6="" data-v-020666e8="" class="wrap category-course-recommend"><div data-v-9bc035e6="" class="title">相关课程</div> <div data-v-9bc035e6="" class="list"><div data-v-7a387154="" data-v-9bc035e6="" data-booklet-id="6844733793220165639" class="book-card-wrap"><div data-v-077cd020="" data-v-7a387154="" class="book-thumb book-card-cover"><img data-v-248050e4="" data-v-077cd020="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/16a9d7ca96cf1e2f_tplv-t2oaga2asx-no-mark_420_420_300_420.awebp" alt="「图解  Kafka 之实战指南」封面" class="lazy book-thumb-img" loading="lazy" style=""> <!----></div> <div data-v-7a387154="" class="book-card-info"><div data-v-7a387154="" class="book-card-top"><div data-v-7a387154="" title="图解  Kafka 之实战指南" class="book-card-title"><!----> <span data-v-7a387154="" class="book-card-title-text">图解  Kafka 之实战指南</span></div> <div data-v-7a387154="" class="book-card-content"><a data-v-0ef8bafa="" data-v-7a387154="" href="https://juejin.cn/user/3808363978171566" target="_blank" rel="" class="username author-name"><span data-v-0ef8bafa="" class="name" style="max-width: 128px;">
      朱小厮
    </span> <span data-v-3de16c56="" data-v-0ef8bafa="" blank="true" class="rank"><img data-v-3de16c56="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/lv-3.7938ebc.png" alt="lv-3" title="创作等级"></span> <!----> <!----> </a> <div data-v-7a387154="" class="book-card-count">
          4395购买
        </div></div></div> <div data-v-7a387154="" class="book-card-price-wrap"><div data-v-7a387154="" class="book-card-price">
        ¥14.95
      </div> <div data-v-7a387154="" class="book-card-sale">
        ¥29.9
      </div> <div data-v-7a387154="" class="sale-tooltip-entry-box"><div data-v-6a0ef028="" data-v-7a387154="" class="sale-tooltip-wrap sale-tooltip-entry"><!----> <div data-v-6a0ef028="" class="sale-tooltip">
    首单券后价
    <!----> <div data-v-6a0ef028="" class="sale-tooltip-content">
      首单券后价
      <!----></div></div> <!----></div></div></div></div></div><div data-v-7a387154="" data-v-9bc035e6="" data-booklet-id="6857911863016390663" class="book-card-wrap"><div data-v-077cd020="" data-v-7a387154="" class="book-thumb book-card-cover"><img data-v-248050e4="" data-v-077cd020="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/11009afda72b412cbaa8f7c3e980a2ee_tplv-k3u1fbpfcp-no-mark_420_420_300_420.awebp" alt="「从 0 开始深入学习 Spring」封面" class="lazy book-thumb-img" loading="lazy" style=""> <!----></div> <div data-v-7a387154="" class="book-card-info"><div data-v-7a387154="" class="book-card-top"><div data-v-7a387154="" title="从 0 开始深入学习 Spring" class="book-card-title"><div data-v-7a387154="" class="book-card-vip">VIP</div> <span data-v-7a387154="" class="book-card-title-text">从 0 开始深入学习 Spring</span></div> <div data-v-7a387154="" class="book-card-content"><a data-v-0ef8bafa="" data-v-7a387154="" href="https://juejin.cn/user/3808363977640301" target="_blank" rel="" class="username author-name"><span data-v-0ef8bafa="" class="name" style="max-width: 128px;">
      LinkedBear
    </span> <span data-v-3de16c56="" data-v-0ef8bafa="" blank="true" class="rank"><img data-v-3de16c56="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/lv-3.7938ebc.png" alt="lv-3" title="创作等级"></span> <!----> <!----> </a> <div data-v-7a387154="" class="book-card-count">
          4285购买
        </div></div></div> <div data-v-7a387154="" class="book-card-price-wrap"><div data-v-7a387154="" class="book-card-price">
        ¥24.95
      </div> <div data-v-7a387154="" class="book-card-sale">
        ¥49.9
      </div> <div data-v-7a387154="" class="sale-tooltip-entry-box"><div data-v-6a0ef028="" data-v-7a387154="" class="sale-tooltip-wrap sale-tooltip-entry"><!----> <div data-v-6a0ef028="" class="sale-tooltip">
    首单券后价
    <!----> <div data-v-6a0ef028="" class="sale-tooltip-content">
      首单券后价
      <!----></div></div> <!----></div></div></div></div></div></div></div> <!----> <div data-v-38c0fdbe="" data-v-020666e8="" data-jj-helper="comment-container" class="container comment-list-box" id="comment-box" data-v-4b9f9746=""><div data-v-48a7e3c5="" data-v-38c0fdbe="" class="comment-form"><div data-v-48a7e3c5="" class="header"><span data-v-48a7e3c5="" class="header-title">评论</span></div><div data-v-48a7e3c5="" class="content"><div data-v-48a7e3c5="" class="avatar-box"><img data-v-248050e4="" data-v-47508ed8="" data-v-48a7e3c5="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/58aaf1326ac763d8a1054056f3b7f2ef.svg" alt="" class="lazy avatar avatar" loading="lazy"></div><div data-v-48a7e3c5="" class="form-box"><div data-v-7c7c7498="" data-v-48a7e3c5="" class="auth-card"><!----> <div data-v-48a7e3c5="" data-v-7c7c7498="" class="input-box"><div data-v-48a7e3c5="" data-v-7c7c7498="" contenteditable="true" spellcheck="false" placeholder="输入评论（Enter换行，Ctrl + Enter发送）" disabled="disabled" class="rich-input empty"></div><div data-v-48a7e3c5="" data-v-7c7c7498="" class="login-guide"><div data-v-48a7e3c5="" data-v-7c7c7498="" class="login-guide-text">看完啦，</div><div data-v-48a7e3c5="" data-v-7c7c7498="" class="login-guide-button">登录</div><div data-v-48a7e3c5="" data-v-7c7c7498="" class="login-guide-text">分享一下感受吧～</div></div><!----></div></div><div data-v-48a7e3c5="" class="action-box"><div data-v-9fe533ba="" data-v-48a7e3c5="" class="emoji-container emoji-btn" style="display: none;"><div data-v-9fe533ba="" class="emoji-box"><svg data-v-9fe533ba="" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon"><path data-v-9fe533ba="" fill-rule="evenodd" clip-rule="evenodd" d="M8.00002 0.666504C12.0501 0.666504 15.3334 3.94975 15.3334 7.99984C15.3334 12.0499 12.0501 15.3332 8.00002 15.3332C3.94993 15.3332 0.666687 12.0499 0.666687 7.99984C0.666687 3.94975 3.94993 0.666504 8.00002 0.666504ZM8 2C4.68629 2 2 4.68629 2 8C2 11.3137 4.68629 14 8 14C11.3137 14 14 11.3137 14 8C14 4.68629 11.3137 2 8 2ZM10.6667 5.66667V7.66667H9.33333V5.66667H10.6667ZM6.66667 5.66667V7.66667H5.33333V5.66667H6.66667ZM10.0767 9.33333H11.0495C11.1804 9.33333 11.2866 9.43951 11.2866 9.57048C11.2866 9.60754 11.2779 9.64409 11.2612 9.67718L11.244 9.71053C10.6294 10.8739 9.40726 11.6667 7.99998 11.6667C6.61523 11.6667 5.40977 10.8991 4.7859 9.76612L4.73786 9.67593C4.67845 9.56052 4.72385 9.4188 4.83926 9.35939C4.87253 9.34226 4.90941 9.33333 4.94683 9.33333H5.92347C6.02396 9.33332 6.11908 9.37865 6.18238 9.4567C6.26207 9.55496 6.32833 9.62955 6.38117 9.68046C6.80074 10.0847 7.37133 10.3333 7.99998 10.3333C8.63289 10.3333 9.20694 10.0814 9.62728 9.67224C9.67791 9.62296 9.74135 9.55121 9.8176 9.45698C9.88089 9.37877 9.97611 9.33333 10.0767 9.33333Z"></path></svg> <span data-v-9fe533ba="">表情</span></div> <!----></div><div data-v-48a7e3c5="" class="image-btn" style="display: none;"><svg data-v-48a7e3c5="" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon"><path data-v-48a7e3c5="" fill-rule="evenodd" clip-rule="evenodd" d="M14 1.3335C14.3514 1.3335 14.6394 1.60546 14.6648 1.95041L14.6666 2.00016V14.0002C14.6666 14.3516 14.3947 14.6396 14.0497 14.665L14 14.6668H1.99998C1.64853 14.6668 1.36059 14.3949 1.33514 14.0499L1.33331 14.0002V2.00016C1.33331 1.64871 1.60527 1.36077 1.95023 1.33532L1.99998 1.3335H14ZM13.3333 2.66618H2.66664V13.3328H13.3333V2.66618ZM11.9219 6.7879C11.9719 6.83791 12 6.90574 12 6.97647V11.7993C12 11.9098 11.9104 11.9993 11.8 11.9993H6.81615C6.7975 11.9993 6.77945 11.9968 6.76232 11.992L3.91042 11.9847C3.79996 11.9844 3.71063 11.8947 3.7109 11.7842C3.71102 11.7313 3.73209 11.6807 3.76948 11.6433L6.52468 8.88807C6.62882 8.78393 6.79766 8.78393 6.9018 8.88807L8.17297 10.1593L11.5447 6.7879C11.6489 6.68376 11.8177 6.68376 11.9219 6.7879ZM5.99997 3.99951V5.99951H3.99997V3.99951H5.99997Z"></path></svg><span data-v-48a7e3c5="">图片</span></div><div data-v-48a7e3c5="" class="submit" style="display: none;"><span data-v-48a7e3c5="">Ctrl + Enter</span><button data-v-48a7e3c5="" disabled="disabled" class="submit-btn">发表评论</button></div></div></div><input data-v-48a7e3c5="" type="file" class="hidden"></div></div> <!----> <!----></div> <div data-v-4fa94e66="" data-v-020666e8="" class="action-box action-bar" data-v-4b9f9746=""><div data-v-4fa94e66="" class="praise-action action"><div data-v-4fa94e66="" class="action-title-box"><img data-v-4fa94e66="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/00ba359ecd0075e59ffbc3d810af551d.svg"> <span data-v-4fa94e66="" class="action-title">
          3
        </span></div></div> <div data-v-4fa94e66="" class="comment-action action"><div data-v-4fa94e66="" class="action-title-box"><img data-v-4fa94e66="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/336af4d1fafabcca3b770c8ad7a50781.svg"> <span data-v-4fa94e66="" class="action-title">评论</span></div></div> <div data-v-4fa94e66="" class="collect-action action"><div data-v-4fa94e66="" class="action-title-box"><img data-v-4fa94e66="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/3d482c7a948bac826e155953b2a28a9e.svg"> <span data-v-4fa94e66="" class="action-title">收藏</span></div></div> <!----></div></div> <div data-v-020666e8="" data-v-4b9f9746="" class="main-area recommended-area shadow"><div data-v-020666e8="" data-v-4b9f9746="" class="recommended-list-title-wrapper"><div data-v-020666e8="" data-v-4b9f9746="" class="title"><span data-v-020666e8="" data-v-4b9f9746="" class="title-content">相关推荐</span></div></div> <div data-v-3ff8f708="" data-v-2bf301c8="" data-v-020666e8="" name="entry-list" tag="div" class="entry-list list recommended-entry-list" data-v-4b9f9746=""><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="6992013495692689422" data-original-type="0" data-draft-id="6992012896817381384" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/993614243303053" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">1年前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/%E6%95%8F%E6%8D%B7%E5%BC%80%E5%8F%91" target="_blank" rel="" class="tag">
        敏捷开发
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/Groovy" target="_blank" rel="" class="tag">
        Groovy
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/6992013495692689422" target="_blank" rel="" title="复杂多变场景下的Groovy脚本引擎实战" class="title">复杂多变场景下的Groovy脚本引擎实战</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/6992013495692689422" target="_blank" rel=""><div data-v-d5649b80="">互联网时代随着业务的飞速发展，不仅产品迭代、更新的速度越来越快，个性化需求也是越来越多，如：多维度（条件）的查询、业务流转规则等。通过项目实战，带大家了解Groovy在脚本引擎方面的应用。</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">1452</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            10
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            评论
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="7051604174357676062" data-original-type="0" data-draft-id="7051184473886425096" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/4433690702123534" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">10月前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/JavaScript" target="_blank" rel="" class="tag">
        JavaScript
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/%E9%9D%A2%E8%AF%95" target="_blank" rel="" class="tag">
        面试
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/7051604174357676062" target="_blank" rel="" title="用大白话🙌带你掌握闭包" class="title">用大白话🙌带你掌握闭包</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/7051604174357676062" target="_blank" rel=""><div data-v-d5649b80="">最近看了一些关于闭包的文章，到后面真正理解闭包时，发现其实大多数文章讲得还是稍微复杂了一点。 其实一开始我以为闭包是个很高大上，很高深莫测的知识点，但其实并不是的，如果光看那描述的很官方的定义以及巨长</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">1.8w</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            294
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            58
          </span></li> <!----></ul></div> <img data-v-248050e4="" data-v-d5649b80="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/b8230866d2bd4fee8bb5cf5bac6d86a1_tplv-k3u1fbpfcp-no-mark_240_240_240_160.awebp" alt="用大白话🙌带你掌握闭包" class="lazy thumb" loading="lazy" style=""></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="6864378349512065038" data-original-type="0" data-draft-id="6864366250551787533" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/2752832847753085" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">2年前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/JavaScript" target="_blank" rel="" class="tag">
        JavaScript
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/6864378349512065038" target="_blank" rel="" title="彻底搞懂闭包，柯里化，手写代码，金九银十不再丢分！" class="title">彻底搞懂闭包，柯里化，手写代码，金九银十不再丢分！</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/6864378349512065038" target="_blank" rel=""><div data-v-d5649b80="">这段时间我试着通过思维导图来总结知识点，主要关注的是一些相对重要或理解难度较高的内容。下面是同系列文章： 如果您需要换个角度看闭包，请直接打开解读闭包，这次从ECMAScript词法环境，执行上下文说起。 本文总结了javascript中函数的常见知识点，包含了基础概念，闭包，…</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">4.1w</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            1244
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            110
          </span></li> <!----></ul></div> <img data-v-248050e4="" data-v-d5649b80="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/cc0e6f413cfa4dbeaf323509249f9a62_tplv-k3u1fbpfcp-no-mark_240_240_240_160.awebp" alt="彻底搞懂闭包，柯里化，手写代码，金九银十不再丢分！" class="lazy thumb" loading="lazy" style=""></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="7069550779454980104" data-original-type="0" data-draft-id="7069549381598314527" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/668101431009496" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">8月前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/Android" target="_blank" rel="" class="tag">
        Android
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/gradle" target="_blank" rel="" class="tag">
        gradle
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/7069550779454980104" target="_blank" rel="" title="相比 Groovy 脚本, KTS 性能到底怎么样？" class="title">相比 Groovy 脚本, KTS 性能到底怎么样？</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/7069550779454980104" target="_blank" rel=""><div data-v-d5649b80="">KTS在易用性，可读性，IDE支持等方面都提供了比Groovy更好的支持，但目前在性能方面稍弱，那么相比 Groovy 脚本, KTS 性能到底怎么样？</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">3353</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            21
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            10
          </span></li> <!----></ul></div> <img data-v-248050e4="" data-v-d5649b80="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/b75ea37d868b4956837279e90f1a9c8e_tplv-k3u1fbpfcp-no-mark_240_240_240_160.awebp" alt="相比 Groovy 脚本, KTS 性能到底怎么样？" class="lazy thumb" loading="lazy" style=""></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="7148456353332215838" data-original-type="0" data-draft-id="7148448574865408014" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/3421335918746109" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">1月前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/gradle" target="_blank" rel="" class="tag">
        gradle
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/Groovy" target="_blank" rel="" class="tag">
        Groovy
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/Android%20Studio" target="_blank" rel="" class="tag">
        Android Studio
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/7148456353332215838" target="_blank" rel="" title="Android 混淆规则是如何生效的？" class="title">Android 混淆规则是如何生效的？</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/7148456353332215838" target="_blank" rel=""><div data-v-d5649b80="">记录一下关于 Android 中关于混淆配置文件的生效规则、混淆规则的细节、build 产物中和混淆相关的内容及其作用。</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">1047</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            9
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            6
          </span></li> <!----></ul></div> <img data-v-248050e4="" data-v-d5649b80="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/f81848c9352049ccaf19947bb7f231c9_tplv-k3u1fbpfcp-no-mark_240_240_240_160.awebp" alt="Android 混淆规则是如何生效的？" class="lazy thumb" loading="lazy" style=""></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="6844903913930358792" data-original-type="0" data-draft-id="6845076416992641032" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/3491704662669469" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">3年前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/JavaScript" target="_blank" rel="" class="tag">
        JavaScript
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/%E5%89%8D%E7%AB%AF" target="_blank" rel="" class="tag">
        前端
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/6844903913930358792" target="_blank" rel="" title="公司新来的女实习生问我什么是闭包？" class="title">公司新来的女实习生问我什么是闭包？</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/6844903913930358792" target="_blank" rel=""><div data-v-d5649b80="">撩妹守则第一条，女孩子都喜欢童话故事。 这个故事来自于stackoverflow的一则回答，看不懂没关系，等阅读完本文后，回头再来看这个故事，你会发现你已经完全了解了我的魅力，咳咳@¥%#…………JavaScript中闭包的魅力。 当函数可以记住并访问所在的词法作用域时，就产生…</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">1.8w</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            179
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            55
          </span></li> <!----></ul></div> <img data-v-248050e4="" data-v-d5649b80="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/16c93e205e50925b_tplv-t2oaga2asx-no-mark_240_240_240_160.awebp" alt="公司新来的女实习生问我什么是闭包？" class="lazy thumb" loading="lazy" style=""></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="6844903858636849159" data-original-type="0" data-draft-id="6845076329377824775" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/2330620350435501" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">3年前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/JavaScript" target="_blank" rel="" class="tag">
        JavaScript
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/ECMAScript%206" target="_blank" rel="" class="tag">
        ECMAScript 6
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/6844903858636849159" target="_blank" rel="" title="我从来不理解JavaScript闭包，直到有人这样向我解释它" class="title">我从来不理解JavaScript闭包，直到有人这样向我解释它</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/6844903858636849159" target="_blank" rel=""><div data-v-d5649b80="">大家都说简历没项目写，我就帮大家找了一个项目，还附赠【搭建教程】。 正如标题所述，JavaScript闭包对我来说一直有点神秘,看过很多闭包的文章，在工作使用过闭包，有时甚至在项目中使用闭包，但我确实是这是在使用闭包的知识。 最近看到的一些文章，终于，有人用于一种让我明白方式对…</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">10.3w</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            2230
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            240
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="7097141521102667813" data-original-type="0" data-draft-id="7097140837007491080" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/1306665624546712" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">6月前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/JavaScript" target="_blank" rel="" class="tag">
        JavaScript
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/%E5%89%8D%E7%AB%AF" target="_blank" rel="" class="tag">
        前端
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/7097141521102667813" target="_blank" rel="" title="深入理解JS闭包" class="title">深入理解JS闭包</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/7097141521102667813" target="_blank" rel=""><div data-v-d5649b80="">闭包是函数和声明该函数的词法环境的组合，它的最大用处有两个，一个是函数外部可以读取函数内部的变量，另一个就是让这些变量的值始终保持在内存中。</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">3251</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            86
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            8
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="6844903885488783374" data-original-type="0" data-draft-id="6845076367613100045" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/3720403075993373" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">3年前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/%E9%9D%A2%E8%AF%95" target="_blank" rel="" class="tag">
        面试
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/%E5%89%8D%E7%AB%AF" target="_blank" rel="" class="tag">
        前端
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/6844903885488783374" target="_blank" rel="" title="【1 月最新】前端 100 问：能搞懂 80% 的请把简历给我" class="title">【1 月最新】前端 100 问：能搞懂 80% 的请把简历给我</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/6844903885488783374" target="_blank" rel=""><div data-v-d5649b80="">半年时间，几千人参与，精选大厂前端面试高频 100 题，这就是「壹题」。 在 2019 年 1 月 21 日这天，「壹题」项目正式开始，在这之后每个工作日都会出一道高频面试题，主要涵盖阿里、腾讯、头条、百度、网易等大公司和常见题型。得益于大家热情参与，现在每道题都有很多答案，提…</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">59.5w</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            10402
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            354
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="7085560639317344269" data-original-type="0" data-draft-id="7085541287729823751" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/2189882895920861" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">7月前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/%E5%89%8D%E7%AB%AF" target="_blank" rel="" class="tag">
        前端
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/JavaScript" target="_blank" rel="" class="tag">
        JavaScript
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/%E9%9D%A2%E8%AF%95" target="_blank" rel="" class="tag">
        面试
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/7085560639317344269" target="_blank" rel="" title="前端基石：闭包" class="title">前端基石：闭包</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/7085560639317344269" target="_blank" rel=""><div data-v-d5649b80="">什么是闭包？ ✅ 官方说法：闭包就是指...。 ✅ MDN说法：闭包是一种特殊的对象...。✅ 自我理解：把函数执行...。</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">9769</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            135
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            23
          </span></li> <!----></ul></div> <img data-v-248050e4="" data-v-d5649b80="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/cba9b1e6c6784513b531b11b28841049_tplv-k3u1fbpfcp-no-mark_240_240_240_160.awebp" alt="前端基石：闭包" class="lazy thumb" loading="lazy" style=""></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="6857503248874799112" data-original-type="0" data-draft-id="6857497923694166029" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/1266229795106455" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">2年前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/Swoole" target="_blank" rel="" class="tag">
        Swoole
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/6857503248874799112" target="_blank" rel="" title="Swoole的闭包写法，很nice" class="title">Swoole的闭包写法，很nice</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/6857503248874799112" target="_blank" rel=""><div data-v-d5649b80="">今天写一篇文章来专门介绍一下PHP的闭包。从5.3版本开始PHP就增加了匿名函数支持，经过数个版本迭代到现在的PHP5.6、PHP7，PHP语言的闭包已经非常完善了。再结合Swoole提供的事件驱动支</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">76</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            1
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            评论
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="6844903480147050509" data-original-type="1" data-draft-id="0" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/3949101466527661" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">5年前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/SVG" target="_blank" rel="" class="tag">
        SVG
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/JavaScript" target="_blank" rel="" class="tag">
        JavaScript
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/%E5%8A%A8%E6%95%88" target="_blank" rel="" class="tag">
        动效
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/6844903480147050509" target="_blank" rel="" title="snap.svg 实战：SVG 路径 (path) 描边绘制跟随动画" class="title">snap.svg 实战：SVG 路径 (path) 描边绘制跟随动画</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/6844903480147050509" target="_blank" rel=""><div data-v-d5649b80="">snap.svg 实战：SVG 路径 (path) 描边绘制跟随动画</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">1362</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            42
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            评论
          </span></li> <!----></ul></div> <img data-v-248050e4="" data-v-d5649b80="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/48c724a74d1d67805b9062a232bc7fb5_tplv-t2oaga2asx-no-mark_240_240_240_160.awebp" alt="snap.svg 实战：SVG 路径 (path) 描边绘制跟随动画" class="lazy thumb" loading="lazy" style=""></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="7121643784638562317" data-original-type="0" data-draft-id="7121643497199042590" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/3615671881575853" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">4月前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/Android" target="_blank" rel="" class="tag">
        Android
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/Groovy" target="_blank" rel="" class="tag">
        Groovy
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/7121643784638562317" target="_blank" rel="" title="学完ASM Tree api，再也不怕hook了" class="title">学完ASM Tree api，再也不怕hook了</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/7121643784638562317" target="_blank" rel=""><div data-v-d5649b80="">背景 看完本章，你将会学习到用ASM的tree api进行对匿名线程的hook操作，同时也能够了解到asm相关的操作和背景知识介绍！</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">6128</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            77
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            28
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="6844903939268149262" data-original-type="0" data-draft-id="6845076454871416846" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/2154698521717085" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">3年前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/Flutter" target="_blank" rel="" class="tag">
        Flutter
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/6844903939268149262" target="_blank" rel="" title="Flutter布局——Flex、FittedBox、Stack、Container布局教程【超详细】" class="title">Flutter布局——Flex、FittedBox、Stack、Container布局教程【超详细】</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/6844903939268149262" target="_blank" rel=""><div data-v-d5649b80="">Flutter中的Flex布局和Web的CSS中的Flex布局类似。 在Flutter 中用于控制Flex布局的有Row，Column，Expanded，Flexible，Spacer，Flex这些控件。 子元素children的排列方式由这两个属性决定textDirectio…</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">1.1w</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            42
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            1
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="6844903990656761864" data-original-type="0" data-draft-id="6845076525994229773" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/3544481219221757" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">3年前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/%E5%89%8D%E7%AB%AF" target="_blank" rel="" class="tag">
        前端
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/6844903990656761864" target="_blank" rel="" title="动画：什么是闭包？" class="title">动画：什么是闭包？</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/6844903990656761864" target="_blank" rel=""><div data-v-d5649b80="">正在学习初学前端小伙伴，会感觉 HTML 和 CSS 太简单了，没什么挑战性。那是你没有学过 JS ，JS 中太多的概念初期学习的时候也是很懵逼的，比如 this、原型链、闭包等，即是重点，又是难点。但是你懂了之后会发现很简单，很好理解。 因为小鹿暑假去面试，每场面试基本都是必…</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">1.7w</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            374
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            67
          </span></li> <!----></ul></div> <img data-v-248050e4="" data-v-d5649b80="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/16e4e7c986fa5412_tplv-t2oaga2asx-no-mark_240_240_240_160.awebp" alt="动画：什么是闭包？" class="lazy thumb" loading="lazy" style=""></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="7079995358624874509" data-original-type="0" data-draft-id="7079014885744443429" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/2198625067468664" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">7月前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/JavaScript" target="_blank" rel="" class="tag">
        JavaScript
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/%E5%89%8D%E7%AB%AF" target="_blank" rel="" class="tag">
        前端
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/7079995358624874509" target="_blank" rel="" title="一文颠覆大众对闭包的认知" class="title">一文颠覆大众对闭包的认知</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/7079995358624874509" target="_blank" rel=""><div data-v-d5649b80="">网络上流传着许多对闭包的说法，这些说法为了方便理解曲解了闭包的真正原理，本文将会介绍这些原理，并且使用demo运行的结果来验证本文的正确性，这可能会颠覆你对闭包的认知，请在家长的陪同下阅读</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">1.6w</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            406
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            79
          </span></li> <!----></ul></div> <img data-v-248050e4="" data-v-d5649b80="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/6ea1e7e755494affaf6ba729dde36134_tplv-k3u1fbpfcp-no-mark_240_240_240_160.awebp" alt="一文颠覆大众对闭包的认知" class="lazy thumb" loading="lazy" style=""></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="6908926475731714062" data-original-type="0" data-draft-id="6908895439794208781" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/4353721778057997" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">1年前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/Flutter" target="_blank" rel="" class="tag">
        Flutter
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/6908926475731714062" target="_blank" rel="" title="Flutter：强迫症晚期如何把嵌套格式化的清清爽爽" class="title">Flutter：强迫症晚期如何把嵌套格式化的清清爽爽</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/6908926475731714062" target="_blank" rel=""><div data-v-d5649b80="">本文多以配图说明例子，我是使用的Mac的VSCode进行Flutter开发，那么下面进入正题。 没有一点代码洁癖的程序员不是好程序员，而Flutter的无尽嵌套往往会让人望而生畏，或者陷入崩溃。 多用逗号，就算是一个函数的最后一个入参，也请在后面追加一个逗号，配合格式化（VSC…</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">360</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            17
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            2
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="7050861660000976904" data-original-type="0" data-draft-id="7050861307951579143" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/1978776660216136" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">10月前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/%E5%89%8D%E7%AB%AF" target="_blank" rel="" class="tag">
        前端
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/JavaScript" target="_blank" rel="" class="tag">
        JavaScript
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/%E9%9D%A2%E8%AF%95" target="_blank" rel="" class="tag">
        面试
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/7050861660000976904" target="_blank" rel="" title="Day08 - 什么是闭包？如何制造闭包？" class="title">Day08 - 什么是闭包？如何制造闭包？</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/7050861660000976904" target="_blank" rel=""><div data-v-d5649b80="">基本概念 闭包是指有权访问另一个函数作用域中变量的函数 如何形成闭包 词法作用域对执行环境的保护 Javascript的作用域有两部分组成即词法作用域和动态作用域 前者是静态的，比如 隐藏地雷的秘密 </div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">4499</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            32
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            7
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="6978300325086101518" data-original-type="0" data-draft-id="6977567199477104676" class="entry" style="margin-bottom: 0px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/254742429175352" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">1年前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/%E5%89%8D%E7%AB%AF" target="_blank" rel="" class="tag">
        前端
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/Git" target="_blank" rel="" class="tag">
        Git
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 1px solid rgba(228, 230, 235, 0.5);"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/6978300325086101518" target="_blank" rel="" title="『前端进阶』—— 代码管理方案之Git Flow" class="title">『前端进阶』—— 代码管理方案之Git Flow</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/6978300325086101518" target="_blank" rel=""><div data-v-d5649b80="">本文将详细介绍一种代码管理方案（Git工作流）——Git Flow，希望对你有帮助，也欢迎在评论中讨论。</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">1070</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            32
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            2
          </span></li> <!----></ul></div> <!----></div> <!----> <!----></div> <!----></li><li data-v-2bf301c8="" data-growing-container="true" data-growing-title="entryList" class="item"><div data-v-d5649b80="" data-v-5a9d6e8e="" data-v-2bf301c8="" data-entry-id="7054205481190948894" data-original-type="0" data-draft-id="7053683178862542856" class="entry" style="margin-bottom: 20px;"><div data-v-d5649b80="" class="meta-container"><a data-v-d5649b80="" href="https://juejin.cn/user/4212984285249245" target="_blank" rel="" class="user-message"><div data-v-f1a2074a="" data-v-9421b4e2="" data-v-d5649b80="" class="popover-box user-popover"><!---->  
        
      </div></a> <div data-v-d5649b80="" class="date">10月前</div> <div data-v-d5649b80="" class="tag_list"><a data-v-d5649b80="" href="https://juejin.cn/tag/%E5%89%8D%E7%AB%AF" target="_blank" rel="" class="tag">
        前端
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/JavaScript" target="_blank" rel="" class="tag">
        JavaScript
      </a><a data-v-d5649b80="" href="https://juejin.cn/tag/%E9%9D%A2%E8%AF%95" target="_blank" rel="" class="tag">
        面试
      </a></div></div> <div data-v-d5649b80="" class="content-wrapper" style="border-bottom: 0px;"><div data-v-d5649b80="" class="content-main"><div data-v-d5649b80="" class="title-row"> <!----> <!----> <!----> <a data-v-d5649b80="" href="https://juejin.cn/post/7054205481190948894" target="_blank" rel="" title="一文彻底搞懂闭包" class="title">一文彻底搞懂闭包</a></div> <div data-v-d5649b80="" class="abstract"><a data-v-d5649b80="" href="https://juejin.cn/post/7054205481190948894" target="_blank" rel=""><div data-v-d5649b80="">都2022年了，竟然还有人不懂闭包？！ 一句话概括，闭包是指有权访问另一个函数作用域中的变量的函数。</div></a></div> <ul data-v-d5649b80="" class="action-list jh-timeline-action-area"><li data-v-d5649b80="" class="item view"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">4664</span></li> <li data-v-d5649b80="" class="item like"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            106
          </span></li> <li data-v-d5649b80="" class="item comment"><i data-v-d5649b80=""></i> <span data-v-d5649b80="">
            19
          </span></li> <!----></ul></div> <img data-v-248050e4="" data-v-d5649b80="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/17be3428a9744023ab2663cefeaf2b0a_tplv-k3u1fbpfcp-no-mark_240_240_240_160.awebp" alt="一文彻底搞懂闭包" class="lazy thumb" loading="lazy" style=""></div> <!----> <!----></div> <!----></li></div></div> <div data-v-d96003d4="" data-v-020666e8="" class="recommended-links main-area" data-v-4b9f9746=""><p data-v-d96003d4="">友情链接：</p> <ul data-v-d96003d4=""><li data-v-d96003d4=""><a data-v-d96003d4="" href="https://www.dongchedi.com/auto/series/4542" title="远志M1" target="_blank" rel="noopener noreferrer">
        远志M1
      </a></li><li data-v-d96003d4=""><a data-v-d96003d4="" href="https://www.dongchedi.com/auto/series/4543" title="奥迪e-tron" target="_blank" rel="noopener noreferrer">
        奥迪e-tron
      </a></li><li data-v-d96003d4=""><a data-v-d96003d4="" href="https://www.dongchedi.com/auto/series/4544" title="劲客e-POWER" target="_blank" rel="noopener noreferrer">
        劲客e-POWER
      </a></li><li data-v-d96003d4=""><a data-v-d96003d4="" href="https://www.dongchedi.com/auto/series/4545" title="ALPINA D3" target="_blank" rel="noopener noreferrer">
        ALPINA D3
      </a></li><li data-v-d96003d4=""><a data-v-d96003d4="" href="https://backend.devrank.cn/traffic-aggregation/1234134" title="python将多个txt合并成一个" target="_blank" rel="noopener noreferrer">
        python将多个txt合并成一个
      </a></li><li data-v-d96003d4=""><a data-v-d96003d4="" href="https://backend.devrank.cn/traffic-aggregation/1271255" title="sql查询同类条数" target="_blank" rel="noopener noreferrer">
        sql查询同类条数
      </a></li><li data-v-d96003d4=""><a data-v-d96003d4="" href="https://backend.devrank.cn/traffic-aggregation/1271299" title="python filter list by object attribute" target="_blank" rel="noopener noreferrer">
        python filter list by object attribute
      </a></li><li data-v-d96003d4=""><a data-v-d96003d4="" href="https://backend.devrank.cn/traffic-aggregation/1271300" title="python opencv 介绍" target="_blank" rel="noopener noreferrer">
        python opencv 介绍
      </a></li><li data-v-d96003d4=""><a data-v-d96003d4="" href="https://backend.devrank.cn/traffic-aggregation/1234138" title="python get返回json数据" target="_blank" rel="noopener noreferrer">
        python get返回json数据
      </a></li><li data-v-d96003d4=""><a data-v-d96003d4="" href="https://backend.devrank.cn/traffic-aggregation/1271297" title="java扫描充值卡" target="_blank" rel="noopener noreferrer">
        java扫描充值卡
      </a></li></ul></div> <div st:block="sidebar" class="sidebar sidebar" style="" data-v-4a8226b0="" data-v-020666e8="" data-v-4b9f9746=""><div class="sidebar-block author-block pure" data-v-71f2d09e="" data-v-2d7c39c6="" data-v-4a8226b0=""><a href="https://juejin.cn/user/465848663023160" target="_blank" rel="" class="user-item item" data-v-2d7c39c6="" data-v-71f2d09e=""><img src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/2c3d36ac68756ea7f747669b94554d42_100x100.awebp" alt="" class="lazy avatar avatar" data-v-248050e4="" data-v-47508ed8="" data-v-2d7c39c6="" loading="lazy"> <div class="info-box" data-v-2d7c39c6=""><a data-v-0ef8bafa="" data-v-2d7c39c6="" href="https://juejin.cn/user/465848663023160" target="_blank" rel="" class="username"><span data-v-0ef8bafa="" class="name" style="max-width: 128px;">
      花花子
    </span> <span data-v-3de16c56="" data-v-0ef8bafa="" blank="true" class="rank"><img data-v-3de16c56="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/lv-4.a78c420.png" alt="lv-4" title="创作等级"></span> <!----> <div data-v-38a29e30="" data-v-0ef8bafa="" class="vip-level"><span data-v-38a29e30="" class="tooltip"><div class="byte-tooltip byte-tooltip--dark" style="display: none;">
        VIP.4 融会贯通
      </div><span class="byte-tooltip__wrapper"><img data-v-38a29e30="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/07302452a7ad81cb43a173b5cd580237.svg" alt=""></span></span></div> </a> <div title="学生 @ 新东方烹饪学校" class="position" data-v-2d7c39c6="">
        学生 @ 新东方烹饪学校
      </div></div></a> <div class="operate-btn" data-v-71f2d09e="" data-v-2d7c39c6=""><button st:name="followBtn" class="ui-btn follow-btn primary large default attention" data-v-05e27314="" data-v-2d7c39c6="" data-v-71f2d09e=""><!----> 
    关注
  </button> <a href="https://juejin.cn/notification/im?participantId=465848663023160" class="im-button im-btn" data-v-11443840="" data-v-2d7c39c6="" data-v-71f2d09e=""><!----> <div data-v-11443840="">私信</div></a></div> <div class="cut-off" data-v-71f2d09e="" data-v-2d7c39c6=""></div>  <div class="stat-item item" data-v-71f2d09e="" data-v-2d7c39c6=""><svg xmlns="http://www.w3.org/2000/svg" width="25" height="26" viewBox="0 0 25 26" class="zan" data-v-71f2d09e="" data-v-2d7c39c6=""><g fill="none" fill-rule="evenodd" transform="translate(0 .57)" data-v-71f2d09e="" data-v-2d7c39c6=""><ellipse cx="12.5" cy="12.57" fill="#E1EFFF" rx="12.5" ry="12.57" data-v-71f2d09e="" data-v-2d7c39c6=""></ellipse><path fill="#7BB9FF" d="M8.596 11.238V19H7.033C6.463 19 6 18.465 6 17.807v-5.282c0-.685.483-1.287 1.033-1.287h1.563zm4.275-4.156A1.284 1.284 0 0 1 14.156 6c.885.016 1.412.722 1.595 1.07.334.638.343 1.687.114 2.361-.207.61-.687 1.412-.687 1.412h3.596c.38 0 .733.178.969.488.239.317.318.728.21 1.102l-1.628 5.645a1.245 1.245 0 0 1-1.192.922h-7.068v-7.889c1.624-.336 2.623-2.866 2.806-4.029z" data-v-71f2d09e="" data-v-2d7c39c6=""></path></g></svg> <span class="content" data-v-71f2d09e="" data-v-2d7c39c6="">
      获得点赞
      <span class="count" data-v-71f2d09e="" data-v-2d7c39c6="">&nbsp;365</span></span></div> <div class="stat-item item" data-v-71f2d09e="" data-v-2d7c39c6=""><svg width="25" height="25" viewBox="0 0 25 25" class="icon stat-view-icon" data-v-71f2d09e="" data-v-2d7c39c6=""><g fill="none" fill-rule="evenodd" data-v-71f2d09e="" data-v-2d7c39c6=""><circle cx="12.5" cy="12.5" r="12.5" fill="#E1EFFF" data-v-71f2d09e="" data-v-2d7c39c6=""></circle><path fill="#7BB9FF" d="M4 12.5S6.917 7 12.75 7s8.75 5.5 8.75 5.5-2.917 5.5-8.75 5.5S4 12.5 4 12.5zm8.75 2.292c1.208 0 2.188-1.026 2.188-2.292 0-1.266-.98-2.292-2.188-2.292-1.208 0-2.188 1.026-2.188 2.292 0 1.266.98 2.292 2.188 2.292z" data-v-71f2d09e="" data-v-2d7c39c6=""></path></g></svg> <span class="content" data-v-71f2d09e="" data-v-2d7c39c6="">
      文章被阅读
      <span class="count" data-v-71f2d09e="" data-v-2d7c39c6="">&nbsp;97,818</span></span></div> <!----></div> <ul data-v-4a8226b0="" class="sidebar-bd-entry"><li data-v-4a8226b0=""><a data-v-25f2c691="" data-v-4a8226b0="" href="https://conf.juejin.cn/future2022/?utm_source=jjtofu1" target="_blank" class="sidebar-entry" style="background-image: url(&quot;https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/646c43a0f83d4fc584eec1f18f7f14ac~tplv-k3u1fbpfcp-watermark.image?&quot;);"></a></li><li data-v-4a8226b0=""><a data-v-25f2c691="" data-v-4a8226b0="" href="https://juejin.cn/post/7162096952883019783?utm_source=article&amp;utm_medium=banner&amp;utm_campaign=jinshijihua02" target="_blank" class="sidebar-entry" style="background-image: url(&quot;https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/45c30b323e2042e39beb0a32e903a4cc~tplv-k3u1fbpfcp-watermark.image?&quot;);"></a></li><li data-v-4a8226b0=""><a data-v-25f2c691="" data-v-4a8226b0="" href="https://juejin.cn/live/2209714" target="_blank" class="sidebar-entry" style="background-image: url(&quot;https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3d18575a69084ee08671ccb09d506659~tplv-k3u1fbpfcp-watermark.image?&quot;);"></a></li></ul> <a href="https://juejin.cn/user/center/signin?from=item" target="" rel="" data-v-4a8226b0=""><img data-v-4a8226b0="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/sign-in.d6891e5.png" alt="限时领掘金会员" class="banner"></a> <!----> <div data-v-71f2d09e="" data-v-54794b76="" data-v-4a8226b0="" class="sidebar-block related-entry-sidebar-block shadow" st:block="relatedEntrySidebarBlock"><div data-v-71f2d09e="" class="block-title">相关文章</div> <div data-v-71f2d09e="" class="block-body"><div data-v-54794b76="" data-v-71f2d09e="" class="entry-list"><a data-v-54794b76="" href="https://juejin.cn/post/6937469222251560990" target="_blank" rel="" st:name="link" title="JS 闭包经典使用场景和含闭包必刷题 " class="item" data-v-71f2d09e=""><div data-v-54794b76="" class="entry-title">JS 闭包经典使用场景和含闭包必刷题 </div> <div data-v-54794b76="" class="entry-meta-box"><div data-v-54794b76="" class="entry-meta">587点赞</div> <div data-v-54794b76="" class="entry-meta">&nbsp;·&nbsp;</div> <div data-v-54794b76="" class="entry-meta">82评论</div></div></a><a data-v-54794b76="" href="https://juejin.cn/post/6844903858636849159" target="_blank" rel="" st:name="link" title="我从来不理解JavaScript闭包，直到有人这样向我解释它" class="item" data-v-71f2d09e=""><div data-v-54794b76="" class="entry-title">我从来不理解JavaScript闭包，直到有人这样向我解释它</div> <div data-v-54794b76="" class="entry-meta-box"><div data-v-54794b76="" class="entry-meta">2230点赞</div> <div data-v-54794b76="" class="entry-meta">&nbsp;·&nbsp;</div> <div data-v-54794b76="" class="entry-meta">240评论</div></div></a><a data-v-54794b76="" href="https://juejin.cn/post/6844903612879994887" target="_blank" rel="" st:name="link" title="闭包详解一" class="item" data-v-71f2d09e=""><div data-v-54794b76="" class="entry-title">闭包详解一</div> <div data-v-54794b76="" class="entry-meta-box"><div data-v-54794b76="" class="entry-meta">573点赞</div> <div data-v-54794b76="" class="entry-meta">&nbsp;·&nbsp;</div> <div data-v-54794b76="" class="entry-meta">25评论</div></div></a><a data-v-54794b76="" href="https://juejin.cn/post/7092366305977696287" target="_blank" rel="" st:name="link" title="通过 javax.mail 实现系统异常自动告警" class="item" data-v-71f2d09e=""><div data-v-54794b76="" class="entry-title">通过 javax.mail 实现系统异常自动告警</div> <div data-v-54794b76="" class="entry-meta-box"><div data-v-54794b76="" class="entry-meta">1点赞</div> <div data-v-54794b76="" class="entry-meta">&nbsp;·&nbsp;</div> <div data-v-54794b76="" class="entry-meta">0评论</div></div></a><a data-v-54794b76="" href="https://juejin.cn/post/6844903972977770503" target="_blank" rel="" st:name="link" title="Scala 初体验" class="item" data-v-71f2d09e=""><div data-v-54794b76="" class="entry-title">Scala 初体验</div> <div data-v-54794b76="" class="entry-meta-box"><div data-v-54794b76="" class="entry-meta">4点赞</div> <div data-v-54794b76="" class="entry-meta">&nbsp;·&nbsp;</div> <div data-v-54794b76="" class="entry-meta">5评论</div></div></a></div></div></div> <div class="sticky-block-box" data-v-4a8226b0=""><div class="sidebar-block catalog-block catalog-block pure" style="" data-v-71f2d09e="" data-v-4a8226b0=""><nav class="article-catalog" style="" data-v-cb93f23a="" data-v-71f2d09e=""><div class="catalog-title" data-v-cb93f23a="">目录</div> <div class="catalog-body" data-v-cb93f23a=""><ul class="catalog-list" style="margin-top:0px;" data-v-cb93f23a=""><li data-v-cb93f23a="" class="item d1"><div class="a-container"><a href="https://juejin.cn/post/6956793861570035742#heading-0" title="4. 闭包" class="catalog-aTag">
      4. 闭包
    </a></div> <ul class="sub-list"><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6956793861570035742#heading-1" title="4.1 Groovy 中的闭包" class="catalog-aTag">
      4.1 Groovy 中的闭包
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6956793861570035742#heading-2" title="4.2  Execute Around Method &amp; AOP" class="catalog-aTag">
      4.2  Execute Around Method &amp; AOP
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6956793861570035742#heading-3" title="4.3 可利用闭包自动清理资源" class="catalog-aTag">
      4.3 可利用闭包自动清理资源
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6956793861570035742#heading-4" title="4.4 闭包柯里化" class="catalog-aTag">
      4.4 闭包柯里化
    </a></div> <ul class="sub-list"><li class="item d3"><div class="a-container"><a href="https://juejin.cn/post/6956793861570035742#heading-5" title="4.4.1 便捷的柯里化转换方法" class="catalog-aTag">
      4.4.1 便捷的柯里化转换方法
    </a></div> <!----></li></ul></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6956793861570035742#heading-6" title="4.5 动态闭包" class="catalog-aTag">
      4.5 动态闭包
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6956793861570035742#heading-7" title="4.6 闭包执行上下文与闭包委托" class="catalog-aTag">
      4.6 闭包执行上下文与闭包委托
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6956793861570035742#heading-8" title="4.7 尾递归" class="catalog-aTag">
      4.7 尾递归
    </a></div> <!----></li><li class="item d2"><div class="a-container"><a href="https://juejin.cn/post/6956793861570035742#heading-9" title="4.8 从钢条切割问题探讨递归优化" class="catalog-aTag">
      4.8 从钢条切割问题探讨递归优化
    </a></div> <ul class="sub-list"><li class="item d3"><div class="a-container"><a href="https://juejin.cn/post/6956793861570035742#heading-10" title="4.8.1 利用记忆化改进性能" class="catalog-aTag">
      4.8.1 利用记忆化改进性能
    </a></div> <!----></li><li class="item d3"><div class="a-container"><a href="https://juejin.cn/post/6956793861570035742#heading-11" title="4.8.2 画龙点睛之 memoize()" class="catalog-aTag">
      4.8.2 画龙点睛之 memoize()
    </a></div> <!----></li></ul></li></ul></li></ul></div></nav></div> <nav data-v-04051bd0="" data-v-4a8226b0="" class="next-article"><div data-v-04051bd0="" class="next-article-header"><div data-v-04051bd0="" class="next-article-title">下一篇</div> <svg data-v-04051bd0="" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="list-icon"><path data-v-04051bd0="" fill-rule="evenodd" clip-rule="evenodd" d="M2.00001 2C1.63182 2 1.33334 2.29848 1.33334 2.66667C1.33334 3.03486 1.63182 3.33333 2.00001 3.33333H3.33334C3.70153 3.33333 4.00001 3.03486 4.00001 2.66667C4.00001 2.29848 3.70153 2 3.33334 2H2.00001ZM6.00034 2C5.63215 2 5.33367 2.29848 5.33367 2.66667C5.33367 3.03486 5.63215 3.33333 6.00034 3.33333H14.0003C14.3685 3.33333 14.667 3.03486 14.667 2.66667C14.667 2.29848 14.3685 2 14.0003 2H6.00034ZM6.00034 7.33333C5.63215 7.33333 5.33367 7.63181 5.33367 8C5.33367 8.36819 5.63215 8.66667 6.00034 8.66667H14.0003C14.3685 8.66667 14.667 8.36819 14.667 8C14.667 7.63181 14.3685 7.33333 14.0003 7.33333H6.00034ZM1.33367 8C1.33367 7.63181 1.63215 7.33333 2.00034 7.33333H3.33367C3.70186 7.33333 4.00034 7.63181 4.00034 8C4.00034 8.36819 3.70186 8.66667 3.33367 8.66667H2.00034C1.63215 8.66667 1.33367 8.36819 1.33367 8ZM1.33367 13.3333C1.33367 12.9651 1.63215 12.6667 2.00034 12.6667H3.33367C3.70186 12.6667 4.00034 12.9651 4.00034 13.3333C4.00034 13.7015 3.70186 14 3.33367 14H2.00034C1.63215 14 1.33367 13.7015 1.33367 13.3333ZM6.00034 12.6667C5.63215 12.6667 5.33367 12.9651 5.33367 13.3333C5.33367 13.7015 5.63215 14 6.00034 14H14.0003C14.3685 14 14.667 13.7015 14.667 13.3333C14.667 12.9651 14.3685 12.6667 14.0003 12.6667H6.00034Z"></path></svg></div> <hr data-v-04051bd0="" class="next-article-hr"> <div data-v-04051bd0="" class="article-content"><a data-v-04051bd0="" href="https://juejin.cn/post/6955097665969324063" title="通过 Groovy 了解动态语言" target="_blank" class="article">
      通过 Groovy 了解动态语言
    </a></div> <!----></nav></div></div> <div class="article-suspended-panel article-suspended-panel" data-v-b7c4e7d2="" data-v-020666e8="" data-v-4b9f9746=""><svg xmlns="http://www.w3.org/2000/svg" style="display:none;" data-v-b7c4e7d2="" class=""><symbol id="icon-collect" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-v-b7c4e7d2=""><path fill-rule="evenodd" clip-rule="evenodd" d="M5.24287 18.3845C4.89724 18.5507 4.48229 18.4053 4.31605 18.0596C4.26029 17.9437 4.23783 17.8146 4.25117 17.6866L4.75725 12.8332C4.77762 12.6379 4.71431 12.443 4.583 12.297L1.29207 8.63594C1.03567 8.35071 1.05905 7.91164 1.34428 7.65524C1.43464 7.574 1.54475 7.5179 1.66358 7.49254L6.47789 6.46509C6.66998 6.42409 6.83572 6.30367 6.93407 6.13365L9.39894 1.87248C9.59098 1.54049 10.0158 1.42704 10.3478 1.61907C10.453 1.67992 10.5403 1.76729 10.6012 1.87248L13.0661 6.13365C13.1644 6.30367 13.3301 6.42409 13.5222 6.46509L18.3365 7.49254C18.7116 7.57259 18.9508 7.94155 18.8707 8.31664C18.8454 8.43547 18.7893 8.54557 18.708 8.63594L15.4171 12.297C15.2858 12.443 15.2225 12.6379 15.2429 12.8332L15.7489 17.6866C15.7887 18.0681 15.5117 18.4096 15.1303 18.4493C15.0023 18.4627 14.8732 18.4402 14.7572 18.3845L10.3011 16.2412C10.1108 16.1497 9.8893 16.1497 9.69906 16.2412L5.24287 18.3845Z" data-v-b7c4e7d2=""></path></symbol><symbol id="icon-comment" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-v-b7c4e7d2=""><path fill-rule="evenodd" clip-rule="evenodd" d="M4.62739 1.25C2.9347 1.25 1.5625 2.6222 1.5625 4.31489L1.56396 12.643C1.56403 14.3356 2.9362 15.7078 4.62885 15.7078H6.48326L6.93691 17.6869L6.93884 17.6948C7.16894 18.6441 8.28598 19.0599 9.08073 18.4921L12.7965 15.7078H15.5001C17.1928 15.7078 18.565 14.3355 18.565 12.6428L18.5635 4.31477C18.5635 2.62213 17.1913 1.25 15.4986 1.25H4.62739ZM5.98265 9.89255C6.68783 9.89255 7.2595 9.32089 7.2595 8.61571C7.2595 7.91053 6.68783 7.33887 5.98265 7.33887C5.27747 7.33887 4.70581 7.91053 4.70581 8.61571C4.70581 9.32089 5.27747 9.89255 5.98265 9.89255ZM9.95604 9.89255C10.6612 9.89255 11.2329 9.32089 11.2329 8.61571C11.2329 7.91053 10.6612 7.33887 9.95604 7.33887C9.25086 7.33887 8.6792 7.91053 8.6792 8.61571C8.6792 9.32089 9.25086 9.89255 9.95604 9.89255ZM15.2124 8.61571C15.2124 9.32089 14.6407 9.89255 13.9355 9.89255C13.2304 9.89255 12.6587 9.32089 12.6587 8.61571C12.6587 7.91053 13.2304 7.33887 13.9355 7.33887C14.6407 7.33887 15.2124 7.91053 15.2124 8.61571Z" data-v-b7c4e7d2=""></path></symbol><symbol id="icon-zan" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-v-b7c4e7d2=""><path fill-rule="evenodd" clip-rule="evenodd" d="M13.0651 3.25923C12.6654 2.21523 12.1276 1.60359 11.4633 1.40559C10.8071 1.21 10.2539 1.48626 9.97848 1.67918C9.43962 2.05668 9.17297 2.64897 9.0009 3.12662C8.93522 3.30893 8.87504 3.50032 8.82077 3.67291L8.82077 3.67292C8.80276 3.73019 8.78541 3.78539 8.76872 3.8375C8.6974 4.06017 8.63455 4.23905 8.56561 4.38315C8.07104 5.41687 7.64014 6.034 7.2617 6.43277C6.89154 6.8228 6.5498 7.0275 6.18413 7.21038C5.8887 7.35813 5.69369 7.66144 5.69365 8.00211L5.69237 17.3908C5.6923 17.8783 6.08754 18.2736 6.57511 18.2736H14.8382C15.2621 18.2736 15.5829 18.1393 15.8149 17.9421C15.9234 17.8497 15.9985 17.7554 16.0484 17.6856C16.0695 17.6561 16.088 17.6282 16.0983 17.6126L16.1017 17.6075L16.1033 17.6051L16.1194 17.5857L16.1428 17.5478C16.913 16.3019 17.4472 15.3088 17.8659 14.1183C18.3431 12.7613 18.5849 11.5853 18.6874 10.6685C18.7871 9.77617 18.7612 9.07318 18.6558 8.68779C18.5062 8.14118 18.138 7.82653 17.7668 7.66617C17.4231 7.51771 17.0763 7.49836 16.8785 7.49807L13.1134 7.44551C13.662 5.19751 13.31 3.89889 13.0651 3.25923ZM1.251 8.0848C1.22726 7.5815 1.62891 7.16046 2.13277 7.16046H3.4408C3.92832 7.16046 4.32354 7.55568 4.32354 8.04321V17.4303C4.32354 17.9178 3.92832 18.313 3.4408 18.313H2.57554C2.10419 18.313 1.71599 17.9427 1.69378 17.4718L1.251 8.0848Z" data-v-b7c4e7d2=""></path></symbol><symbol id="icon-share" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-v-b7c4e7d2=""><path fill-rule="evenodd" clip-rule="evenodd" d="M10.4167 6.40399C5.35406 6.40399 1.25 10.5675 1.25 15.7035C1.25 16.0225 1.28448 16.4512 1.35344 16.9898C1.36807 17.1039 1.47243 17.1846 1.58655 17.17C1.6483 17.1621 1.70328 17.127 1.73643 17.0743L1.86865 16.8676C1.99553 16.6731 2.10644 16.5147 2.20137 16.3925C3.69554 14.4692 6.13777 13.3823 9.35515 13.3378L10.4167 13.3364V17.0757C10.4167 17.3101 10.6086 17.5 10.8453 17.5C10.959 17.5 11.068 17.4553 11.1483 17.3757L18.145 10.45C18.3961 10.2015 18.3961 9.79853 18.145 9.55L11.1483 2.62426C10.981 2.45858 10.7096 2.45858 10.5422 2.62426C10.4618 2.70383 10.4167 2.81174 10.4167 2.92426V6.40399Z" data-v-b7c4e7d2=""></path></symbol><symbol id="icon-report" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-v-b7c4e7d2=""><path fill-rule="evenodd" clip-rule="evenodd" d="M10.8389 1.89381C11.0873 2.03868 11.2939 2.24532 11.4388 2.49366L18.9369 15.0065C19.4007 15.8015 19.1322 16.8221 18.3371 17.2859C18.0822 17.4346 17.7924 17.5129 17.4973 17.5129H2.50041C1.57993 17.5129 0.83374 16.7667 0.83374 15.8462C0.83374 15.5512 0.912088 15.2614 1.06078 15.0065L8.5595 2.49366C9.0233 1.69857 10.0438 1.43001 10.8389 1.89381ZM10.3118 13.3459C10.6283 13.3459 10.8848 13.6025 10.8848 13.9189V14.4918C10.8848 14.8082 10.6283 15.0647 10.3118 15.0647H9.73893C9.42252 15.0647 9.16602 14.8082 9.16602 14.4918V13.9189C9.16602 13.6025 9.42252 13.3459 9.73893 13.3459H10.3118ZM10.8356 7.09513C10.8356 6.86502 10.6491 6.67847 10.419 6.67847H9.58512C9.35501 6.67847 9.16846 6.86502 9.16846 7.09513V12.0956C9.16846 12.3257 9.35501 12.5123 9.58512 12.5123H10.419C10.6491 12.5123 10.8356 12.3257 10.8356 12.0956V7.09513Z" data-v-b7c4e7d2=""></path></symbol><symbol id="icon-immerse" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-v-b7c4e7d2=""><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 1C0.25 0.585786 0.585786 0.25 1 0.25H4C4.41421 0.25 4.75 0.585786 4.75 1C4.75 1.41421 4.41421 1.75 4 1.75H1.75V4C1.75 4.41421 1.41421 4.75 1 4.75C0.585786 4.75 0.25 4.41421 0.25 4V1ZM0.25 19C0.25 19.4142 0.585786 19.75 1 19.75H4C4.41421 19.75 4.75 19.4142 4.75 19C4.75 18.5858 4.41421 18.25 4 18.25H1.75V16C1.75 15.5858 1.41421 15.25 1 15.25C0.585786 15.25 0.25 15.5858 0.25 16V19ZM19 0.25C19.4142 0.25 19.75 0.585786 19.75 1V4C19.75 4.41421 19.4142 4.75 19 4.75C18.5858 4.75 18.25 4.41421 18.25 4V1.75H16C15.5858 1.75 15.25 1.41421 15.25 1C15.25 0.585786 15.5858 0.25 16 0.25H19ZM19.75 19C19.75 19.4142 19.4142 19.75 19 19.75H16C15.5858 19.75 15.25 19.4142 15.25 19C15.25 18.5858 15.5858 18.25 16 18.25H18.25V16C18.25 15.5858 18.5858 15.25 19 15.25C19.4142 15.25 19.75 15.5858 19.75 16V19ZM7 5C5.89543 5 5 5.89543 5 7V13C5 14.1046 5.89543 15 7 15H13C14.1046 15 15 14.1046 15 13V7C15 5.89543 14.1046 5 13 5H7Z" data-v-b7c4e7d2=""></path></symbol><symbol id="icon-wechat" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-v-b7c4e7d2=""><path fill-rule="evenodd" clip-rule="evenodd" d="M13.5578 5.34061C12.0476 2.85722 8.90911 1.73257 6.11813 2.05358C4.56413 2.23231 3.0449 2.85861 1.88463 3.92471C1.00689 4.72863 0.354462 5.78486 0.109889 6.95889C-0.187864 8.37395 0.125815 9.85314 0.957723 11.0298C1.28982 11.4994 1.68479 11.9193 2.11951 12.2941C2.25136 12.4079 2.38694 12.5172 2.52543 12.6228C2.59301 12.6742 2.66115 12.7249 2.73011 12.7745C2.74195 12.7831 2.75392 12.7902 2.76512 12.7969C2.80389 12.8201 2.83351 12.8378 2.81653 12.8887L2.67458 13.3177C2.53986 13.7252 2.40492 14.1325 2.26998 14.5399C2.22084 14.6883 2.17169 14.8366 2.12256 14.985L2.61572 14.7368C2.85714 14.6151 3.09863 14.4935 3.34012 14.3719C3.58099 14.2507 3.82186 14.1294 4.06266 14.0081L4.40902 13.8337C4.42474 13.8257 4.44104 13.8164 4.45775 13.8069C4.51759 13.7728 4.58265 13.7356 4.64501 13.7481C4.76613 13.7723 4.88708 13.7972 5.00801 13.8221C5.08094 13.8372 5.15386 13.8522 5.22681 13.867C6.06287 14.0373 6.88508 14.1348 7.73859 14.0675C7.4486 13.0669 7.44915 12.0016 7.7559 11.0045C8.09853 9.88624 8.81438 8.89831 9.74448 8.19773C11.0171 7.23915 12.6431 6.81493 14.2212 6.99199C14.0895 6.4081 13.8688 5.85148 13.5578 5.34061ZM4.77922 5.02147C4.28094 5.02147 3.71299 5.35514 3.71299 5.90829C3.71299 6.46088 4.28066 6.79844 4.77922 6.79844C5.29233 6.79844 5.66293 6.42291 5.66293 5.90829C5.66293 5.39311 5.29205 5.02147 4.77922 5.02147ZM10.6158 5.90829C10.6158 6.42444 10.2434 6.79844 9.7296 6.79844C9.23076 6.79844 8.66641 6.46032 8.66641 5.90829C8.66641 5.3557 9.23104 5.02147 9.7296 5.02147C10.2431 5.02147 10.6158 5.39158 10.6158 5.90829ZM17.7911 8.53846C15.3552 6.80489 11.734 6.93368 9.53048 9.01108C8.77779 9.72181 8.22909 10.6485 8.04061 11.6744C7.78288 13.0799 8.22536 14.5441 9.17304 15.605C10.0674 16.6063 11.2889 17.2564 12.5986 17.5166C13.4216 17.6806 14.2559 17.6931 15.0799 17.5344C15.2863 17.4948 15.4911 17.4481 15.6954 17.3986C15.7826 17.3774 15.8697 17.3559 15.9568 17.334C15.9655 17.3319 15.9784 17.3272 15.9934 17.3219C16.0359 17.3068 16.0949 17.2858 16.118 17.2984C16.2476 17.3695 16.3771 17.4408 16.5066 17.5122L17.0557 17.8142L17.0577 17.8153L17.0598 17.8164C17.3912 17.9986 17.7227 18.1809 18.054 18.3634C17.9748 18.0977 17.895 17.832 17.8153 17.5664L17.8146 17.5641L17.6749 17.0981L17.5814 16.7863L17.5332 16.6257C17.5159 16.5675 17.5927 16.5183 17.6556 16.4779C17.6753 16.4653 17.6937 16.4535 17.7073 16.4426C18.0608 16.1622 18.3952 15.8558 18.6963 15.5191C19.1832 14.9747 19.5895 14.3498 19.8161 13.6505C20.0122 13.039 20.0488 12.392 19.9377 11.7604C19.7098 10.438 18.8643 9.30511 17.7911 8.53846ZM15.2396 11.0049C15.1595 10.6088 15.5334 10.1787 15.931 10.1787C16.3063 10.1787 16.7409 10.3931 16.8096 10.7989C16.8724 11.1695 16.556 11.4696 16.227 11.5617C15.8032 11.6802 15.3326 11.4649 15.2396 11.0049ZM12.0348 10.1787C11.6369 10.1787 11.2573 10.6064 11.3385 11.0049C11.4325 11.4667 11.9081 11.68 12.3327 11.5617C12.6626 11.4696 12.9753 11.1695 12.9134 10.7989C12.8453 10.3914 12.4112 10.1787 12.0348 10.1787Z" data-v-b7c4e7d2=""></path></symbol><symbol id="icon-weibo" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-v-b7c4e7d2=""><path fill-rule="evenodd" clip-rule="evenodd" d="M-0.000244141 13.0984C-0.000244141 8.70757 6.6145 3.5004 9.18008 4.57052C10.1717 4.98415 9.97381 6.1693 9.85415 6.88576C9.8069 7.16863 9.77186 7.37844 9.82705 7.43887C9.92921 7.55074 10.2955 7.42054 10.7994 7.2414C11.8362 6.87286 13.4557 6.2972 14.5566 7.19617C15.2665 7.77576 14.9657 8.72382 14.7905 9.27603C14.7289 9.4701 14.6829 9.61528 14.7017 9.6784C14.741 9.81053 14.9858 9.91133 15.317 10.0477C15.926 10.2984 16.8269 10.6692 17.2784 11.5759C18.3716 13.7713 15.2036 18.2504 8.62234 18.2504C3.25024 18.2504 -0.000244141 15.6688 -0.000244141 13.0984ZM8.45309 17.057C11.7733 16.7393 14.2944 14.7397 14.0842 12.5908C13.874 10.4418 11.012 8.95732 7.69179 9.27503C4.37159 9.59274 1.85045 11.5924 2.06068 13.7413C2.2709 15.8902 5.13288 17.3747 8.45309 17.057Z" data-v-b7c4e7d2=""></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7098 12.7012C11.1162 14.1374 10.0604 15.6852 8.35157 16.1581C6.64275 16.6311 4.92801 15.8502 4.5216 14.4139C4.11518 12.9777 5.171 11.4299 6.87982 10.957C8.58865 10.484 10.3034 11.2649 10.7098 12.7012ZM7.67026 13.6265C7.89619 14.1072 7.61751 14.7092 7.04779 14.9711C6.47808 15.2331 5.83308 15.0558 5.60715 14.5751C5.38122 14.0945 5.6599 13.4925 6.22962 13.2306C6.79933 12.9686 7.44433 13.1459 7.67026 13.6265ZM8.41746 13.3766C8.63945 13.2745 8.74804 13.0399 8.66001 12.8526C8.57197 12.6654 8.32065 12.5963 8.09866 12.6984C7.87667 12.8004 7.76808 13.035 7.85612 13.2223C7.94415 13.4095 8.19547 13.4786 8.41746 13.3766Z" data-v-b7c4e7d2=""></path><path d="M13.648 3.54836C13.9523 3.47388 14.2712 3.43418 14.6004 3.43418C16.7813 3.43418 18.5492 5.18267 18.5492 7.33955C18.5492 7.81593 18.4633 8.27085 18.3066 8.69104C18.168 9.06261 18.3602 9.47493 18.7359 9.61199C19.1116 9.74904 19.5285 9.55894 19.6671 9.18737C19.8822 8.61063 19.9993 7.98781 19.9993 7.33955C19.9993 4.3906 17.5822 2 14.6004 2C14.1528 2 13.717 2.05403 13.2996 2.15619C12.9109 2.25133 12.6738 2.64011 12.77 3.02455C12.8662 3.40899 13.2593 3.6435 13.648 3.54836Z" data-v-b7c4e7d2=""></path><path d="M14.2887 6.05162C14.388 6.02824 14.4923 6.01569 14.6004 6.01569C15.3397 6.01569 15.939 6.6084 15.939 7.33955C15.939 7.49914 15.9108 7.65062 15.8596 7.7904C15.7232 8.16277 15.9179 8.57396 16.2944 8.70881C16.6709 8.84366 17.0867 8.65112 17.2231 8.27875C17.3307 7.98466 17.3891 7.66805 17.3891 7.33955C17.3891 5.81633 16.1406 4.58152 14.6004 4.58152C14.3784 4.58152 14.1614 4.60734 13.9529 4.65643C13.5633 4.74813 13.3227 5.1348 13.4154 5.52008C13.5082 5.90535 13.8991 6.14333 14.2887 6.05162Z" data-v-b7c4e7d2=""></path></symbol><symbol id="icon-qq" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-v-b7c4e7d2=""><path d="M11.8841 17.1943C11.1815 17.1943 10.5625 17.2136 10.0541 17.26C9.44625 17.2112 8.8365 17.1898 8.22671 17.1956C6.20498 17.1956 4.40588 17.9613 4.40588 18.5263C4.40588 19.0681 5.89998 19.0076 7.91657 18.987C8.64426 18.985 9.3699 18.9096 10.0824 18.7618C10.6796 18.8879 11.4079 18.9677 12.193 18.9741C14.2095 18.9947 15.7024 19.0552 15.7024 18.5173C15.7024 17.9549 13.9045 17.1943 11.8841 17.1943V17.1943Z" data-v-b7c4e7d2=""></path><path d="M16.9138 11.6311C16.5346 10.6112 16.1212 9.60428 15.6745 8.61206C15.6951 8.37141 15.7054 8.12818 15.7054 7.8811C15.7054 4.08086 13.7622 1 10.0649 1C6.36759 1 4.42307 4.08086 4.42307 7.8811C4.42307 8.11274 4.43208 8.34052 4.45138 8.56573C3.99804 9.5756 3.57913 10.6006 3.19536 11.6389C2.41678 13.7494 2.38203 15.6566 2.65357 15.7982C2.84661 15.8985 3.54797 15.1611 4.21845 13.9669C4.66115 16.7801 6.53102 18.8842 10.0649 18.8842C13.5871 18.8842 15.457 16.7916 15.9074 13.99C16.5728 15.1611 17.2664 15.8818 17.4569 15.7814C17.7284 15.6399 17.6937 13.7365 16.9138 11.6311V11.6311Z" data-v-b7c4e7d2=""></path><path d="M8.5542 3.2522C8.00598 3.26507 7.57358 3.90981 7.58902 4.69739C7.60447 5.48369 8.06132 6.11299 8.60954 6.1027C9.15776 6.0924 9.59016 5.44637 9.57472 4.65879C9.56056 3.87249 9.10243 3.24319 8.5542 3.25348V3.2522ZM11.5862 3.26764C11.0315 3.25734 10.5695 3.88278 10.5541 4.66651C10.5386 5.44895 10.9749 6.0924 11.5308 6.1027C12.0842 6.11299 12.5475 5.48755 12.5629 4.70512C12.5784 3.92139 12.1408 3.27794 11.5862 3.26764V3.26764Z" data-v-b7c4e7d2=""></path><path d="M13.6704 9.57861C12.5971 9.76521 11.354 9.87074 10.0285 9.87074C8.7287 9.87074 7.50742 9.76779 6.44959 9.58762C5.71605 10.4962 5.65942 11.8307 5.65942 13.3184C5.65942 16.0505 7.20371 18.2665 10.0645 18.2665C12.924 18.2665 14.4696 16.0505 14.4696 13.3184C14.4696 11.8243 14.4104 10.4859 13.6704 9.57861V9.57861Z" data-v-b7c4e7d2=""></path><path d="M10.0628 6.56616C8.14273 6.56616 6.58557 6.95223 6.58557 7.26238C6.58557 7.57124 8.62146 8.42188 10.0641 8.42188C11.5054 8.42188 13.5413 7.55065 13.5413 7.26238C13.5413 6.97411 11.9842 6.56745 10.0641 6.56745L10.0628 6.56616Z" data-v-b7c4e7d2=""></path><path d="M15.6744 8.6121L15.6757 8.59151C14.264 9.05866 12.2718 9.35078 10.0648 9.35078C7.8513 9.35078 5.85402 9.05737 4.441 8.58765C4.14115 9.25684 3.85546 9.93375 3.58521 10.6171C4.45644 10.9054 5.43192 11.1357 6.48332 11.2992V13.8858C6.48332 13.8858 7.22715 14.0235 7.92981 14.0531C8.42784 14.0737 8.95676 13.9888 8.95676 13.9888V11.5398C9.32095 11.5565 9.6903 11.5656 10.0635 11.5656C12.4919 11.5656 14.7311 11.2142 16.5251 10.6222C16.2566 9.94593 15.9729 9.27571 15.6744 8.6121V8.6121Z" data-v-b7c4e7d2=""></path><path d="M8.87981 4.24829C8.63787 4.24829 8.44226 4.53656 8.44226 4.89174C8.44226 5.24693 8.63787 5.5352 8.87981 5.5352C9.12046 5.5352 9.31736 5.24693 9.31736 4.89174C9.31736 4.53656 9.12046 4.24829 8.87981 4.24829V4.24829ZM12.0997 4.65624C12.0997 4.65624 11.9246 4.41816 11.4819 4.48122C11.0444 4.54428 10.8745 4.83126 10.8423 4.86215C10.8423 4.86215 10.7381 5.0243 10.8115 5.12467C10.8848 5.22505 11.0174 5.06676 11.0174 5.06676C11.0174 5.06676 11.2194 4.78364 11.4806 4.77335C11.6273 4.76349 11.7729 4.80489 11.8925 4.89046C11.8925 4.89046 12.0211 4.99856 12.0984 4.89046C12.1769 4.78364 12.0997 4.65624 12.0997 4.65624V4.65624Z" data-v-b7c4e7d2=""></path></symbol></svg> <div badge="3" class="panel-btn with-badge" data-v-b7c4e7d2=""><svg class="sprite-icon icon-zan" data-v-0f838daa="" data-v-b7c4e7d2=""><use xlink:href="#icon-zan" data-v-0f838daa=""></use></svg></div> <div badge="0" class="panel-btn" data-v-b7c4e7d2=""><svg class="sprite-icon icon-comment" data-v-0f838daa="" data-v-b7c4e7d2=""><use xlink:href="#icon-comment" data-v-0f838daa=""></use></svg></div> <div class="panel-btn" data-v-b7c4e7d2=""><svg class="sprite-icon icon-collect" data-v-0f838daa="" data-v-b7c4e7d2=""><use xlink:href="#icon-collect" data-v-0f838daa=""></use></svg> <div class="collect-popover" data-v-d0b73df6="" data-v-b7c4e7d2=""><div class="title" data-v-d0b73df6="">收藏成功！</div> <div class="sub-title" data-v-d0b73df6="">
    已添加到「」，
    <span class="modify-btn" data-v-d0b73df6="">点击更改</span></div></div> <!----> <!----></div> <div class="share-btn panel-btn" data-v-b7c4e7d2=""><svg class="sprite-icon icon-share" data-v-0f838daa="" data-v-b7c4e7d2=""><use xlink:href="#icon-share" data-v-0f838daa=""></use></svg> <div class="share-popup" data-v-b7c4e7d2=""><ul data-v-b7c4e7d2=""><li class="share-item wechat" data-v-b7c4e7d2=""><svg class="sprite-icon share-icon icon-wechat" data-v-0f838daa="" data-v-b7c4e7d2=""><use xlink:href="#icon-wechat" data-v-0f838daa=""></use></svg> <span class="share-item-title" data-v-b7c4e7d2="">微信</span> <div class="wechat-qrcode" data-v-b7c4e7d2=""><img src="https://juejin.cn/post/6956793861570035742" class="wechat-qrcode-img" style="display:none;" data-v-b7c4e7d2=""> <span class="wechat-qrcode-title" data-v-b7c4e7d2="">微信扫码分享</span></div></li> <li class="share-item weibo" data-v-b7c4e7d2=""><svg class="sprite-icon share-icon icon-weibo" data-v-0f838daa="" data-v-b7c4e7d2=""><use xlink:href="#icon-weibo" data-v-0f838daa=""></use></svg> <span class="share-item-title" data-v-b7c4e7d2="">新浪微博</span></li> <li class="share-item qq" data-v-b7c4e7d2=""><svg class="sprite-icon share-icon icon-qq" data-v-0f838daa="" data-v-b7c4e7d2=""><use xlink:href="#icon-qq" data-v-0f838daa=""></use></svg> <span class="share-item-title" data-v-b7c4e7d2="">QQ</span></li></ul></div></div> <div class="divider" data-v-b7c4e7d2=""></div> <div class="panel-btn" data-v-b7c4e7d2=""><svg class="sprite-icon icon-report" data-v-0f838daa="" data-v-b7c4e7d2=""><use xlink:href="#icon-report" data-v-0f838daa=""></use></svg></div> <span class="tooltip" data-v-b7c4e7d2=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        沉浸阅读
      </div><span class="byte-tooltip__wrapper"><div class="panel-btn" data-v-b7c4e7d2=""><svg class="sprite-icon icon-immerse" data-v-0f838daa="" data-v-b7c4e7d2=""><use xlink:href="#icon-immerse" data-v-0f838daa=""></use></svg></div></span></span></div></div> <!----></main> <!----></div> <!----> <div class="global-component-box"><div data-v-262fe4c6="" class="alert-list alert-list"></div> <div data-v-0b2d23d8="" class="suspension-panel suspension-panel"><!----> <button data-v-0b2d23d8="" title="回到顶部" class="btn to-top-btn" style="display: none;"><svg data-v-0b2d23d8="" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class=""><path data-v-0b2d23d8="" fill-rule="evenodd" clip-rule="evenodd" d="M2.75 1C2.33579 1 2 1.33579 2 1.75C2 2.16421 2.33579 2.5 2.75 2.5H13.25C13.6642 2.5 14 2.16421 14 1.75C14 1.33579 13.6642 1 13.25 1H2.75ZM7.24407 3.87287C7.64284 3.41241 8.35716 3.41241 8.75593 3.87287L13.0622 8.84535C13.6231 9.49299 13.163 10.5 12.3063 10.5H10V14C10 14.5523 9.55228 15 9 15H7C6.44772 15 6 14.5523 6 14V10.5H3.69371C2.83696 10.5 2.37691 9.49299 2.93778 8.84535L7.24407 3.87287Z" fill="#8A919F"></path></svg></button> <button data-v-0b2d23d8="" title="建议反馈" class="btn meiqia-btn" style=""><svg data-v-0b2d23d8="" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-feedback"><path data-v-0b2d23d8="" fill-rule="evenodd" clip-rule="evenodd" d="M1.8252 4.002C1.8252 2.80032 2.79935 1.82617 4.00102 1.82617H12.001C13.2027 1.82617 14.1768 2.80032 14.1768 4.002V9.71628C14.1768 10.918 13.2027 11.8921 12.001 11.8921H9.43308L6.92709 14.1281C6.4455 14.5578 5.68234 14.216 5.68234 13.5706V11.8921H4.00102C2.79934 11.8921 1.8252 10.918 1.8252 9.71628V4.002ZM11.2414 7.86753C11.3826 7.65526 11.3249 7.36878 11.1126 7.22764C10.9004 7.08651 10.6139 7.14417 10.4728 7.35643C9.94042 8.15705 9.03153 8.68309 7.99997 8.68309C6.96841 8.68309 6.05952 8.15705 5.52719 7.35643C5.38605 7.14417 5.09957 7.08651 4.88731 7.22764C4.67504 7.36878 4.61738 7.65526 4.75852 7.86753C5.45467 8.91452 6.64645 9.60617 7.99997 9.60617C9.35349 9.60617 10.5453 8.91452 11.2414 7.86753Z" fill="#1E80FF"></path></svg></button></div> <!----> <!----> <!----> <!----> <!----></div> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----></div></div></div><script>window.__NUXT__=(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C){u.loading=a;u.skeleton=b;u.cursor=f;u.data=[];u.total=d;u.hasMore=b;return {layout:"default",data:[{skipSSR:a,additionalDataUseCSR:b}],fetch:[{bdPageUrlForNav:"https:\u002F\u002Fbd.juejin.cn?utm_campaign=bd&utm_source=web&utm_medium=nav",queryString:e,isShowUserDropdownList:a,isShowAddMoreList:a,isFocus:a,isPhoneMenuShow:a,visibleBadge:a,placeholder:e,hiddenProperty:"hidden",searchHistoryVisible:a,searchHistoryItems:[],tabBadge:c,isChangePlaceholder:b,showMallBridge:a,isGuideLoginHeaderVisible:a,loginGuideTimer:c,loginGuideStartTime:d,loginGuideNextTime:d,needLoginGuide:a},{articleBanner:{url:"https:\u002F\u002Fjuejin.cn\u002Fextension\u002F?utm_source=standalone&utm_medium=post&utm_campaign=extension_promotion",title:"安装掘金浏览器插件",content:"多内容聚合浏览、多引擎快捷搜索、多工具便捷提效、多模式随心畅享，你想要的，这里都有！"},showExtension:b}],error:c,state:{view:{activityIndex:{activityList:[],pageInfo:{hasNextPage:a,endCursor:e},afterPosition:e,activityListIsLoading:b,activityListIsError:a,userActivityList:[],placeholder:e,actionType:{FETCH:"@\u002Fview\u002Factivity-index\u002FFETCH",FETCH_RECOMMEND_LIST:"@\u002Fview\u002Factivity-index\u002FFETCH_RECOMMEND_LIST",RESET_ACTIVITY_LIST:"@\u002Fview\u002Factivity-index\u002FRESET_ACTIVITY_LIST",FETCH_USER_ACTIVITY_LIST:"@\u002Fview\u002Factivity-index\u002FFETCH_USER_ACTIVITY_LIST",FETCH_NEW_COUNT:"@\u002Fview\u002Factivity-index\u002FFETCH_NEW_COUNT",DELETE_ACTIVITY:"@\u002Fview\u002Factivity-index\u002FDELETE_ACTIVITY",TOGGLE_FOLLOW_USER:"@\u002Fview\u002Factivity-index\u002FTOGGLE_FOLLOW_USER",FETCH_ENTRY_COMMENT_LIST:"@\u002Fview\u002Factivity-index\u002FFETCH_ENTRY_COMMENT_LIST",UPDATE_LIST_LOADING:"@\u002Fview\u002Factivity-index\u002FUPDATE_LIST_LOADING",RESET:"@\u002Fview\u002Factivity-index\u002FRESET"},hotList:{list:[],after:e,loading:a,hasNextPage:a,actionType:{UPDATE_STATE:"@\u002Fview\u002Factivity-index\u002Fhot-list\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Fhot-list\u002FFETCH_MORE",FETCH:"@\u002Fview\u002Factivity-index\u002Fhot-list\u002FFETCH",RESET:"@\u002Fview\u002Factivity-index\u002Fhot-list\u002FRESET"}},sidebar:{bannerList:[],actionType:{RESET:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002FRESET",UPDATE_STATE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002FUPDATE_STATE",FETCH_BANNER:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002FFETCH_BANNER"},recommend:{pageSize:h,page:d,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FUPDATE",FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FFETCH_MORE",RESET:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FRESET"},after:d},followed:{pageSize:h,page:d,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FUPDATE",FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FFETCH_MORE",RESET:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FRESET"},after:d},recommendPin:{list:[],after:e,loading:a,hasNextPage:b,actionType:{UPDATE_STATE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-pin-list\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-pin-list\u002FFETCH_MORE",FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-pin-list\u002FFETCH",RESET:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-pin-list\u002FRESET"}}},topicPinList:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FUPDATE",FETCH:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FFETCH_MORE",RESET:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FRESET"},topicId:e,navList:[{type:k,name:k,title:"推荐 ",id:k},{type:l,name:l,title:"热门 ",id:l},{type:s,name:s,title:"关注 ",id:s},{type:i,name:"opensource",title:"开源推荐 ",id:"5c09ea2b092dcb42c740fe73"},{type:i,name:"recruitment",title:"内推招聘",id:"5abb61e1092dcb4620ca3322"},{type:i,name:"dating",title:"掘金相亲",id:"5abcaa67092dcb4620ca335c"},{type:i,name:"slacking",title:"上班摸鱼",id:"5c106be9092dcb2cc5de7257"},{type:i,name:"app",title:"应用安利",id:"5b514af1092dcb61bd72800d"},{type:i,name:"tool",title:"开发工具",id:"5abb67d2092dcb4620ca3324"},{type:i,name:"news",title:"New资讯",id:"5c46a17f092dcb4737217152"}],sortType:t}},search:{search_result_from:d,query:e,list:[],linkList:[],loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fsearch\u002FFETCH",FETCH_MORE:"@\u002Fview\u002Fsearch\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fsearch\u002FRESET"}},columnIndex:{list:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FUPDATE",FETCH:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FFETCH_MORE",RESET:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FRESET"},sort:m,category:"all"},hotList:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FUPDATE",FETCH:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FFETCH_MORE",RESET:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FRESET"}}},timelineIndex:{tdkTemplates:[],categoryNavList:[],tagNavList:[],splitTagList:[],timelineAdList:[],list:[],sort:t,category:k,categoryId:e,tagId:e,tag:"全部",actionType:{FETCH_TIMELINE_LIST:"@\u002Fview\u002FtimelineIndex\u002FFETCH_TIMELINE_LIST",FETCH_CATEGORY_LIST:"@\u002Fview\u002FtimelineIndex\u002FFETCH_CATEGORY_LIST",FETCH_TAG_LIST:"@\u002Fview\u002FtimelineIndex\u002FFETCH_TAG_LIST",DELETE_ENTRY:"@\u002Fview\u002FtimelineIndex\u002FDELETE_ENTRY",DELETE_USER_ENTRIES:"@\u002Fview\u002FtimelineIndex\u002FDELETE_USER_ENTRIES",DELETE_TAG_ENTRIES:"@\u002Fview\u002FtimelineIndex\u002FDELETE_TAG_ENTRIES",FETCH_MORE:"@\u002Fview\u002FtimelineIndex\u002FFETCH_MORE",FETCH:"@\u002Fview\u002FtimelineIndex\u002FFETCH",RESET:"@\u002Fview\u002FtimelineIndex\u002FRESET"},serverRenderTimelineList:a,timelineList:{list:[],cursor:f,skeleton:b,loading:a,hasMore:b,categoryId:e,tagId:e,sort:e,actionType:{UPDATE_STATE:"timeline-list\u002FUPDATE_STATE",FETCH_MORE:"timeline-list\u002FFETCH_MORE",FETCH:"timeline-list\u002FFETCH",RESET:"timeline-list\u002FRESET"}},recommendList:{list:[],cursor:f,loading:a,skeleton:b,hasMore:b,actionType:{UPDATE_STATE:"recommend-list\u002FUPDATE_STATE",FETCH_MORE:"recommend-list\u002FFETCH_MORE",FETCH:"recommend-list\u002FFETCH",RESET:"recommend-list\u002FRESET"}},followingList:{list:[],cursor:f,skeleton:b,loading:a,hasMore:b,actionType:{UPDATE_STATE:"following-list\u002FUPDATE_STATE",FETCH_MORE:"following-list\u002FFETCH_MORE",FETCH:"following-list\u002FFETCH",RESET:"following-list\u002FRESET"}}},subscribe:{subscribed:{list:[],cursor:f,skeleton:b,loading:a,hasMore:a,actionType:{UPDATE_STATE:"view\u002Fsubscribe\u002Fsubscribed\u002Flist\u002FUPDATE_STATE",FETCH_MORE:"view\u002Fsubscribe\u002Fsubscribed\u002Flist\u002FFETCH_MORE",FETCH:"view\u002Fsubscribe\u002Fsubscribed\u002Flist\u002FFETCH",RESET:"view\u002Fsubscribe\u002Fsubscribed\u002Flist\u002FRESET"}},all:{list:[],cursor:f,loading:a,skeleton:b,hasMore:a,linkList:e,actionType:{UPDATE_STATE:"view\u002Fsubscribe\u002Fall\u002Flist\u002FUPDATE_STATE",FETCH_MORE:"view\u002Fsubscribe\u002Fall\u002Flist\u002FFETCH_MORE",FETCH:"view\u002Fsubscribe\u002Fall\u002Flist\u002FFETCH",RESET:"view\u002Fsubscribe\u002Fall\u002Flist\u002FRESET"}}},entryPublic:{entry:{user:{}},relatedEntryList:[],relatedCollectionList:[],actionType:{FETCH:"@\u002Fview\u002FentryPublic\u002FFETCH",RESET:"@\u002Fview\u002FentryPublic\u002FRESET"}},user:{user:{},serverRendered:a,userAnnuals:[],actionType:{FETCH:"@\u002Fview\u002Fuser\u002FFETCH",RESET:"@\u002Fview\u002Fuser\u002FRESET",UPDATE:"@\u002Fview\u002Fuser\u002FUPDATE",FETCH_ANNUALS:"@\u002Fview\u002Fuser\u002FFETCH_ANNUALS"},detailList:{actionType:{RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FRESET"},likeList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FlikePostList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FlikePostList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FlikePostList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FlikePostList\u002FRESET"}},postList:{list:[],hasMore:a,skeleton:a,loading:a,sort:m,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FpostList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpostList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpostList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FpostList\u002FRESET"}},searchList:{list:[],hasMore:a,skeleton:a,loading:a,key_word:e,search_type:d,cursor:f,isPostSearch:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FsearchList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FsearchList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FsearchList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FsearchList\u002FRESET"}},tagList:{list:[],loading:a,skeleton:b,hasMore:a,cursor:f,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FtagList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FtagList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FtagList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FtagList\u002FRESET"}},collectionList:{list:[],userId:e,skeleton:b,hasMore:a,cursor:f,type:"created",loading:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FRESET",TOGGLE_FOLLOW_COLLECTION:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FTOGGLE_FOLLOW_COLLECTION",FOLLOW_COLLECTION:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FFOLLOW_COLLECTION",UNFOLLOW_COLLECTION:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FUNFOLLOW_COLLECTION",DELELTE_COLLECTION:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FDELELTE_COLLECTION",ADD_COLLECTION:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FADD_COLLECTION",EDIT_COLLECTION:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FEDIT_COLLECTION"}},followerList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowerList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowerList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowerList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowerList\u002FRESET"}},followingList:{list:[],cursor:f,hasMore:a,skeleton:a,loading:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingList\u002FRESET"}},followingTeamsList:{list:[],cursor:f,hasMore:a,skeleton:a,loading:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingTeamsList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingTeamsList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingTeamsList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingTeamsList\u002FRESET"}},activityList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FactivityList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FactivityList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FactivityList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FactivityList\u002FRESET"}},bookList:{list:[],cursor:f,skeleton:b,hasMore:a,loading:a,type:"bought",actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FbookList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FbookList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FbookList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FbookList\u002FRESET"}},pinList:{list:[],hasMore:a,loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinList\u002FRESET"}},courseList:{list:[],hasMore:a,loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FcourseList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcourseList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcourseList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FcourseList\u002FRESET"}},pinPraisedList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinPraisedList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinPraisedList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinPraisedList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinPraisedList\u002FRESET"}},eventList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FeventList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FeventList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FeventList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FeventList\u002FRESET"}},selfColumnList:{list:[],hasMore:a,skeleton:a,loading:a,cursor:f,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnList\u002FRESET"}},columnFollowedList:{list:[],hasMore:a,skeleton:a,loading:a,cursor:f,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnFollowedList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnFollowedList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnFollowedList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnFollowedList\u002FRESET",FILTER:"@\u002Fview\u002Fuser\u002FdetailList\u002FcolumnFollowedList\u002FFILTER"}},realtimes:{list:[],cursor:f,hasMore:a,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimes\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimes\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimes\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimes\u002FRESET",DELETE:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimes\u002FDELETE"}},realtimeliked:{list:[],cursor:f,hasMore:a,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimeliked\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimeliked\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimeliked\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimeliked\u002FRESET",DELETE:"@\u002Fview\u002Fuser\u002FdetailList\u002Frealtimeliked\u002FDELETE"}}}},tag:{tag:{},actionType:{FETCH:"@\u002Fview\u002Ftag\u002FFETCH",FETCH_LIST:"@\u002Fview\u002Ftag\u002FFETCH_LIST",RESET:"@\u002Fview\u002Ftag\u002FRESET"},list:{list:[],cursor:f,loading:a,skeleton:a,hasMore:a,actionType:{UPDATE_STATE:"@\u002Fview\u002Ftag\u002Flist\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Ftag\u002Flist\u002FFETCH_MORE",FETCH:"@\u002Fview\u002Ftag\u002Flist\u002FFETCH",RESET:"@\u002Fview\u002Ftag\u002Flist\u002FRESET"}}},notification:{user:{actionType:{READ_ALL:"@\u002Fview\u002Fnotification\u002Fuser\u002FREAD_ALL",RESET:"@\u002Fview\u002Fnotification\u002Fuser\u002FRESET"},listState:{list:[],cursor:f,hasMore:a,isLoading:a,messageType:3,msgTotal:d,msgSubMap:{"1":d,"2":d,"3":d,"4":d}},list:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FUPDATE",FETCH:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FRESET"}}},system:{actionType:{READ_ALL:"@\u002Fview\u002Fnotification\u002Fsystem\u002FREAD_ALL",RESET:"@\u002Fview\u002Fnotification\u002Fsystem\u002FRESET"},list:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FUPDATE",FETCH:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FRESET"}}}},column:{renderPost:b,serverRenderList:a,column:{id:w},entry:{id:w,screenshot:void 0,liked:a,article_id:w,article_info:{article_id:w,user_id:"465848663023160",category_id:"6809637769959178254",tag_ids:[6809640862281105000],visible_level:d,link_url:e,cover_image:"https:\u002F\u002Fp9-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002Faa49eeb1a77746e7a02189e2b347c103~tplv-k3u1fbpfcp-watermark.image",is_gfw:d,title:"如何用 Groovy 闭包优雅地 FP 编程？",brief_content:"和 Java 的函数式接口相比，Groovy 的闭包结合动态特性让人眼前一亮。文末通过一道线性规划题阐述了 Groovy 的优雅解决之道。",is_english:d,is_original:g,user_index:d,original_type:d,original_author:e,content:e,ctime:"1619755114",mtime:"1620280995",rtime:"1620280995",draft_id:"6956791929593921567",view_count:1024,collect_count:g,digg_count:3,comment_count:d,hot_index:54,is_hot:d,rank_index:.00022998,status:n,verify_status:g,audit_status:n,mark_content:"# 4. 闭包\n\n闭包的通俗解释，就是内部状态与外部隔离，仅通过参数列表和返回值与外界进行交互的**高阶函数**，用于保护内部的函数不受外界影响。其概念派生自 Lambda 表达式。对于 Java 这类 OOP 语言来说，\"闭包\" 的概念则被 \"类\" 所代替：闭包的局部变量变成了 \"属性\"，而内部函数变成了 \"方法\"。方法的结果往往取决于属性，而属性又通常是不对外开放的 ( `private ` )。\n\nFP 的一些基本概念或术语，笔者其实主要是从 Scala 的角度切入的。详情见：[Scala 之：函数式编程之始](https:\u002F\u002Fjuejin.cn\u002Fpost\u002F6886336268385550349)\n\n## 4.1 Groovy 中的闭包\n\nGroovy 允许我们以函数式风格使用闭包 ( 至少看起来是那样 ) 并在各处传递。换句话说，Groovy 也支持函数式编程 FP，并具备所有 FP 应当具备的特性。我们在 Java 中曾感慨过 Lambda 表达式的简洁，而在 Groovy 中，它已是家常便饭。假定我们想自定义一个对数组进行遍历操作的 `foreach` 函数，该函数对内部的元素操作取决于传入的闭包 `action`：\n\n```groovy\nnums = 1..10\n\n\u002F\u002F 这段代码完全没有声明任何类型，我好像在写 javaScript.......\nvoid foreach(nums ,action){\n    for(i in nums){\n        \u002F\u002F 这个传入的 i 就是 i-\u003E print \"${i}\" 当中的那个 i。\n        action(i)\n    }\n}\n\nforeach(nums,{i -\u003E print \"${i} \"})\n```\n\n前面的文章曾提到过，如果参数列表的最后几个参数是闭包，可以选择性的将这些闭包移动到函数调用后面，英语老师管这种表达方法叫 \"定语后置\"。尤其是当闭包较长时，这种表述方式要更加优雅。\n\n```groovy\n\u002F\u002F对那个数组进行 foreach 操作 | 怎么操作\nforeach(nums) {i -\u003E print \"${i} \"}\n\nforeach(nums) {\n\ti-\u003E\n\tprint i\n\tprint \"当闭包很长时，这种写法看起来可读性更高\"\n\tprint \"这个写法已经很接近平日所用的 for-each 循环了。\"\n\tprint \"这就是闭包后置带来的惊喜。\"\n}\n```\n\n甚至可以再抽象一点，将 `nums` 数组本身也看作是一个 `{()-\u003Enums}` 的闭包：\n\n```groovy\nstatic foreach(nums,action){\n    \u002F\u002F nums() 表示它是一个 ()-\u003Enums 的 supplyer.\n    def seq = nums()\n    for(i in seq) {action(i)}\n}\n\u002F\u002F {nums} 实际上是 {-\u003Enums}，这里可以省略掉 -\u003E 箭头。\nforeach {nums} {i-\u003Eprint(\"${i} \")}\n```\n\n在这个例子中，我们隐约能感受到由 Groovy 创建出的 DSL 将是何其优雅而强大。其中，`foreach` 接收 `action` 闭包 ( 也可以称作是函数 )，因此 `foreach` 也被称作是**高阶函数** 。高阶函数的更直接解释是：一个接收函数，或者是返回另一个函数的函数。\n\n在 Java 中，一个 Lambda 表达式的写法是这样的：`(...) -\u003E {...}`，即便在没有任何参数的情况下，也得写成 `()-\u003E{...}` 的形式。而在 Groovy 中，闭包的参数不需要小括号括起来，形式上类似 `{ p1,p2 -\u003E...}` 。\n\n当这个闭包不需要任何参数时，写法形如 `{ -\u003E ...}`，或者是省略掉箭头符号而直接写成 `{...}` 。\n\n小小的特殊情况：如果闭包只需要一个参数，我们就可以在内部以 `it` 来称呼它，然后忽略掉参数命名和小箭头。比如：\n\n```groovy\n\u002F\u002F {i -\u003E print{\"${i}\"} =====\u003E {print \"${it}\"}\n\u002F\u002F foreach nums, print it. \nforeach {nums} {print(\"${it} \")}\n```\n\n需要注意的是，如果闭包确实没有接收参数，但是写法却形如 `{...}`，那么 Groovy 还是会隐式地赋予这个闭包一个值为 `null` 的 `it` 参数。这会影响到程序在运行期对闭包的动态判断，见后文的动态闭包。\n\n闭包的参数可以声明严格的类型，比如：\n\n```groovy\nforeach {nums} {Integer i -\u003E print \"${i} \"}\n```\n\n## 4.2  Execute Around Method & AOP\n\n在 JVM 语言当中，只要我们能够将不需要的对象标记为不可达，那么它们就可以在适当的时机被 GC 回收。但是在 I\u002FO 密集型任务中，我们希望 InputStream 和 OutputStream 在完成任务之后**马上关闭**，否则它们占据的文件句柄就仍然会在 GC 主动回收之前一直处于打开状态。\n\n这也是为什么 Java ( 以及其它语言的 ) I\u002FO 工具要设计 `close()` 或者是 `destory()` 这样的方法。然而，偶尔我们可能过分专注于功能业务，而忘记主动地调用这些方法 ......\n\n这种琐碎的劳动不如交给程序来解决。假定所有需要主动关闭的资源都实现了 `MustClosed()` 接口：\n\n```groovy\ninterface MustClosed {\n    def close()\n}\n```\n\n然后，定义一个高阶函数，它接收 `MustClosed` 的实现类，并保证总是在最后调用其 `close()` 方法关闭资源，无论在使用过程中是否发生异常。至于使用这个 `MustClosed` 资源的具体细节，将它封装到另一个闭包 `action` 当中。\n\n```groovy\n\u002F\u002F r 指 Resource,指必须要主动关闭的 I\u002FO 型资源。\ndef static safeUse(MustClosed r, action) {\n    try{\n        action(r)\n    }catch (Exception e){\n        e.printStackTrace()\n    }finally{\n        r.close()\n        print \"${r.getClass().typeName} 实例已经被关闭。\"\n    }\n}\n```\n\n一个简单的测试：自定义一个 `MustClosed` 的简单实现，传入 `safeUse` 函数当中观察控制台的打印顺序：\n\n```groovy\nMustClosed resource = [\n        close: { println \"doing close()...\" }\n] as MustClosed\n\ndef action = { MustClosed r -\u003E\n    println \"use resource r to do something...\"\n}\n\n\u002F\u002F 演示了如何调用一个闭包变量\nsafeUse(re) {action(re)}\n\n\u002F*\n\t等价于... 这里的 re 和 r 其实都指代一个引用。\n\tsafeUse(re){\n\t\tMustClosed r -\u003E\n\t\t\tprintln \"use resource r to do something...\"\n\t}\t\n\n*\u002F\n```\n\n一个更加真实的测试：将 Java 提供的 `OutputStream` 视作是一个 `MustClosed` 的实现类传入进去，然后感受一下：\n\n```groovy\nfos = new FileOutputStream(new File(\"README.md\"))\n\n\u002F\u002F 依赖于 Groovy 的动态类型判断\nsafeUse(fos as MustClosed){r -\u003E r.write(\"Groovy!\".bytes)}\n```\n\n现在，我们无需再手动关闭传入的各种 I\u002FO 资源，`safeUse` 会帮助搞定一切。诸如这种闭包的使用风格就是 Execute Around Method ( 环绕执行 ) 模式。把思维再发散一些，假设我们在完成一系列业务之前和之后总是要进行一些重复处理，则可以利用这种模式设计出一个模板，只需要替换掉中间不一样的业务。\n\n这种方式有点似曾相识 ...... 直觉是正确的。它的设计理念和 Spring 框架中的面向切面编程 AOP 没有什么不同，凡是支持 FP 的语言都可以通过环绕执行模式来实现切面化编程。\n\n## 4.3 可利用闭包自动清理资源\n\nGroovy 鉴于 I\u002FO 资源类工具的这些 \"痛点\" 给出了相当体面的实现：它在原有的 I\u002FO 工具类的基础上做了一些包装，我们可以在 FileOutputStream \u002F FileInputStream 工具中，直接调用 `withWriter` 或者 `withReader` ( 字符操作 )，`withStream` ( 字节操作 ) 方法，并直接以闭包的形式告知 FileOutputStream 或者是 FileInputStream 作为 Reader \u002F Writer \u002F Stream 处理数据，并免去原来的装饰者模式带来的一个副作用 —— 不断地创建包装对象。在执行完之后，I\u002FO流会自行关闭。\n\n```groovy\nf = new File(\"README.md\")\nassert f.exists()\n\nfos = new FileOutputStream(f)\nString data = \"\"\"{\n    status:200,\n    msg:\"ok\"\n}\n\"\"\"\n\n\u002F\u002F need no more fuxking close() and flush()\nfos.withWriter {\n    \u002F\u002F 其实 w -\u003E w.write(data) 可以一次将长字符串全写进去。\n    \u002F\u002F 这里主要是为了演示闭包的嵌套调用。\n    w -\u003E\n        data.eachLine {\n            w.write(\"${it}\\n\")\n        }\n}\n```\n\n尤其是使用**带缓冲的输出流**时，我们再也不用担心因为忘记 `close()` 或者 `flush()` 而导致内容丢失的问题了。\n\n## 4.4 闭包柯里化\n\n凡是涉及函数式编程的语言都能进行柯里化 ( Curry ) 变换。我们对函数 ( 或称之闭包 ) 进行柯里化变换的的目的有二：要么是希望记忆 ( 缓存) 一些参数，要么是希望推迟执行某个闭包。举个例子，下面是一个平平无奇的表达式：\n\n```groovy\nClosure\u003CInteger\u003E expr = { x, y, z -\u003E (x + y) * z }\n```\n\n假设在实际的运行当中，我们发现参数 `z` 相较 `x` 和 `y` 而言，它的值似乎不总是变化：\n\n```groovy\n\u002F\u002F z 不总是变化\nexpr(2,3,3)\nexpr(1,6,3)\nexpr(1,5,3)\nexpr(5,9,3)\n```\n\n因此，我们希望闭包 `expr` 在一段时间之内记住 `z` 的值，以此来避免枯燥的重复传参。于是 `expr` 首先被改写成了这个样子：\n\n```groovy\nClosure\u003CClosure\u003CInteger\u003E\u003E expr = {\n    z -\u003E\n        \u002F\u002F 对于这个闭包而言，z 是自由变量。\n        return { x, y -\u003E\n            (x + y) * z\n        }\n}\n```\n\n现在，`expr` 首先要求提供 `z`，然后再返回一个参数是 `x` 和 `y` 的子闭包，根据描述来看，赋值的过程显然是被拆分成了两步。同时，`expr` 演变成了一个高阶函数 ( 高阶闭包 ) 。如果将求值过程比作是开箱子，那么原本只需要一次开箱的取值操作变成了两次。\n\n```groovy\n\u002F\u002F 之前:expr(2,3,3)\n\u002F\u002F 之后: \ndef result = expr(3)(2,3)\n```\n\n事情变得更麻烦了吗？并不是如此。如果我们率先获取 `expr(3)` ，就能提前获取被保存的 `z`  的状态。因此在后续调用中，我们只管传入不同的 `x` 和 `y` 即可。\n\n```groovy\n\u002F\u002F (x + y) * 3\ndef memoried_z = expr 3\nmemoried_z(2,3)  \u002F\u002F expr(2,3,3)\nmemoried_z(1,6)  \u002F\u002F expr(1,6,3)\nmemoried_z(1,5)  \u002F\u002F expr(1,5,3)\nmemoried_z(5,9)  \u002F\u002F expr(5,9,3)\n```\n\n对于更加深层次的柯里化函数而言，随着函数参数不断被记忆，后续的调用将会变得越来越简单，所需的参数越来越少。而传递的参数越是复杂，或者传参的条目越多，函数柯里化体现出的优势就会越大。在获得所有的参数之前，柯里化函数总是返回闭包，而非真正执行，因此我们也称柯里化函数被推迟调用了。\n\n### 4.4.1 便捷的柯里化转换方法\n\n如果函数的功能再复杂一些，那么手动重构一个柯里化实现可能要花上一点时间 ( 更多的是思绪上的混乱 )。好在 Groovy 提供了一系列便捷的方法来代替我们完成柯里化转换。对于一个参数个数为 n 的函数，如果想将其前 k 个参数进行柯里化，可以调用`curry()` 方法来完成，其中 `0 \u003C= k \u003C= n`。\n\n```groovy\nexpr = {x, y, z -\u003E (x + y) * z}\n\n\u002F\u002F 返回一个新的表达式： ( 3 + 2 ) * z =\u003E 5z\nexpr1 = expr.curry(3,2)\n\n\u002F\u002F 10\nprintln expr1(2)\n\n\u002F\u002F 返回一个新的表达式: (1 + 2) * 3 = 9\nprintln expr.curry(1,2,3)()\n```\n\n如果要从后向前开始柯里化，则需使用 `rcurry()` 方法：\n\n```groovy\nexpr = {x, y, z -\u003E (x + y) * z}\n\n\u002F\u002F expr = (x + 3) * 2\nexpr1 = expr.rcurry(3,2)\n\n\u002F\u002F 12\nprintln expr1(3)\n```\n\n如果要从前面的第 k 个参数开始柯里化，则需要使用 `ncurry()` 方法，其中 `0 \u003C= k \u003C= n`，当 `k = 0` 时，指从第一个参数开始柯里化，此时等价于 `curry()` 方法。\n\n```groovy\nexpr = {x,y,z -\u003E (x + y) * z}\n\n\u002F\u002F expr1 = (x + 3) * 2\nexpr1 = expr.ncurry(1,3,2)\n\n\u002F\u002F 10\nprintln expr1(2)\n```\n\n## 4.5 动态闭包\n\nGroovy 可以在程序运行时动态地判断传入闭包的参数列表长度，甚至是参数类型，我们可以利用这个特性赋予程序动态决策的能力。比如：假定公司要根据营收额来统计交税额。我们想以闭包的形式将税额计算方法传递到一个高阶函数当中去计算。然而，这个闭包有可能不需要提供税率 ( 用户直接给出计算公式 )，也有可能需要 ( 用户仅提供计算方法，此时由高阶函数提供一个默认值)：\n\n```groovy\ndef tax(Double amount,Closure computer){\n    switch (computer.maximumNumberOfParameters){\n        case 1 : return computer(amount)\n        case 2 : return computer(amount,15)\n        default: throw new Exception(\"need 1 or 2 args.\")\n    }\n}\n\n\n\u002F\u002F 这个闭包传入了税率计算方式以及税率，只需要 1 个参数\nprintln tax(14000.0) {\n        amount -\u003E amount * 0.13\n}\n\n\u002F\u002F 这个闭包不主动传入税率 rage，有 2 个参数\nprintln tax(14000.0) {\n    amount,rage -\u003E amount * (rage\u002F100)\n}\n```\n\n如果 Groovy 能够确定一个参数是闭包，那么可以访问其 `.maxinumNumberOfParameters` 属性来判断闭包传入时实际的参数个数。如果用户不提供税率，那么就直接按照用户的公式计算交税额。否则，由高阶函数给出一个默认税率并计算。\n\n除了动态判断参数的个数，还可以使用 `parameterTypes` 属性来动态获取参数的实际类型。比如：\n\n```groovy\ndef check(Closure cls){\n    int i = 1\n    for(args in cls.parameterTypes) { println \"type[${i}] = ${args.typeName}\";i++}\n    \u002F\u002F.. 什么也不做\n}\n\n\u002F\u002F type[1] = java.lang.String\ncheck {\n    String i -\u003E \u002F\u002F.. 什么都不做\n}\n\n\u002F\u002F type[1] = java.lang,Integer\ncheck {\n    Integer i -\u003E \u002F\u002F.. 还是什么也不做\n}\n\n\u002F\u002Ftype[1] = java.lang.Integer\n\u002F\u002Ftype[2] = java.lang.String\ncheck {\n    Integer i , String s -\u003E \u002F\u002F.. 仍然什么也不做\n}\n```\n\n注意，前文曾提到过，如果闭包不需要任何参数，那么形式上可以写为 `{...}` 或者是 `{ -\u003E ...}`，两者的区别是：Groovy 仍然会为前者赋予一个隐含的参数 `it`，只不过这个值是 `null`。但对于后者，Groovy 则认为这个它是一个严格的无参数闭包。\n\n## 4.6 闭包执行上下文与闭包委托\n\n假设这是一个闭包：\n\n```groovy\ndef closure = {\n\tfunc()\n}\n```\n\n显然，如果没有其它的线索，那么就很难说 `func()` 调用是从哪来的。先把这个问题搁置在一边，我们有更重要的概念需要提及。\n\nGroovy 为每一个闭包都定义了三个属性：`thisObject`，`owner`，`delegate`。所有的闭包都和它所在类的实例相绑定，并且会被 Groovy 编译成一个内部类的实例。对于一般的闭包，`this == owner == delegate` ，比如说外部的 `out` 闭包。\n\n```groovy\nclass _Example_{\n    def out = {\n        \u002F\u002F 这是相对而言的内部闭包。\n        def inner = {}\n        \u002F\u002F------test of thisObject, owner, delegate----------\u002F\u002F\n        println out.thisObject.getClass().name\t\t\u002F\u002F_Example_\n        println out.owner.getClass().name\t\t\t\u002F\u002F_Example_\n        println out.delegate.getClass().name\t\t\u002F\u002F_Example_\n    }\n}\n\nnew _Example_().out()\n```\n\n但对于一些特殊情况就有所不同了：第一种情况是闭包嵌套的情况。比如说 `out` 闭包内部定义的  `inner` 闭包。如果访问该 `inner` 闭包的 `owner` ，它将指向外部闭包 `out` 的实例。\n\n```groovy\nclass _Example_{\n    def out = {\n        \u002F\u002F 这是相对而言的内部闭包。\n        def inner = {}\n\n        \u002F\u002F------test of thisObject, owner, delegate----------\u002F\u002F\n        println out.thisObject.getClass().name\t\t\u002F\u002F_Example_\n        println out.thisObject.hashCode()           \u002F\u002F == inner.thisObject.hashCode\n        println out.owner.getClass().name\t\t\t\u002F\u002F_Example_\n        println out.delegate.getClass().name\t\t\u002F\u002F_Example_\n\n        println inner.thisObject.getClass().name    \u002F\u002F_Example_\n        println inner.thisObject.hashCode()         \u002F\u002F == out.thisObject.hashCode\n        println inner.owner.getClass().name         \u002F\u002F_Example_$_closure1 (指外部闭包被编译的内部类)\n        println inner.delegate.getClass().name      \u002F\u002F_Example_$_closure1 (指外部闭包被编译的内部类)\n    }\n}\n\nnew _Example_().out()\n```\n\n在第二种特殊情况下，`delegate` 将不再指向 `owner`，那就是进行**闭包委托**的情形。用简单的话来概述它，就是闭包内部调用的一些方法，**可能**来自于另一个委托类的实例。声明如下：\n\n```groovy\n\u002F\u002F \"代理类\"\nclass _Proxy_{}\nclass _Example_{\n    def out = {\n        def inner = {}\n        inner.delegate = new _Proxy_()\n        \n        \u002F\u002F thisObject, owner, delegate 都不一样。\n        println inner.thisObject.getClass().name\n        println inner.owner.getClass().name\n        println inner.delegate.getClass().name\n    }\n}\n\n\u002F\u002F_Example_\n\u002F\u002F_Example_$_closure1\n\u002F\u002F_Proxy_\nnew _Example_().out()\n```\n\n理解这三个闭包的基本属性之后，再去解释本节开头的那个问题就容易得多了：如果一个闭包内部使用的方法或变量在局部块内没有，那么 Groovy 优先在 `thisObject` 或者 `owner` 域查找；否则，试图从 `delegate` 那里查找；否则，就会报错返回。如果能在前两个域当中找到合适的内容，那么 Groovy 就绝对不会 \"打扰\" `delegate`。\n\n观察下面的完整代码。由于 `_Example_ ` 类定义了 `func1` ，`out` 闭包定义了`func2`，因此即便是 `inner` 设置了闭包代理，Groovy 也没有进行路由。\n\n```groovy\nclass _Proxy_{\n    def func1 = { println \"this [func1] is from the instance of Class: _Proxy_\" }\n    def func2 = { println \"this [func2] is still from the instance of Class: _Proxy_\" }\n}\n\nclass _Example_{\n\n    def func1 = { println \"this [func1] is from the instance of Class:_Example_.\"}\n    def out = {\n        def func2 = { println \"this [func2] is from the instance of closure:out\"}\n        def inner = {\n            func1()\n            func2()\n        }\n        inner.delegate = new _Proxy_()\n        inner()\n    }\n}\n\n\u002F\u002Fthis [func1] is from the instance of Class:_Example_.\n\u002F\u002Fthis [func2] is from the instance of closure:out\nnew _Example_().out()\n```\n\n一旦注释掉 `_Example_` 内部的 `func1` 或者是 `func2` 闭包，Groovy 就会从 `_Proxy_` 那里尝试弥补缺失的内容，从而给出不同的运行结果。比如：\n\n```groovy\nclass _Proxy_{\n    def func1 = { println \"this [func1] is from the instance of Class: _Proxy_\" }\n    def func2 = { println \"this [func2] is still from the instance of Class: _Proxy_\" }\n}\n\nclass _Example_{\n    def out = {\n        def inner = {\n            func1()\n            func2()\n        }\n        inner.delegate = new _Proxy_()\n        inner()\n    }\n}\n\n\u002F\u002Fthis [func1] is from the instance of Class: _Proxy_\n\u002F\u002Fthis [func2] is still from the instance of Class: _Proxy_\nnew _Example_().out()\n```\n\n另一种闭包委托的声明方式会令 Groovy 倒置查找顺序：即优先选择 `delegate` 的方法，其次才是 `owner` 或 `thisObejct`。具体做法是通过调用一个对象的 `.with` 方法 \"外挂\" 闭包。如下所示：\n\n```groovy\nclass _Proxy_{\n    def func1 = { println \"this [func1] is from the instance of Class: _Proxy_\" }\n    def func2 = { println \"this [func2] is still from the instance of Class: _Proxy_\" }\n}\n\nclass _Example_{\n    def func1 = { println \"this [func1] is from the instance of Class: _Example_\" }\n    def func2 = { println \"this [func2] is still from the instance of Class: _Example_\" }\n    def out = {\n        def inner = {\n            func1()\n            func2()\n        }\n        new _Proxy_().with inner\n    }\n}\n\n\u002F\u002Fthis [func1] is from the instance of Class: _Proxy_\n\u002F\u002Fthis [func2] is still from the instance of Class: _Proxy_\nnew _Example_().out()\n```\n\n注，`delegate` 在涉及 DSL 的方面会变得非常有用。\n\n## 4.7 尾递归\n\n递归代码常常被认为是 \"有品位但是不好驾驭\" 的典型，和迭代相比，递归从表达上可能更加晦涩，因此令大部分程序员避之不及。令一个经常遇到的麻烦是：当递归的层次过深时，JVM 会招架不住而抛出一个 `StackOverFlowError` 。我们都知道，JVM 的每一个线程都使用一个栈空间来管理它调用的函数，并为每一个函数分配一个栈帧。如果这个栈一直处于 \"只进不出\" 的状态，那么 JVM 理论上就有驾崩的危险。\n\n解决栈溢出的思路却又很简单：只要让栈维持 \"边进边出\" 的状态就可以了。具体的做法是：将一般的递归函数改进成尾递归。尾递归的意思是：当调用下一个函数时，当前的调用直接将返回值传递给它，并且没有后续计算，线程也自然就认为没有必要保存当前调用的栈帧。\n\n用一个例子来说明或许更实在一点：n 的阶乘。\n\n```groovy\n\u002F**\n * 为什么这个方法不是尾递归？\n * 如果它的返回值是 n * factorial(n-1)，那么本次调用就需要等待下一次调用的 factorial(n-1) 来计算返回值。\n * 因此，假定 n == 3 , 那么线程就需要 3 层栈空间来解决它。\n * 假定 n 取了更大的值 , 那么 JVM 就会呻吟了。\n * @param n\n * @return\n *\u002F\nint factorial(int n){\n   return n \u003C= 1 ? 1 :n * factorial(n-1)\n}\n\nimport groovy.transform.TailRecursive\n\n\u002F**\n * 为什么这个方法是尾递归？\n * 无论是哪个分支，该递归函数总是返回一个数值或者发起一个新的调用，且当前调用没有需要等待的后续运算了。\n * 而递归过程的中间结果会不断地被装入 acc 参数中并传递。\n * 所以，在当前调用结束之后，它可以安全地 \"传宗接代且无后顾之忧\"。 \n * 无论 n 取何值，这个尾递归始终只占用 1 层栈空间。\n * 唯一不太方便的是，用户调用这个函数需要主动为 acc 传递一个初始值，而我们一般都靠包装函数来解决这个瑕疵。\n * @param n\n * @return\n *\u002F\n@TailRecursive\nint factorial_t(int n,int acc){\n    return n \u003C= 1 ? acc : factorial_t(n-1,acc * n)\n}\n\n\u002F\u002F good\nprintln factorial_t(10000,1)\n\n\u002F\u002F bad, 99.99% 报错\nprintln factorial(10000)\n```\n\n其中，`@TailRecursive` 注解负责检查函数，如果它不是严格尾递归的，那么就会在编译器期间报错。闭包版本的尾递归则和函数版本不太一样，其尾递归需要借助 `trampoline` ( 意 \"弹簧床\" ) 方法来实现。\n\n```groovy\n\u002F\u002F 对于递归闭包，我们必须先定义出一个变量作为它的名字，才能在闭包内部调用自身。\ndef f \n\nf = {\n    i, BigInteger n -\u003E i \u003C= 1 ? n : f.trampoline(i - 1, n * i)\n}.trampoline()\n\nf(1000)\n```\n\n另外，考虑到用户体验，不妨将闭包的 `acc` 参数设置为默认值 1 ( 因为它是最后一个参数 )，因此该参数对用户来说可以是透明的。需要指出的是，同等的算法逻辑和入参，函数的执行速度要比闭包快得多。\n\n```groovy\nBigInteger factorial_func(int i, BigInteger n) {\n    i \u003C= 1 ? n : factorial_func(i - 1, n * i)\n}\n\nfactorial_closure = {\n    i, BigInteger n = 1 -\u003E i \u003C= 1 ? n : factorial_closure.trampoline(i - 1, n * i)\n}.trampoline()\n\nl1 = System.currentTimeMillis()\nprintln factorial_closure(1000)\n\n\u002F\u002F 250 ~ 300 millis\nprintln System.currentTimeMillis() - l1\n\nl1 = System.currentTimeMillis()\nprintln factorial_func(1000, 1 as BigInteger)\n\n\u002F\u002F 4 ~ 10 millis\nprintln System.currentTimeMillis() - l1\n```\n\n## 4.8 从钢条切割问题探讨递归优化\n\n\u003E 该问题参考自：[动态规划-钢杆切割问题 - RunningSnail - 博客园 (cnblogs.com)](https:\u002F\u002Fwww.cnblogs.com\u002Ftgycoder\u002Fp\u002F4980655.html)\n\n假定我们是钢杆 ( 或者称钢条 ) 的卖家，不同长度的钢杆价位不同，**且钢杆长度和价格并不是线性相关的 ( 这就表明了整根卖不一定获利最大 ) **。现在给定一个长钢杆，我们希望对它做一些切割以获得最大利润。长度为 `n` 的钢杆，它的价格记作 `rodPrices[n]`  ：\n\n```\nInteger[] rodPrices = [0, 1, 3, 4, 5, 8, 9, 11, 12, 14, 15, 15, 16, 18, 19, 15, 20, 21, 22, 24, 25, 24, 26, 28, 29, 35, 37, 38, 39, 40]\n```\n\n比如，长度为 2 的钢杆，它的价格为 3，而长度为 5 的钢杆，它的价格仅为 8 ( 性价比似乎还 \"提高\" 了) 。此外，这里为了消除 0 下标的 \"错位\" 影响，令 `rodPrices[0] == 0` 。第一问：首先求长度为 27 的钢杆，它所能获得的最大利润。\n\n最朴素的想法是：穷举所有的切割方案并择优选取。一提及穷举，我们自然就会想到迭代，或者递归，或者**两者兼具**。\n\n进一步思考，每次将一段长杆 `l` 切割，都会产生两个短杆 `s1` ，`s2` 。设长度为 `n` 的钢杆的最大利润为 `max(n)`，那显然我们只要求出 `max(s1)` 和 `max(s2)`，那么就能推算出 `max(l) = max(s1) + max(p2)` 。那 `max(s1)`又该怎么求呢？它肯定又能分出更短的杆 `ss1` 和 `ss2` ，我们继续求 `max(ss1)` 和 `max(ss2)` 就好了 ......\n\n从这段描述中，我们能够提取出四个要点：\n\n1. 大问题的目的是求最优解。\n2. 大问题可以分解成若干小问题。\n3. 大问题的最优解依赖于小问题的最优解。\n4. 我们现在正 \"自上而下\" 地将大问题不断分解成小问题。\n\n因此，钢杆 ( 钢条 ) 切割问题本质上是一道**动态规划**题。在下面的叙述中，我们将 \"求长度为 `length` 的钢杆的最大利润\" 封装为一个函数 `rodCut(length)` 。\n\n设传进来长度为 `length` 的长杆，切割后的两杆其一为 `s1` ，长度记作 `i`；而另一个 `s2` 的长度则为 `length - i`。我们在一个**迭代**中动态平衡两杆的长度，且在每一次迭代内部，保留 `s1` 的长度不变，假设它的当前最优解就是 `max'(s1)` 。以此为前提去对 `s2` 进行**递归切割**，即调用 `rodCut(s2)`。\n\n我们确信 `rodCut` 总能正确的返回 `max(s2)`，因此每次迭代的 `max'(length) = max'(s1) + rodCut(s2)` 。在迭代完成后，只需要从这些结果值中取出实际最大值作为当前 `rodCut(length)` 调用的返回值即可。\n$$\nrodCut(length) = Max\\{max_i(s1) + rodCut(s2)\\space|\\space1≤i≤length\\} \\\\\nlength = s1 + s2\n$$\n另外还有一个细节：如果在某一次迭代中  `s1 ` 的长度 `i == length`，那么显然 `s2 == 0` 。这时表示不对长度 `length` 的杆进行切割，此时 `max(length) == rodPrices[length]` 。\n\n根据上述思路，我们迅速给出了第一版解决方案：\n\n```groovy\nInteger rodCut(Integer[] rodPrices, length) {\n\n    \u002F\u002F 虽然 length[0] 即为 0，但是我们想让调用短路返回，而不是继续执行。\n    \u002F\u002F 这个 if 不可省略。\n    if (length == 0) return 0\n\n    def max = -1\n\n    \u002F\u002F \"左杆\" s1 的长度至少为 1，否则就没意义。\n    \u002F\u002F 当 length = 1 时， length -1 = 0， 调用会进入临界条件。\n    for (i in 1..length) {\n        def p = rodPrices[i] + rodCut(rodPrices, length - i)\n        if (p \u003E max) max = p\n    }\n\n    return max\n}\n```\n\n现在提出一个新的要求：不仅要求出最大利润，还要给出详细的切割方案。比如：长度为 `27`  的杆，它的最大利润是 `43`，切割方案是：`[5,5,5,5,5,2]` ，数组内的每个元素是短杆的长度。\n\n此时不仅要在迭代过程中寻求最优解，还要在此记录每一次求得最优解时短杆的长度。出于这个目的，我们设计出了如下数据结构：\n\n```groovy\n@Canonical\nfinal class Plan {\n    Integer amount\n    ArrayList splits\n}\n```\n\nPlan 表示一个切割方案，比如 `new Plan(amount: 4, splits:[1,2])` 表示这个切割方案中有长度为 1 和 2 的两个子杆，这个方案的总收入为 4。\n\n`splits` 是线性表，用于记录短杆的长度。可以预见的是：长杆 Plan 的创建基于短杆 Plan，新的 `splits` 总是之前 Plan 的 `splits` 再插入一个新的元素，而链表能够从容地应对不断追加元素的场合，所以 `splits` 被设置为 ArrayList 类。\n\n第二版解决方案也出炉了：\n\n```groovy\n@Newify(Plan)\ndef rodCut(rodPrices, length) {\n\n    if (length == 0) return Plan(amount: 0, splits: [])\n\n    def max = Plan(amount: -1, splits: [])\n\n    \u002F\u002F 至少切割成 (1,length-1)，否则没有意义。\n    \u002F\u002F 当 length = 1 时， length - 1 = 0， 要考虑到边界条件。\n    for (i in 1..length) {\n        \n        \u002F\u002F left : 这里是 \"剩下的\" 意思。\n        \u002F\u002F 获得 \"右杆\" s2 的最优 Plan\n        def leftRod = rodCut(rodPrices, length - i)\n\n        \u002F\u002F 推算当前迭代中的 \"最优\" Plan = \"左杆\" Plan + \"右杆\" Plan\n        def try_ = Plan(amount: rodPrices[i] + leftRod.amount, splits: leftRod.splits + i)\n\n        if (try_.amount \u003E max.amount) max = try_\n    }\n\n    \u002F\u002F 返回实际的长度 Length 的杆所对应的最优 Plan.\n    return max\n}\n```\n\n注意，这里存在 Groovy 的语法糖：那就是 `leftRod.split + i`。这是一个操作符重载，实际上可理解为 `leftRod.splits.add(i)` 。该算法的 Groovy 闭包版本是：\n\n```groovy\ndef rodCuts\n\nrodCut = {\n    rod_prices, length -\u003E\n        if (length == 0) return new Plan(amount: 0, splits: [])\n        def max = new Plan(amount: -1, splits: [])\n        for (i in 1..length) {\n            def leftRod = rodCut(rodPrices, length - i)\n            def try_ = new Plan(amount: rodPrices[i] + leftRod.amount, splits: leftRod.splits + i)\n            if (try_.amount \u003E max.amount) max = try_\n        }\n        return max\n}\n```\n\n### 4.8.1 利用记忆化改进性能\n\n人们常说：过早的优化是万恶之源。因此在之前笔者刻意回避了 `rodCut` 函数的运行效率。运行第二版的函数 \u002F 闭包，程序需要运行大约 1 ~ 2 分钟的时间才能给出答案。\n\n为什么会这样？我们其实还忽略了第五个要点：那就是将大问题分解为小问题时，应当避免对重复的小问题求解。比如：\"将长为 10 的杆分为两个 5\"  和 \"将长为 8 的杆分成 3 和 5\" 的两个情形都涉及到 \"求杆长为 5 的最优解\"。很不巧的是，在目前的递归过程中，`rodCut` 函数对传进来的 `length` 几乎来者不拒，却从来不检讨这个计算有无必要。\n\n一个简单却十分有效的办法是，在调用这个函数的同时，传入一个足够长的 `cache` 数组作为缓存。其中，`cache[n]` 存储了长为 `n` 的杆的最佳方案，但在最开始，所有位置都是 `null` 。不过每次在 `rodCut` 返回计算结果之前，都会顺带着将它写入到这个缓存的对应位置内。\n\n在后续的递归调用中，程序优先从查找缓存的对应位置：如果该位置非 `null`，则意味着当前调用能够立刻返回计算结果，而非重新计算。\n\n```groovy\ndef rodCuts_cached\n\nrodCuts_cached = {\n\n    Integer[] rod_prices, Integer length, Plan[] cache -\u003E\n\n        if (cache[length] != null) return cache[length]\n        if (length == 0) return new Plan(amount: 0, splits: [])\n        def max = new Plan(amount: 0, splits: [])\n\n        for (i in 1..length) {\n            def leftRod = rodCuts_cached(rod_prices, length - i, cache)\n            def try_ = new Plan(amount: rod_prices[i] + leftRod.amount, splits: leftRod.splits + i)\n            if (try_.amount \u003E max.amount) {\n                max = try_\n            }\n        }\n        \u002F\u002F 记录当前最优解。\n        \u002F\u002F 注意，传入的 cache 是引用，这意味着任意一处递归都能够随时感知 cache 的变化。\n        cache[length] = max\n        return max\n}\n```\n\n依照这个思路，我们重新给出了第三版代码。在同等运行条件下，它的运算时间只相当于第二版的 1%。\n\n这个套路其实和之前 n 阶乘的优化思路非常相像，那就是想方设法保存中间结果来节省后续递归的工作量，无论从形式上是值传递一个计算结果，还是引用传递一块缓存。如果为这个套路起一个专业点的名字，那么它就是 **记忆化** ( Memoization ) 。\n\n### 4.8.2 画龙点睛之 memoize()\n\n我们已经从实例中理解并体会了函数记忆化带来的性能飞跃，体贴的 Groovy 同样也更理解我们。在其它语言中，我们可能会为了实现缓存而手写一段逻辑代码 ( 像第三版代码那样 ) 。但至少在 Groovy 中，实际的工作量就是在原有闭包的基础之上再补充上一个 `momonize()` 方法调用。\n\n```groovy\ndef rodCuts\nrodCut = {\n    rod_prices, length -\u003E\n        if (length == 0) return new Plan(amount: 0, splits: [])\n        def max = new Plan(amount: -1, splits: [])\n        for (i in 1..length) {\n            def leftRod = rodCuts(rod_prices, length - i)\n            def try_ = new Plan(amount: rodPrices[i] + leftRod.amount, splits: leftRod.splits + i)\n            if (try_.amount \u003E max.amount) max = try_\n        }\n        return max\n}.memoize()\n```\n\nGroovy 会为此创建一个自带缓存空间的闭包，然后就像我们所做的一样，闭包在递归自身时会优先从缓存中读取运算结果，除此之外，Groovy 还考虑到了一些线程安全的内容。由于机制大体相同，因此这一版的运行效率跟第三版代码几乎差不多，而区别是 \"我们操心的活变得更少了\"。\n\n根据天下没有免费的午餐定理，争取运算时间的代价将是牺牲或多或少的空间。如果问题的规模变得夸张一些，那么对空间的占用就无法忽略 ( 尤其是在本例中，Plan 还是一个携带链表的类 ) 。Groovy 将选择的权利交给了我们，因此 `memonized()` 还衍生出了 `memonizeAtMost()` 方法以及其它变种。当缓存达到临界状态时，Groovy 采取 LRU ( Least Last Used ) 策略对缓存内容进行替换。",display_count:d,is_markdown:g},author_user_info:{user_id:"465848663023160",user_name:"花花子",company:"新东方烹饪学校",job_title:"学生",avatar_large:"https:\u002F\u002Fp3-passport.byteacctimg.com\u002Fimg\u002Fuser-avatar\u002F2c3d36ac68756ea7f747669b94554d42~300x300.image",level:4,description:"浪漫主义coder",followee_count:56,follower_count:142,post_article_count:98,digg_article_count:267,got_digg_count:365,got_view_count:97818,post_shortmsg_count:3,digg_shortmsg_count:16,isfollowed:a,favorable_author:d,power:3811,study_point:1530,university:{university_id:"6888594369101152269",name:"黑龙江大学",logo:e},major:{major_id:f,parent_id:f,name:e},student_status:3,select_event_count:d,select_online_course_count:d,identity:d,is_select_annual:a,select_annual_rank:d,annual_list_type:d,extraMap:{},is_logout:d,annual_info:[],account_amount:d,user_growth_info:{user_id:465848663023160,jpower:3811,jscore:394.2,jpower_level:4,jscore_level:4,jscore_title:"进阶掘友",author_achievement_list:[],vip_level:4,vip_title:"融会贯通",jscore_next_level_score:500,jscore_this_level_mini_score:d},is_vip:b,become_author_days:d,collection_set_article_count:d},category:{category_id:"6809637769959178254",category_name:"后端",category_url:"backend",rank:g,back_ground:"https:\u002F\u002Flc-mhke0kuv.cn-n1.lcfile.com\u002Ffb3b208d06e6fe32.png",icon:"https:\u002F\u002Flc-mhke0kuv.cn-n1.lcfile.com\u002Fa2ec01b816abd4c5.png",ctime:1457483880,mtime:1432503193,show_type:3,item_type:n,promote_tag_cap:4,promote_priority:g,id:"6809637769959178254",name:"后端",title:"后端",alias:"backend"},tags:[{entriesCount:void 0,subscribed:a,id:"6809640862281105415",tag_id:"6809640862281105415",tag_name:"Groovy",color:"#000000",icon:"https:\u002F\u002Fp1-jj.byteimg.com\u002Ftos-cn-i-t2oaga2asx\u002Fleancloud-assets\u002F59e008bf567fda17a009.png~tplv-t2oaga2asx-image.image",back_ground:e,show_navi:d,ctime:1489100571,mtime:1668179383,id_type:9,tag_alias:e,post_article_count:180,concern_user_count:2512,title:"Groovy",tagId:"6809640862281105415",articleCount:180,subscribersCount:2512,createdAt:c,updatedAt:c}],user_interact:{id:6956793861570036000,omitempty:n,user_id:d,is_digg:a,is_follow:a,is_collect:a},org:{org_info:c,org_user:c,is_followed:a},req_id:"202211212237210102040512051F3A8404",status:{push_status:d},author_interact:c,extra:{boost_type:e},title:"如何用 Groovy 闭包优雅地 FP 编程？",user:{id:"465848663023160",self_description:void 0,followed:a,viewerIsFollowing:void 0,community:void 0,subscribedTagCount:d,wroteBookCount:d,boughtBookCount:d,isBindedPhone:a,level:4,user_id:"465848663023160",user_name:"花花子",company:"新东方烹饪学校",job_title:"学生",avatar_large:"https:\u002F\u002Fp3-passport.byteacctimg.com\u002Fimg\u002Fuser-avatar\u002F2c3d36ac68756ea7f747669b94554d42~300x300.image",description:"浪漫主义coder",followee_count:56,follower_count:142,post_article_count:98,digg_article_count:267,got_digg_count:365,got_view_count:97818,post_shortmsg_count:3,digg_shortmsg_count:16,isfollowed:a,favorable_author:d,power:3811,study_point:1530,university:{university_id:"6888594369101152269",name:"黑龙江大学",logo:e},major:{major_id:f,parent_id:f,name:e},student_status:3,select_event_count:d,select_online_course_count:d,identity:d,is_select_annual:a,select_annual_rank:d,annual_list_type:d,extraMap:{},is_logout:d,annual_info:[],account_amount:d,user_growth_info:{user_id:465848663023160,jpower:3811,jscore:394.2,jpower_level:4,jscore_level:4,jscore_title:"进阶掘友",author_achievement_list:[],vip_level:4,vip_title:"融会贯通",jscore_next_level_score:500,jscore_this_level_mini_score:d},is_vip:b,become_author_days:d,collection_set_article_count:d,juejinPower:3811,jobTitle:"学生",roles:{isBookAuthor:a,isFavorableAuthor:a,isCobuilder:a,isAdmin:a},username:"花花子",blogAddress:void 0,selfDescription:"浪漫主义coder",beLikedCount:365,beReadCount:97818,followerCount:142,followingCount:56,collectionCount:d,createdCollectionCount:d,followingCollectionCount:d,postedPostsCount:98,pinCount:3,likedArticleCount:267,likedPinCount:16,avatar:"https:\u002F\u002Fp3-passport.byteacctimg.com\u002Fimg\u002Fuser-avatar\u002F2c3d36ac68756ea7f747669b94554d42~300x300.image",latestLoginedInAt:c,createdAt:c,updatedAt:c,phoneNumber:e,titleDescription:e,followeesCount:56,applyEventCount:d,need_lead:d,followTopicCnt:void 0},viewCount:void 0,commentsCount:d,isEvent:void 0,abstract:"和 Java 的函数式接口相比，Groovy 的闭包结合动态特性让人眼前一亮。文末通过一道线性规划题阐述了 Groovy 的优雅解决之道。",latestCommentAt:c,createdAt:new Date(1619755114000),updatedAt:c,isTopicEvent:a,likedCount:3,likeCount:3,content:e,originalUrl:e,type:"post",collected:a,viewsCount:1024,username:"花花子",viewerHasLiked:a,draftId:"6956791929593921567",collectionCount:g},entryView:{},author:{id:"465848663023160",self_description:void 0,followed:a,viewerIsFollowing:void 0,community:void 0,subscribedTagCount:d,wroteBookCount:d,boughtBookCount:d,isBindedPhone:a,level:4,user_id:"465848663023160",user_name:"花花子",company:"新东方烹饪学校",job_title:"学生",avatar_large:"https:\u002F\u002Fp3-passport.byteacctimg.com\u002Fimg\u002Fuser-avatar\u002F2c3d36ac68756ea7f747669b94554d42~300x300.image",description:"浪漫主义coder",followee_count:56,follower_count:142,post_article_count:98,digg_article_count:267,got_digg_count:365,got_view_count:97818,post_shortmsg_count:3,digg_shortmsg_count:16,isfollowed:a,favorable_author:d,power:3811,study_point:1530,university:{university_id:"6888594369101152269",name:"黑龙江大学",logo:e},major:{major_id:f,parent_id:f,name:e},student_status:3,select_event_count:d,select_online_course_count:d,identity:d,is_select_annual:a,select_annual_rank:d,annual_list_type:d,extraMap:{},is_logout:d,annual_info:[],account_amount:d,user_growth_info:{user_id:465848663023160,jpower:3811,jscore:394.2,jpower_level:4,jscore_level:4,jscore_title:"进阶掘友",author_achievement_list:[],vip_level:4,vip_title:"融会贯通",jscore_next_level_score:500,jscore_this_level_mini_score:d},is_vip:b,become_author_days:d,collection_set_article_count:d,juejinPower:3811,jobTitle:"学生",roles:{isBookAuthor:a,isFavorableAuthor:a,isCobuilder:a,isAdmin:a},username:"花花子",blogAddress:void 0,selfDescription:"浪漫主义coder",beLikedCount:365,beReadCount:97818,followerCount:142,followingCount:56,collectionCount:d,createdCollectionCount:d,followingCollectionCount:d,postedPostsCount:98,pinCount:3,likedArticleCount:267,likedPinCount:16,avatar:"https:\u002F\u002Fp3-passport.byteacctimg.com\u002Fimg\u002Fuser-avatar\u002F2c3d36ac68756ea7f747669b94554d42~300x300.image",latestLoginedInAt:c,createdAt:c,updatedAt:c,phoneNumber:e,titleDescription:e,followeesCount:56,applyEventCount:d,need_lead:d,followTopicCnt:void 0},adEntryList:[],relatedEntryList:[],linkVotingList:[],userAnnuals:[],columnList:[],cachedHtml:"\u003Cstyle\u003E.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;margin-bottom:5px}.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{font-size:20px}.markdown-body h2{padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre\u003Ecode{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:\"\"}.markdown-body blockquote\u003Ep{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}\u003C\u002Fstyle\u003E\u003Ch1 data-id=\"heading-0\"\u003E4. 闭包\u003C\u002Fh1\u003E\n\u003Cp\u003E闭包的通俗解释，就是内部状态与外部隔离，仅通过参数列表和返回值与外界进行交互的\u003Cstrong\u003E高阶函数\u003C\u002Fstrong\u003E，用于保护内部的函数不受外界影响。其概念派生自 Lambda 表达式。对于 Java 这类 OOP 语言来说，\"闭包\" 的概念则被 \"类\" 所代替：闭包的局部变量变成了 \"属性\"，而内部函数变成了 \"方法\"。方法的结果往往取决于属性，而属性又通常是不对外开放的 ( \u003Ccode\u003Eprivate \u003C\u002Fcode\u003E )。\u003C\u002Fp\u003E\n\u003Cp\u003EFP 的一些基本概念或术语，笔者其实主要是从 Scala 的角度切入的。详情见：\u003Ca href=\"https:\u002F\u002Fjuejin.cn\u002Fpost\u002F6886336268385550349\" target=\"_blank\" title=\"https:\u002F\u002Fjuejin.cn\u002Fpost\u002F6886336268385550349\"\u003EScala 之：函数式编程之始\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Ch2 data-id=\"heading-1\"\u003E4.1 Groovy 中的闭包\u003C\u002Fh2\u003E\n\u003Cp\u003EGroovy 允许我们以函数式风格使用闭包 ( 至少看起来是那样 ) 并在各处传递。换句话说，Groovy 也支持函数式编程 FP，并具备所有 FP 应当具备的特性。我们在 Java 中曾感慨过 Lambda 表达式的简洁，而在 Groovy 中，它已是家常便饭。假定我们想自定义一个对数组进行遍历操作的 \u003Ccode\u003Eforeach\u003C\u002Fcode\u003E 函数，该函数对内部的元素操作取决于传入的闭包 \u003Ccode\u003Eaction\u003C\u002Fcode\u003E：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Enums = 1..10\n\n\u002F\u002F 这段代码完全没有声明任何类型，我好像在写 javaScript.......\nvoid foreach(nums ,action){\n    for(i in nums){\n        \u002F\u002F 这个传入的 i 就是 i-\u003E print \"${i}\" 当中的那个 i。\n        action(i)\n    }\n}\n\nforeach(nums,{i -\u003E print \"${i} \"})\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E前面的文章曾提到过，如果参数列表的最后几个参数是闭包，可以选择性的将这些闭包移动到函数调用后面，英语老师管这种表达方法叫 \"定语后置\"。尤其是当闭包较长时，这种表述方式要更加优雅。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003E\u002F\u002F对那个数组进行 foreach 操作 | 怎么操作\nforeach(nums) {i -\u003E print \"${i} \"}\n\nforeach(nums) {\n\ti-\u003E\n\tprint i\n\tprint \"当闭包很长时，这种写法看起来可读性更高\"\n\tprint \"这个写法已经很接近平日所用的 for-each 循环了。\"\n\tprint \"这就是闭包后置带来的惊喜。\"\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E甚至可以再抽象一点，将 \u003Ccode\u003Enums\u003C\u002Fcode\u003E 数组本身也看作是一个 \u003Ccode\u003E{()-\u003Enums}\u003C\u002Fcode\u003E 的闭包：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Estatic foreach(nums,action){\n    \u002F\u002F nums() 表示它是一个 ()-\u003Enums 的 supplyer.\n    def seq = nums()\n    for(i in seq) {action(i)}\n}\n\u002F\u002F {nums} 实际上是 {-\u003Enums}，这里可以省略掉 -\u003E 箭头。\nforeach {nums} {i-\u003Eprint(\"${i} \")}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E在这个例子中，我们隐约能感受到由 Groovy 创建出的 DSL 将是何其优雅而强大。其中，\u003Ccode\u003Eforeach\u003C\u002Fcode\u003E 接收 \u003Ccode\u003Eaction\u003C\u002Fcode\u003E 闭包 ( 也可以称作是函数 )，因此 \u003Ccode\u003Eforeach\u003C\u002Fcode\u003E 也被称作是\u003Cstrong\u003E高阶函数\u003C\u002Fstrong\u003E 。高阶函数的更直接解释是：一个接收函数，或者是返回另一个函数的函数。\u003C\u002Fp\u003E\n\u003Cp\u003E在 Java 中，一个 Lambda 表达式的写法是这样的：\u003Ccode\u003E(...) -\u003E {...}\u003C\u002Fcode\u003E，即便在没有任何参数的情况下，也得写成 \u003Ccode\u003E()-\u003E{...}\u003C\u002Fcode\u003E 的形式。而在 Groovy 中，闭包的参数不需要小括号括起来，形式上类似 \u003Ccode\u003E{ p1,p2 -\u003E...}\u003C\u002Fcode\u003E 。\u003C\u002Fp\u003E\n\u003Cp\u003E当这个闭包不需要任何参数时，写法形如 \u003Ccode\u003E{ -\u003E ...}\u003C\u002Fcode\u003E，或者是省略掉箭头符号而直接写成 \u003Ccode\u003E{...}\u003C\u002Fcode\u003E 。\u003C\u002Fp\u003E\n\u003Cp\u003E小小的特殊情况：如果闭包只需要一个参数，我们就可以在内部以 \u003Ccode\u003Eit\u003C\u002Fcode\u003E 来称呼它，然后忽略掉参数命名和小箭头。比如：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003E\u002F\u002F {i -\u003E print{\"${i}\"} =====\u003E {print \"${it}\"}\n\u002F\u002F foreach nums, print it. \nforeach {nums} {print(\"${it} \")}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E需要注意的是，如果闭包确实没有接收参数，但是写法却形如 \u003Ccode\u003E{...}\u003C\u002Fcode\u003E，那么 Groovy 还是会隐式地赋予这个闭包一个值为 \u003Ccode\u003Enull\u003C\u002Fcode\u003E 的 \u003Ccode\u003Eit\u003C\u002Fcode\u003E 参数。这会影响到程序在运行期对闭包的动态判断，见后文的动态闭包。\u003C\u002Fp\u003E\n\u003Cp\u003E闭包的参数可以声明严格的类型，比如：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Eforeach {nums} {Integer i -\u003E print \"${i} \"}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 data-id=\"heading-2\"\u003E4.2  Execute Around Method &#x26; AOP\u003C\u002Fh2\u003E\n\u003Cp\u003E在 JVM 语言当中，只要我们能够将不需要的对象标记为不可达，那么它们就可以在适当的时机被 GC 回收。但是在 I\u002FO 密集型任务中，我们希望 InputStream 和 OutputStream 在完成任务之后\u003Cstrong\u003E马上关闭\u003C\u002Fstrong\u003E，否则它们占据的文件句柄就仍然会在 GC 主动回收之前一直处于打开状态。\u003C\u002Fp\u003E\n\u003Cp\u003E这也是为什么 Java ( 以及其它语言的 ) I\u002FO 工具要设计 \u003Ccode\u003Eclose()\u003C\u002Fcode\u003E 或者是 \u003Ccode\u003Edestory()\u003C\u002Fcode\u003E 这样的方法。然而，偶尔我们可能过分专注于功能业务，而忘记主动地调用这些方法 ......\u003C\u002Fp\u003E\n\u003Cp\u003E这种琐碎的劳动不如交给程序来解决。假定所有需要主动关闭的资源都实现了 \u003Ccode\u003EMustClosed()\u003C\u002Fcode\u003E 接口：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Einterface MustClosed {\n    def close()\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E然后，定义一个高阶函数，它接收 \u003Ccode\u003EMustClosed\u003C\u002Fcode\u003E 的实现类，并保证总是在最后调用其 \u003Ccode\u003Eclose()\u003C\u002Fcode\u003E 方法关闭资源，无论在使用过程中是否发生异常。至于使用这个 \u003Ccode\u003EMustClosed\u003C\u002Fcode\u003E 资源的具体细节，将它封装到另一个闭包 \u003Ccode\u003Eaction\u003C\u002Fcode\u003E 当中。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003E\u002F\u002F r 指 Resource,指必须要主动关闭的 I\u002FO 型资源。\ndef static safeUse(MustClosed r, action) {\n    try{\n        action(r)\n    }catch (Exception e){\n        e.printStackTrace()\n    }finally{\n        r.close()\n        print \"${r.getClass().typeName} 实例已经被关闭。\"\n    }\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E一个简单的测试：自定义一个 \u003Ccode\u003EMustClosed\u003C\u002Fcode\u003E 的简单实现，传入 \u003Ccode\u003EsafeUse\u003C\u002Fcode\u003E 函数当中观察控制台的打印顺序：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003EMustClosed resource = [\n        close: { println \"doing close()...\" }\n] as MustClosed\n\ndef action = { MustClosed r -\u003E\n    println \"use resource r to do something...\"\n}\n\n\u002F\u002F 演示了如何调用一个闭包变量\nsafeUse(re) {action(re)}\n\n\u002F*\n\t等价于... 这里的 re 和 r 其实都指代一个引用。\n\tsafeUse(re){\n\t\tMustClosed r -\u003E\n\t\t\tprintln \"use resource r to do something...\"\n\t}\t\n\n*\u002F\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E一个更加真实的测试：将 Java 提供的 \u003Ccode\u003EOutputStream\u003C\u002Fcode\u003E 视作是一个 \u003Ccode\u003EMustClosed\u003C\u002Fcode\u003E 的实现类传入进去，然后感受一下：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Efos = new FileOutputStream(new File(\"README.md\"))\n\n\u002F\u002F 依赖于 Groovy 的动态类型判断\nsafeUse(fos as MustClosed){r -\u003E r.write(\"Groovy!\".bytes)}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E现在，我们无需再手动关闭传入的各种 I\u002FO 资源，\u003Ccode\u003EsafeUse\u003C\u002Fcode\u003E 会帮助搞定一切。诸如这种闭包的使用风格就是 Execute Around Method ( 环绕执行 ) 模式。把思维再发散一些，假设我们在完成一系列业务之前和之后总是要进行一些重复处理，则可以利用这种模式设计出一个模板，只需要替换掉中间不一样的业务。\u003C\u002Fp\u003E\n\u003Cp\u003E这种方式有点似曾相识 ...... 直觉是正确的。它的设计理念和 Spring 框架中的面向切面编程 AOP 没有什么不同，凡是支持 FP 的语言都可以通过环绕执行模式来实现切面化编程。\u003C\u002Fp\u003E\n\u003Ch2 data-id=\"heading-3\"\u003E4.3 可利用闭包自动清理资源\u003C\u002Fh2\u003E\n\u003Cp\u003EGroovy 鉴于 I\u002FO 资源类工具的这些 \"痛点\" 给出了相当体面的实现：它在原有的 I\u002FO 工具类的基础上做了一些包装，我们可以在 FileOutputStream \u002F FileInputStream 工具中，直接调用 \u003Ccode\u003EwithWriter\u003C\u002Fcode\u003E 或者 \u003Ccode\u003EwithReader\u003C\u002Fcode\u003E ( 字符操作 )，\u003Ccode\u003EwithStream\u003C\u002Fcode\u003E ( 字节操作 ) 方法，并直接以闭包的形式告知 FileOutputStream 或者是 FileInputStream 作为 Reader \u002F Writer \u002F Stream 处理数据，并免去原来的装饰者模式带来的一个副作用 —— 不断地创建包装对象。在执行完之后，I\u002FO流会自行关闭。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Ef = new File(\"README.md\")\nassert f.exists()\n\nfos = new FileOutputStream(f)\nString data = \"\"\"{\n    status:200,\n    msg:\"ok\"\n}\n\"\"\"\n\n\u002F\u002F need no more fuxking close() and flush()\nfos.withWriter {\n    \u002F\u002F 其实 w -\u003E w.write(data) 可以一次将长字符串全写进去。\n    \u002F\u002F 这里主要是为了演示闭包的嵌套调用。\n    w -\u003E\n        data.eachLine {\n            w.write(\"${it}\\n\")\n        }\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E尤其是使用\u003Cstrong\u003E带缓冲的输出流\u003C\u002Fstrong\u003E时，我们再也不用担心因为忘记 \u003Ccode\u003Eclose()\u003C\u002Fcode\u003E 或者 \u003Ccode\u003Eflush()\u003C\u002Fcode\u003E 而导致内容丢失的问题了。\u003C\u002Fp\u003E\n\u003Ch2 data-id=\"heading-4\"\u003E4.4 闭包柯里化\u003C\u002Fh2\u003E\n\u003Cp\u003E凡是涉及函数式编程的语言都能进行柯里化 ( Curry ) 变换。我们对函数 ( 或称之闭包 ) 进行柯里化变换的的目的有二：要么是希望记忆 ( 缓存) 一些参数，要么是希望推迟执行某个闭包。举个例子，下面是一个平平无奇的表达式：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003EClosure&#x3C;Integer\u003E expr = { x, y, z -\u003E (x + y) * z }\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E假设在实际的运行当中，我们发现参数 \u003Ccode\u003Ez\u003C\u002Fcode\u003E 相较 \u003Ccode\u003Ex\u003C\u002Fcode\u003E 和 \u003Ccode\u003Ey\u003C\u002Fcode\u003E 而言，它的值似乎不总是变化：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003E\u002F\u002F z 不总是变化\nexpr(2,3,3)\nexpr(1,6,3)\nexpr(1,5,3)\nexpr(5,9,3)\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E因此，我们希望闭包 \u003Ccode\u003Eexpr\u003C\u002Fcode\u003E 在一段时间之内记住 \u003Ccode\u003Ez\u003C\u002Fcode\u003E 的值，以此来避免枯燥的重复传参。于是 \u003Ccode\u003Eexpr\u003C\u002Fcode\u003E 首先被改写成了这个样子：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003EClosure&#x3C;Closure&#x3C;Integer\u003E\u003E expr = {\n    z -\u003E\n        \u002F\u002F 对于这个闭包而言，z 是自由变量。\n        return { x, y -\u003E\n            (x + y) * z\n        }\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E现在，\u003Ccode\u003Eexpr\u003C\u002Fcode\u003E 首先要求提供 \u003Ccode\u003Ez\u003C\u002Fcode\u003E，然后再返回一个参数是 \u003Ccode\u003Ex\u003C\u002Fcode\u003E 和 \u003Ccode\u003Ey\u003C\u002Fcode\u003E 的子闭包，根据描述来看，赋值的过程显然是被拆分成了两步。同时，\u003Ccode\u003Eexpr\u003C\u002Fcode\u003E 演变成了一个高阶函数 ( 高阶闭包 ) 。如果将求值过程比作是开箱子，那么原本只需要一次开箱的取值操作变成了两次。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003E\u002F\u002F 之前:expr(2,3,3)\n\u002F\u002F 之后: \ndef result = expr(3)(2,3)\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E事情变得更麻烦了吗？并不是如此。如果我们率先获取 \u003Ccode\u003Eexpr(3)\u003C\u002Fcode\u003E ，就能提前获取被保存的 \u003Ccode\u003Ez\u003C\u002Fcode\u003E  的状态。因此在后续调用中，我们只管传入不同的 \u003Ccode\u003Ex\u003C\u002Fcode\u003E 和 \u003Ccode\u003Ey\u003C\u002Fcode\u003E 即可。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003E\u002F\u002F (x + y) * 3\ndef memoried_z = expr 3\nmemoried_z(2,3)  \u002F\u002F expr(2,3,3)\nmemoried_z(1,6)  \u002F\u002F expr(1,6,3)\nmemoried_z(1,5)  \u002F\u002F expr(1,5,3)\nmemoried_z(5,9)  \u002F\u002F expr(5,9,3)\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E对于更加深层次的柯里化函数而言，随着函数参数不断被记忆，后续的调用将会变得越来越简单，所需的参数越来越少。而传递的参数越是复杂，或者传参的条目越多，函数柯里化体现出的优势就会越大。在获得所有的参数之前，柯里化函数总是返回闭包，而非真正执行，因此我们也称柯里化函数被推迟调用了。\u003C\u002Fp\u003E\n\u003Ch3 data-id=\"heading-5\"\u003E4.4.1 便捷的柯里化转换方法\u003C\u002Fh3\u003E\n\u003Cp\u003E如果函数的功能再复杂一些，那么手动重构一个柯里化实现可能要花上一点时间 ( 更多的是思绪上的混乱 )。好在 Groovy 提供了一系列便捷的方法来代替我们完成柯里化转换。对于一个参数个数为 n 的函数，如果想将其前 k 个参数进行柯里化，可以调用\u003Ccode\u003Ecurry()\u003C\u002Fcode\u003E 方法来完成，其中 \u003Ccode\u003E0 &#x3C;= k &#x3C;= n\u003C\u002Fcode\u003E。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Eexpr = {x, y, z -\u003E (x + y) * z}\n\n\u002F\u002F 返回一个新的表达式： ( 3 + 2 ) * z =\u003E 5z\nexpr1 = expr.curry(3,2)\n\n\u002F\u002F 10\nprintln expr1(2)\n\n\u002F\u002F 返回一个新的表达式: (1 + 2) * 3 = 9\nprintln expr.curry(1,2,3)()\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E如果要从后向前开始柯里化，则需使用 \u003Ccode\u003Ercurry()\u003C\u002Fcode\u003E 方法：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Eexpr = {x, y, z -\u003E (x + y) * z}\n\n\u002F\u002F expr = (x + 3) * 2\nexpr1 = expr.rcurry(3,2)\n\n\u002F\u002F 12\nprintln expr1(3)\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E如果要从前面的第 k 个参数开始柯里化，则需要使用 \u003Ccode\u003Encurry()\u003C\u002Fcode\u003E 方法，其中 \u003Ccode\u003E0 &#x3C;= k &#x3C;= n\u003C\u002Fcode\u003E，当 \u003Ccode\u003Ek = 0\u003C\u002Fcode\u003E 时，指从第一个参数开始柯里化，此时等价于 \u003Ccode\u003Ecurry()\u003C\u002Fcode\u003E 方法。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Eexpr = {x,y,z -\u003E (x + y) * z}\n\n\u002F\u002F expr1 = (x + 3) * 2\nexpr1 = expr.ncurry(1,3,2)\n\n\u002F\u002F 10\nprintln expr1(2)\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 data-id=\"heading-6\"\u003E4.5 动态闭包\u003C\u002Fh2\u003E\n\u003Cp\u003EGroovy 可以在程序运行时动态地判断传入闭包的参数列表长度，甚至是参数类型，我们可以利用这个特性赋予程序动态决策的能力。比如：假定公司要根据营收额来统计交税额。我们想以闭包的形式将税额计算方法传递到一个高阶函数当中去计算。然而，这个闭包有可能不需要提供税率 ( 用户直接给出计算公式 )，也有可能需要 ( 用户仅提供计算方法，此时由高阶函数提供一个默认值)：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Edef tax(Double amount,Closure computer){\n    switch (computer.maximumNumberOfParameters){\n        case 1 : return computer(amount)\n        case 2 : return computer(amount,15)\n        default: throw new Exception(\"need 1 or 2 args.\")\n    }\n}\n\n\n\u002F\u002F 这个闭包传入了税率计算方式以及税率，只需要 1 个参数\nprintln tax(14000.0) {\n        amount -\u003E amount * 0.13\n}\n\n\u002F\u002F 这个闭包不主动传入税率 rage，有 2 个参数\nprintln tax(14000.0) {\n    amount,rage -\u003E amount * (rage\u002F100)\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E如果 Groovy 能够确定一个参数是闭包，那么可以访问其 \u003Ccode\u003E.maxinumNumberOfParameters\u003C\u002Fcode\u003E 属性来判断闭包传入时实际的参数个数。如果用户不提供税率，那么就直接按照用户的公式计算交税额。否则，由高阶函数给出一个默认税率并计算。\u003C\u002Fp\u003E\n\u003Cp\u003E除了动态判断参数的个数，还可以使用 \u003Ccode\u003EparameterTypes\u003C\u002Fcode\u003E 属性来动态获取参数的实际类型。比如：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Edef check(Closure cls){\n    int i = 1\n    for(args in cls.parameterTypes) { println \"type[${i}] = ${args.typeName}\";i++}\n    \u002F\u002F.. 什么也不做\n}\n\n\u002F\u002F type[1] = java.lang.String\ncheck {\n    String i -\u003E \u002F\u002F.. 什么都不做\n}\n\n\u002F\u002F type[1] = java.lang,Integer\ncheck {\n    Integer i -\u003E \u002F\u002F.. 还是什么也不做\n}\n\n\u002F\u002Ftype[1] = java.lang.Integer\n\u002F\u002Ftype[2] = java.lang.String\ncheck {\n    Integer i , String s -\u003E \u002F\u002F.. 仍然什么也不做\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E注意，前文曾提到过，如果闭包不需要任何参数，那么形式上可以写为 \u003Ccode\u003E{...}\u003C\u002Fcode\u003E 或者是 \u003Ccode\u003E{ -\u003E ...}\u003C\u002Fcode\u003E，两者的区别是：Groovy 仍然会为前者赋予一个隐含的参数 \u003Ccode\u003Eit\u003C\u002Fcode\u003E，只不过这个值是 \u003Ccode\u003Enull\u003C\u002Fcode\u003E。但对于后者，Groovy 则认为这个它是一个严格的无参数闭包。\u003C\u002Fp\u003E\n\u003Ch2 data-id=\"heading-7\"\u003E4.6 闭包执行上下文与闭包委托\u003C\u002Fh2\u003E\n\u003Cp\u003E假设这是一个闭包：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Edef closure = {\n\tfunc()\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E显然，如果没有其它的线索，那么就很难说 \u003Ccode\u003Efunc()\u003C\u002Fcode\u003E 调用是从哪来的。先把这个问题搁置在一边，我们有更重要的概念需要提及。\u003C\u002Fp\u003E\n\u003Cp\u003EGroovy 为每一个闭包都定义了三个属性：\u003Ccode\u003EthisObject\u003C\u002Fcode\u003E，\u003Ccode\u003Eowner\u003C\u002Fcode\u003E，\u003Ccode\u003Edelegate\u003C\u002Fcode\u003E。所有的闭包都和它所在类的实例相绑定，并且会被 Groovy 编译成一个内部类的实例。对于一般的闭包，\u003Ccode\u003Ethis == owner == delegate\u003C\u002Fcode\u003E ，比如说外部的 \u003Ccode\u003Eout\u003C\u002Fcode\u003E 闭包。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Eclass _Example_{\n    def out = {\n        \u002F\u002F 这是相对而言的内部闭包。\n        def inner = {}\n        \u002F\u002F------test of thisObject, owner, delegate----------\u002F\u002F\n        println out.thisObject.getClass().name\t\t\u002F\u002F_Example_\n        println out.owner.getClass().name\t\t\t\u002F\u002F_Example_\n        println out.delegate.getClass().name\t\t\u002F\u002F_Example_\n    }\n}\n\nnew _Example_().out()\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E但对于一些特殊情况就有所不同了：第一种情况是闭包嵌套的情况。比如说 \u003Ccode\u003Eout\u003C\u002Fcode\u003E 闭包内部定义的  \u003Ccode\u003Einner\u003C\u002Fcode\u003E 闭包。如果访问该 \u003Ccode\u003Einner\u003C\u002Fcode\u003E 闭包的 \u003Ccode\u003Eowner\u003C\u002Fcode\u003E ，它将指向外部闭包 \u003Ccode\u003Eout\u003C\u002Fcode\u003E 的实例。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Eclass _Example_{\n    def out = {\n        \u002F\u002F 这是相对而言的内部闭包。\n        def inner = {}\n\n        \u002F\u002F------test of thisObject, owner, delegate----------\u002F\u002F\n        println out.thisObject.getClass().name\t\t\u002F\u002F_Example_\n        println out.thisObject.hashCode()           \u002F\u002F == inner.thisObject.hashCode\n        println out.owner.getClass().name\t\t\t\u002F\u002F_Example_\n        println out.delegate.getClass().name\t\t\u002F\u002F_Example_\n\n        println inner.thisObject.getClass().name    \u002F\u002F_Example_\n        println inner.thisObject.hashCode()         \u002F\u002F == out.thisObject.hashCode\n        println inner.owner.getClass().name         \u002F\u002F_Example_$_closure1 (指外部闭包被编译的内部类)\n        println inner.delegate.getClass().name      \u002F\u002F_Example_$_closure1 (指外部闭包被编译的内部类)\n    }\n}\n\nnew _Example_().out()\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E在第二种特殊情况下，\u003Ccode\u003Edelegate\u003C\u002Fcode\u003E 将不再指向 \u003Ccode\u003Eowner\u003C\u002Fcode\u003E，那就是进行\u003Cstrong\u003E闭包委托\u003C\u002Fstrong\u003E的情形。用简单的话来概述它，就是闭包内部调用的一些方法，\u003Cstrong\u003E可能\u003C\u002Fstrong\u003E来自于另一个委托类的实例。声明如下：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003E\u002F\u002F \"代理类\"\nclass _Proxy_{}\nclass _Example_{\n    def out = {\n        def inner = {}\n        inner.delegate = new _Proxy_()\n        \n        \u002F\u002F thisObject, owner, delegate 都不一样。\n        println inner.thisObject.getClass().name\n        println inner.owner.getClass().name\n        println inner.delegate.getClass().name\n    }\n}\n\n\u002F\u002F_Example_\n\u002F\u002F_Example_$_closure1\n\u002F\u002F_Proxy_\nnew _Example_().out()\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E理解这三个闭包的基本属性之后，再去解释本节开头的那个问题就容易得多了：如果一个闭包内部使用的方法或变量在局部块内没有，那么 Groovy 优先在 \u003Ccode\u003EthisObject\u003C\u002Fcode\u003E 或者 \u003Ccode\u003Eowner\u003C\u002Fcode\u003E 域查找；否则，试图从 \u003Ccode\u003Edelegate\u003C\u002Fcode\u003E 那里查找；否则，就会报错返回。如果能在前两个域当中找到合适的内容，那么 Groovy 就绝对不会 \"打扰\" \u003Ccode\u003Edelegate\u003C\u002Fcode\u003E。\u003C\u002Fp\u003E\n\u003Cp\u003E观察下面的完整代码。由于 \u003Ccode\u003E_Example_ \u003C\u002Fcode\u003E 类定义了 \u003Ccode\u003Efunc1\u003C\u002Fcode\u003E ，\u003Ccode\u003Eout\u003C\u002Fcode\u003E 闭包定义了\u003Ccode\u003Efunc2\u003C\u002Fcode\u003E，因此即便是 \u003Ccode\u003Einner\u003C\u002Fcode\u003E 设置了闭包代理，Groovy 也没有进行路由。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Eclass _Proxy_{\n    def func1 = { println \"this [func1] is from the instance of Class: _Proxy_\" }\n    def func2 = { println \"this [func2] is still from the instance of Class: _Proxy_\" }\n}\n\nclass _Example_{\n\n    def func1 = { println \"this [func1] is from the instance of Class:_Example_.\"}\n    def out = {\n        def func2 = { println \"this [func2] is from the instance of closure:out\"}\n        def inner = {\n            func1()\n            func2()\n        }\n        inner.delegate = new _Proxy_()\n        inner()\n    }\n}\n\n\u002F\u002Fthis [func1] is from the instance of Class:_Example_.\n\u002F\u002Fthis [func2] is from the instance of closure:out\nnew _Example_().out()\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E一旦注释掉 \u003Ccode\u003E_Example_\u003C\u002Fcode\u003E 内部的 \u003Ccode\u003Efunc1\u003C\u002Fcode\u003E 或者是 \u003Ccode\u003Efunc2\u003C\u002Fcode\u003E 闭包，Groovy 就会从 \u003Ccode\u003E_Proxy_\u003C\u002Fcode\u003E 那里尝试弥补缺失的内容，从而给出不同的运行结果。比如：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Eclass _Proxy_{\n    def func1 = { println \"this [func1] is from the instance of Class: _Proxy_\" }\n    def func2 = { println \"this [func2] is still from the instance of Class: _Proxy_\" }\n}\n\nclass _Example_{\n    def out = {\n        def inner = {\n            func1()\n            func2()\n        }\n        inner.delegate = new _Proxy_()\n        inner()\n    }\n}\n\n\u002F\u002Fthis [func1] is from the instance of Class: _Proxy_\n\u002F\u002Fthis [func2] is still from the instance of Class: _Proxy_\nnew _Example_().out()\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E另一种闭包委托的声明方式会令 Groovy 倒置查找顺序：即优先选择 \u003Ccode\u003Edelegate\u003C\u002Fcode\u003E 的方法，其次才是 \u003Ccode\u003Eowner\u003C\u002Fcode\u003E 或 \u003Ccode\u003EthisObejct\u003C\u002Fcode\u003E。具体做法是通过调用一个对象的 \u003Ccode\u003E.with\u003C\u002Fcode\u003E 方法 \"外挂\" 闭包。如下所示：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Eclass _Proxy_{\n    def func1 = { println \"this [func1] is from the instance of Class: _Proxy_\" }\n    def func2 = { println \"this [func2] is still from the instance of Class: _Proxy_\" }\n}\n\nclass _Example_{\n    def func1 = { println \"this [func1] is from the instance of Class: _Example_\" }\n    def func2 = { println \"this [func2] is still from the instance of Class: _Example_\" }\n    def out = {\n        def inner = {\n            func1()\n            func2()\n        }\n        new _Proxy_().with inner\n    }\n}\n\n\u002F\u002Fthis [func1] is from the instance of Class: _Proxy_\n\u002F\u002Fthis [func2] is still from the instance of Class: _Proxy_\nnew _Example_().out()\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E注，\u003Ccode\u003Edelegate\u003C\u002Fcode\u003E 在涉及 DSL 的方面会变得非常有用。\u003C\u002Fp\u003E\n\u003Ch2 data-id=\"heading-8\"\u003E4.7 尾递归\u003C\u002Fh2\u003E\n\u003Cp\u003E递归代码常常被认为是 \"有品位但是不好驾驭\" 的典型，和迭代相比，递归从表达上可能更加晦涩，因此令大部分程序员避之不及。令一个经常遇到的麻烦是：当递归的层次过深时，JVM 会招架不住而抛出一个 \u003Ccode\u003EStackOverFlowError\u003C\u002Fcode\u003E 。我们都知道，JVM 的每一个线程都使用一个栈空间来管理它调用的函数，并为每一个函数分配一个栈帧。如果这个栈一直处于 \"只进不出\" 的状态，那么 JVM 理论上就有驾崩的危险。\u003C\u002Fp\u003E\n\u003Cp\u003E解决栈溢出的思路却又很简单：只要让栈维持 \"边进边出\" 的状态就可以了。具体的做法是：将一般的递归函数改进成尾递归。尾递归的意思是：当调用下一个函数时，当前的调用直接将返回值传递给它，并且没有后续计算，线程也自然就认为没有必要保存当前调用的栈帧。\u003C\u002Fp\u003E\n\u003Cp\u003E用一个例子来说明或许更实在一点：n 的阶乘。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003E\u002F**\n * 为什么这个方法不是尾递归？\n * 如果它的返回值是 n * factorial(n-1)，那么本次调用就需要等待下一次调用的 factorial(n-1) 来计算返回值。\n * 因此，假定 n == 3 , 那么线程就需要 3 层栈空间来解决它。\n * 假定 n 取了更大的值 , 那么 JVM 就会呻吟了。\n * @param n\n * @return\n *\u002F\nint factorial(int n){\n   return n &#x3C;= 1 ? 1 :n * factorial(n-1)\n}\n\nimport groovy.transform.TailRecursive\n\n\u002F**\n * 为什么这个方法是尾递归？\n * 无论是哪个分支，该递归函数总是返回一个数值或者发起一个新的调用，且当前调用没有需要等待的后续运算了。\n * 而递归过程的中间结果会不断地被装入 acc 参数中并传递。\n * 所以，在当前调用结束之后，它可以安全地 \"传宗接代且无后顾之忧\"。 \n * 无论 n 取何值，这个尾递归始终只占用 1 层栈空间。\n * 唯一不太方便的是，用户调用这个函数需要主动为 acc 传递一个初始值，而我们一般都靠包装函数来解决这个瑕疵。\n * @param n\n * @return\n *\u002F\n@TailRecursive\nint factorial_t(int n,int acc){\n    return n &#x3C;= 1 ? acc : factorial_t(n-1,acc * n)\n}\n\n\u002F\u002F good\nprintln factorial_t(10000,1)\n\n\u002F\u002F bad, 99.99% 报错\nprintln factorial(10000)\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E其中，\u003Ccode\u003E@TailRecursive\u003C\u002Fcode\u003E 注解负责检查函数，如果它不是严格尾递归的，那么就会在编译器期间报错。闭包版本的尾递归则和函数版本不太一样，其尾递归需要借助 \u003Ccode\u003Etrampoline\u003C\u002Fcode\u003E ( 意 \"弹簧床\" ) 方法来实现。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003E\u002F\u002F 对于递归闭包，我们必须先定义出一个变量作为它的名字，才能在闭包内部调用自身。\ndef f \n\nf = {\n    i, BigInteger n -\u003E i &#x3C;= 1 ? n : f.trampoline(i - 1, n * i)\n}.trampoline()\n\nf(1000)\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E另外，考虑到用户体验，不妨将闭包的 \u003Ccode\u003Eacc\u003C\u002Fcode\u003E 参数设置为默认值 1 ( 因为它是最后一个参数 )，因此该参数对用户来说可以是透明的。需要指出的是，同等的算法逻辑和入参，函数的执行速度要比闭包快得多。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003EBigInteger factorial_func(int i, BigInteger n) {\n    i &#x3C;= 1 ? n : factorial_func(i - 1, n * i)\n}\n\nfactorial_closure = {\n    i, BigInteger n = 1 -\u003E i &#x3C;= 1 ? n : factorial_closure.trampoline(i - 1, n * i)\n}.trampoline()\n\nl1 = System.currentTimeMillis()\nprintln factorial_closure(1000)\n\n\u002F\u002F 250 ~ 300 millis\nprintln System.currentTimeMillis() - l1\n\nl1 = System.currentTimeMillis()\nprintln factorial_func(1000, 1 as BigInteger)\n\n\u002F\u002F 4 ~ 10 millis\nprintln System.currentTimeMillis() - l1\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 data-id=\"heading-9\"\u003E4.8 从钢条切割问题探讨递归优化\u003C\u002Fh2\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E该问题参考自：\u003Ca href=\"https:\u002F\u002Flink.juejin.cn?target=https%3A%2F%2Fwww.cnblogs.com%2Ftgycoder%2Fp%2F4980655.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\" title=\"https:\u002F\u002Fwww.cnblogs.com\u002Ftgycoder\u002Fp\u002F4980655.html\" ref=\"nofollow noopener noreferrer\"\u003E动态规划-钢杆切割问题 - RunningSnail - 博客园 (cnblogs.com)\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003E假定我们是钢杆 ( 或者称钢条 ) 的卖家，不同长度的钢杆价位不同，**且钢杆长度和价格并不是线性相关的 ( 这就表明了整根卖不一定获利最大 ) **。现在给定一个长钢杆，我们希望对它做一些切割以获得最大利润。长度为 \u003Ccode\u003En\u003C\u002Fcode\u003E 的钢杆，它的价格记作 \u003Ccode\u003ErodPrices[n]\u003C\u002Fcode\u003E  ：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-ini copyable\" lang=\"ini\"\u003EInteger\u003Cspan class=\"hljs-section\"\u003E[]\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003ErodPrices\u003C\u002Fspan\u003E = [\u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E1\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E3\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E4\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E5\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E8\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E9\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E11\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E12\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E14\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E15\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E15\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E16\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E18\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E19\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E15\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E20\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E21\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E22\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E24\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E25\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E24\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E26\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E28\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E29\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E35\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E37\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E38\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E39\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E40\u003C\u002Fspan\u003E]\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E比如，长度为 2 的钢杆，它的价格为 3，而长度为 5 的钢杆，它的价格仅为 8 ( 性价比似乎还 \"提高\" 了) 。此外，这里为了消除 0 下标的 \"错位\" 影响，令 \u003Ccode\u003ErodPrices[0] == 0\u003C\u002Fcode\u003E 。第一问：首先求长度为 27 的钢杆，它所能获得的最大利润。\u003C\u002Fp\u003E\n\u003Cp\u003E最朴素的想法是：穷举所有的切割方案并择优选取。一提及穷举，我们自然就会想到迭代，或者递归，或者\u003Cstrong\u003E两者兼具\u003C\u002Fstrong\u003E。\u003C\u002Fp\u003E\n\u003Cp\u003E进一步思考，每次将一段长杆 \u003Ccode\u003El\u003C\u002Fcode\u003E 切割，都会产生两个短杆 \u003Ccode\u003Es1\u003C\u002Fcode\u003E ，\u003Ccode\u003Es2\u003C\u002Fcode\u003E 。设长度为 \u003Ccode\u003En\u003C\u002Fcode\u003E 的钢杆的最大利润为 \u003Ccode\u003Emax(n)\u003C\u002Fcode\u003E，那显然我们只要求出 \u003Ccode\u003Emax(s1)\u003C\u002Fcode\u003E 和 \u003Ccode\u003Emax(s2)\u003C\u002Fcode\u003E，那么就能推算出 \u003Ccode\u003Emax(l) = max(s1) + max(p2)\u003C\u002Fcode\u003E 。那 \u003Ccode\u003Emax(s1)\u003C\u002Fcode\u003E又该怎么求呢？它肯定又能分出更短的杆 \u003Ccode\u003Ess1\u003C\u002Fcode\u003E 和 \u003Ccode\u003Ess2\u003C\u002Fcode\u003E ，我们继续求 \u003Ccode\u003Emax(ss1)\u003C\u002Fcode\u003E 和 \u003Ccode\u003Emax(ss2)\u003C\u002Fcode\u003E 就好了 ......\u003C\u002Fp\u003E\n\u003Cp\u003E从这段描述中，我们能够提取出四个要点：\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003E大问题的目的是求最优解。\u003C\u002Fli\u003E\n\u003Cli\u003E大问题可以分解成若干小问题。\u003C\u002Fli\u003E\n\u003Cli\u003E大问题的最优解依赖于小问题的最优解。\u003C\u002Fli\u003E\n\u003Cli\u003E我们现在正 \"自上而下\" 地将大问题不断分解成小问题。\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cp\u003E因此，钢杆 ( 钢条 ) 切割问题本质上是一道\u003Cstrong\u003E动态规划\u003C\u002Fstrong\u003E题。在下面的叙述中，我们将 \"求长度为 \u003Ccode\u003Elength\u003C\u002Fcode\u003E 的钢杆的最大利润\" 封装为一个函数 \u003Ccode\u003ErodCut(length)\u003C\u002Fcode\u003E 。\u003C\u002Fp\u003E\n\u003Cp\u003E设传进来长度为 \u003Ccode\u003Elength\u003C\u002Fcode\u003E 的长杆，切割后的两杆其一为 \u003Ccode\u003Es1\u003C\u002Fcode\u003E ，长度记作 \u003Ccode\u003Ei\u003C\u002Fcode\u003E；而另一个 \u003Ccode\u003Es2\u003C\u002Fcode\u003E 的长度则为 \u003Ccode\u003Elength - i\u003C\u002Fcode\u003E。我们在一个\u003Cstrong\u003E迭代\u003C\u002Fstrong\u003E中动态平衡两杆的长度，且在每一次迭代内部，保留 \u003Ccode\u003Es1\u003C\u002Fcode\u003E 的长度不变，假设它的当前最优解就是 \u003Ccode\u003Emax'(s1)\u003C\u002Fcode\u003E 。以此为前提去对 \u003Ccode\u003Es2\u003C\u002Fcode\u003E 进行\u003Cstrong\u003E递归切割\u003C\u002Fstrong\u003E，即调用 \u003Ccode\u003ErodCut(s2)\u003C\u002Fcode\u003E。\u003C\u002Fp\u003E\n\u003Cp\u003E我们确信 \u003Ccode\u003ErodCut\u003C\u002Fcode\u003E 总能正确的返回 \u003Ccode\u003Emax(s2)\u003C\u002Fcode\u003E，因此每次迭代的 \u003Ccode\u003Emax'(length) = max'(s1) + rodCut(s2)\u003C\u002Fcode\u003E 。在迭代完成后，只需要从这些结果值中取出实际最大值作为当前 \u003Ccode\u003ErodCut(length)\u003C\u002Fcode\u003E 调用的返回值即可。\u003C\u002Fp\u003E\n\u003Cdiv class=\"math math-display\"\u003E\u003Cspan class=\"katex-display\"\u003E\u003Cspan class=\"katex\"\u003E\u003Cspan class=\"katex-mathml\"\u003E\u003Cmath xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\" display=\"block\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmi\u003Er\u003C\u002Fmi\u003E\u003Cmi\u003Eo\u003C\u002Fmi\u003E\u003Cmi\u003Ed\u003C\u002Fmi\u003E\u003Cmi\u003EC\u003C\u002Fmi\u003E\u003Cmi\u003Eu\u003C\u002Fmi\u003E\u003Cmi\u003Et\u003C\u002Fmi\u003E\u003Cmo stretchy=\"false\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003El\u003C\u002Fmi\u003E\u003Cmi\u003Ee\u003C\u002Fmi\u003E\u003Cmi\u003En\u003C\u002Fmi\u003E\u003Cmi\u003Eg\u003C\u002Fmi\u003E\u003Cmi\u003Et\u003C\u002Fmi\u003E\u003Cmi\u003Eh\u003C\u002Fmi\u003E\u003Cmo stretchy=\"false\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmi\u003EM\u003C\u002Fmi\u003E\u003Cmi\u003Ea\u003C\u002Fmi\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\"false\"\u003E{\u003C\u002Fmo\u003E\u003Cmi\u003Em\u003C\u002Fmi\u003E\u003Cmi\u003Ea\u003C\u002Fmi\u003E\u003Cmsub\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmi\u003Ei\u003C\u002Fmi\u003E\u003C\u002Fmsub\u003E\u003Cmo stretchy=\"false\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Es\u003C\u002Fmi\u003E\u003Cmn\u003E1\u003C\u002Fmn\u003E\u003Cmo stretchy=\"false\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E+\u003C\u002Fmo\u003E\u003Cmi\u003Er\u003C\u002Fmi\u003E\u003Cmi\u003Eo\u003C\u002Fmi\u003E\u003Cmi\u003Ed\u003C\u002Fmi\u003E\u003Cmi\u003EC\u003C\u002Fmi\u003E\u003Cmi\u003Eu\u003C\u002Fmi\u003E\u003Cmi\u003Et\u003C\u002Fmi\u003E\u003Cmo stretchy=\"false\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Es\u003C\u002Fmi\u003E\u003Cmn\u003E2\u003C\u002Fmn\u003E\u003Cmo stretchy=\"false\"\u003E)\u003C\u002Fmo\u003E\u003Cmtext\u003E \u003C\u002Fmtext\u003E\u003Cmi mathvariant=\"normal\"\u003E∣\u003C\u002Fmi\u003E\u003Cmtext\u003E \u003C\u002Fmtext\u003E\u003Cmn\u003E1\u003C\u002Fmn\u003E\u003Cmo\u003E≤\u003C\u002Fmo\u003E\u003Cmi\u003Ei\u003C\u002Fmi\u003E\u003Cmo\u003E≤\u003C\u002Fmo\u003E\u003Cmi\u003El\u003C\u002Fmi\u003E\u003Cmi\u003Ee\u003C\u002Fmi\u003E\u003Cmi\u003En\u003C\u002Fmi\u003E\u003Cmi\u003Eg\u003C\u002Fmi\u003E\u003Cmi\u003Et\u003C\u002Fmi\u003E\u003Cmi\u003Eh\u003C\u002Fmi\u003E\u003Cmo stretchy=\"false\"\u003E}\u003C\u002Fmo\u003E\u003Cmspace linebreak=\"newline\"\u003E\u003C\u002Fmspace\u003E\u003Cmi\u003El\u003C\u002Fmi\u003E\u003Cmi\u003Ee\u003C\u002Fmi\u003E\u003Cmi\u003En\u003C\u002Fmi\u003E\u003Cmi\u003Eg\u003C\u002Fmi\u003E\u003Cmi\u003Et\u003C\u002Fmi\u003E\u003Cmi\u003Eh\u003C\u002Fmi\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmi\u003Es\u003C\u002Fmi\u003E\u003Cmn\u003E1\u003C\u002Fmn\u003E\u003Cmo\u003E+\u003C\u002Fmo\u003E\u003Cmi\u003Es\u003C\u002Fmi\u003E\u003Cmn\u003E2\u003C\u002Fmn\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\"application\u002Fx-tex\"\u003ErodCut(length) = Max\\{max_i(s1) + rodCut(s2)\\space|\\space1≤i≤length\\} \\\\ length = s1 + s2\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"katex-html\" aria-hidden=\"true\"\u003E\u003Cspan class=\"base\"\u003E\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Eo\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Ed\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\"\u003EC\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Eu\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\"mopen\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.01968em;\"\u003El\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Ee\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003En\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003Eg\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Eh\u003C\u002Fspan\u003E\u003Cspan class=\"mclose\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mrel\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"base\"\u003E\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003EM\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Ea\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\"mopen\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Em\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Ea\u003C\u002Fspan\u003E\u003Cspan class=\"mord\"\u003E\u003Cspan class=\"mord mathnormal\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\"msupsub\"\u003E\u003Cspan class=\"vlist-t vlist-t2\"\u003E\u003Cspan class=\"vlist-r\"\u003E\u003Cspan class=\"vlist\" style=\"height:0.31166399999999994em;\"\u003E\u003Cspan style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"\u003E\u003Cspan class=\"pstrut\" style=\"height:2.7em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"sizing reset-size6 size3 mtight\"\u003E\u003Cspan class=\"mord mathnormal mtight\"\u003Ei\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"vlist-s\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"vlist-r\"\u003E\u003Cspan class=\"vlist\" style=\"height:0.15em;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mopen\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Es\u003C\u002Fspan\u003E\u003Cspan class=\"mord\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"mclose\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mbin\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"base\"\u003E\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Eo\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Ed\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\"\u003EC\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Eu\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\"mopen\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Es\u003C\u002Fspan\u003E\u003Cspan class=\"mord\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"mclose\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"mord\"\u003E∣\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\"\u003E \u003C\u002Fspan\u003E\u003Cspan class=\"mord\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mrel\"\u003E≤\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"base\"\u003E\u003Cspan class=\"strut\" style=\"height:0.79549em;vertical-align:-0.13597em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Ei\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mrel\"\u003E≤\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"base\"\u003E\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.01968em;\"\u003El\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Ee\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003En\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003Eg\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Eh\u003C\u002Fspan\u003E\u003Cspan class=\"mclose\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mspace newline\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"base\"\u003E\u003Cspan class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.01968em;\"\u003El\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Ee\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003En\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003Eg\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Eh\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mrel\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"base\"\u003E\u003Cspan class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Es\u003C\u002Fspan\u003E\u003Cspan class=\"mord\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mbin\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"base\"\u003E\u003Cspan class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"mord mathnormal\"\u003Es\u003C\u002Fspan\u003E\u003Cspan class=\"mord\"\u003E2\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003E另外还有一个细节：如果在某一次迭代中  \u003Ccode\u003Es1 \u003C\u002Fcode\u003E 的长度 \u003Ccode\u003Ei == length\u003C\u002Fcode\u003E，那么显然 \u003Ccode\u003Es2 == 0\u003C\u002Fcode\u003E 。这时表示不对长度 \u003Ccode\u003Elength\u003C\u002Fcode\u003E 的杆进行切割，此时 \u003Ccode\u003Emax(length) == rodPrices[length]\u003C\u002Fcode\u003E 。\u003C\u002Fp\u003E\n\u003Cp\u003E根据上述思路，我们迅速给出了第一版解决方案：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003EInteger rodCut(Integer[] rodPrices, length) {\n\n    \u002F\u002F 虽然 length[0] 即为 0，但是我们想让调用短路返回，而不是继续执行。\n    \u002F\u002F 这个 if 不可省略。\n    if (length == 0) return 0\n\n    def max = -1\n\n    \u002F\u002F \"左杆\" s1 的长度至少为 1，否则就没意义。\n    \u002F\u002F 当 length = 1 时， length -1 = 0， 调用会进入临界条件。\n    for (i in 1..length) {\n        def p = rodPrices[i] + rodCut(rodPrices, length - i)\n        if (p \u003E max) max = p\n    }\n\n    return max\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E现在提出一个新的要求：不仅要求出最大利润，还要给出详细的切割方案。比如：长度为 \u003Ccode\u003E27\u003C\u002Fcode\u003E  的杆，它的最大利润是 \u003Ccode\u003E43\u003C\u002Fcode\u003E，切割方案是：\u003Ccode\u003E[5,5,5,5,5,2]\u003C\u002Fcode\u003E ，数组内的每个元素是短杆的长度。\u003C\u002Fp\u003E\n\u003Cp\u003E此时不仅要在迭代过程中寻求最优解，还要在此记录每一次求得最优解时短杆的长度。出于这个目的，我们设计出了如下数据结构：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003E@Canonical\nfinal class Plan {\n    Integer amount\n    ArrayList splits\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EPlan 表示一个切割方案，比如 \u003Ccode\u003Enew Plan(amount: 4, splits:[1,2])\u003C\u002Fcode\u003E 表示这个切割方案中有长度为 1 和 2 的两个子杆，这个方案的总收入为 4。\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ccode\u003Esplits\u003C\u002Fcode\u003E 是线性表，用于记录短杆的长度。可以预见的是：长杆 Plan 的创建基于短杆 Plan，新的 \u003Ccode\u003Esplits\u003C\u002Fcode\u003E 总是之前 Plan 的 \u003Ccode\u003Esplits\u003C\u002Fcode\u003E 再插入一个新的元素，而链表能够从容地应对不断追加元素的场合，所以 \u003Ccode\u003Esplits\u003C\u002Fcode\u003E 被设置为 ArrayList 类。\u003C\u002Fp\u003E\n\u003Cp\u003E第二版解决方案也出炉了：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003E@Newify(Plan)\ndef rodCut(rodPrices, length) {\n\n    if (length == 0) return Plan(amount: 0, splits: [])\n\n    def max = Plan(amount: -1, splits: [])\n\n    \u002F\u002F 至少切割成 (1,length-1)，否则没有意义。\n    \u002F\u002F 当 length = 1 时， length - 1 = 0， 要考虑到边界条件。\n    for (i in 1..length) {\n        \n        \u002F\u002F left : 这里是 \"剩下的\" 意思。\n        \u002F\u002F 获得 \"右杆\" s2 的最优 Plan\n        def leftRod = rodCut(rodPrices, length - i)\n\n        \u002F\u002F 推算当前迭代中的 \"最优\" Plan = \"左杆\" Plan + \"右杆\" Plan\n        def try_ = Plan(amount: rodPrices[i] + leftRod.amount, splits: leftRod.splits + i)\n\n        if (try_.amount \u003E max.amount) max = try_\n    }\n\n    \u002F\u002F 返回实际的长度 Length 的杆所对应的最优 Plan.\n    return max\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E注意，这里存在 Groovy 的语法糖：那就是 \u003Ccode\u003EleftRod.split + i\u003C\u002Fcode\u003E。这是一个操作符重载，实际上可理解为 \u003Ccode\u003EleftRod.splits.add(i)\u003C\u002Fcode\u003E 。该算法的 Groovy 闭包版本是：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Edef rodCuts\n\nrodCut = {\n    rod_prices, length -\u003E\n        if (length == 0) return new Plan(amount: 0, splits: [])\n        def max = new Plan(amount: -1, splits: [])\n        for (i in 1..length) {\n            def leftRod = rodCut(rodPrices, length - i)\n            def try_ = new Plan(amount: rodPrices[i] + leftRod.amount, splits: leftRod.splits + i)\n            if (try_.amount \u003E max.amount) max = try_\n        }\n        return max\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3 data-id=\"heading-10\"\u003E4.8.1 利用记忆化改进性能\u003C\u002Fh3\u003E\n\u003Cp\u003E人们常说：过早的优化是万恶之源。因此在之前笔者刻意回避了 \u003Ccode\u003ErodCut\u003C\u002Fcode\u003E 函数的运行效率。运行第二版的函数 \u002F 闭包，程序需要运行大约 1 ~ 2 分钟的时间才能给出答案。\u003C\u002Fp\u003E\n\u003Cp\u003E为什么会这样？我们其实还忽略了第五个要点：那就是将大问题分解为小问题时，应当避免对重复的小问题求解。比如：\"将长为 10 的杆分为两个 5\"  和 \"将长为 8 的杆分成 3 和 5\" 的两个情形都涉及到 \"求杆长为 5 的最优解\"。很不巧的是，在目前的递归过程中，\u003Ccode\u003ErodCut\u003C\u002Fcode\u003E 函数对传进来的 \u003Ccode\u003Elength\u003C\u002Fcode\u003E 几乎来者不拒，却从来不检讨这个计算有无必要。\u003C\u002Fp\u003E\n\u003Cp\u003E一个简单却十分有效的办法是，在调用这个函数的同时，传入一个足够长的 \u003Ccode\u003Ecache\u003C\u002Fcode\u003E 数组作为缓存。其中，\u003Ccode\u003Ecache[n]\u003C\u002Fcode\u003E 存储了长为 \u003Ccode\u003En\u003C\u002Fcode\u003E 的杆的最佳方案，但在最开始，所有位置都是 \u003Ccode\u003Enull\u003C\u002Fcode\u003E 。不过每次在 \u003Ccode\u003ErodCut\u003C\u002Fcode\u003E 返回计算结果之前，都会顺带着将它写入到这个缓存的对应位置内。\u003C\u002Fp\u003E\n\u003Cp\u003E在后续的递归调用中，程序优先从查找缓存的对应位置：如果该位置非 \u003Ccode\u003Enull\u003C\u002Fcode\u003E，则意味着当前调用能够立刻返回计算结果，而非重新计算。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Edef rodCuts_cached\n\nrodCuts_cached = {\n\n    Integer[] rod_prices, Integer length, Plan[] cache -\u003E\n\n        if (cache[length] != null) return cache[length]\n        if (length == 0) return new Plan(amount: 0, splits: [])\n        def max = new Plan(amount: 0, splits: [])\n\n        for (i in 1..length) {\n            def leftRod = rodCuts_cached(rod_prices, length - i, cache)\n            def try_ = new Plan(amount: rod_prices[i] + leftRod.amount, splits: leftRod.splits + i)\n            if (try_.amount \u003E max.amount) {\n                max = try_\n            }\n        }\n        \u002F\u002F 记录当前最优解。\n        \u002F\u002F 注意，传入的 cache 是引用，这意味着任意一处递归都能够随时感知 cache 的变化。\n        cache[length] = max\n        return max\n}\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E依照这个思路，我们重新给出了第三版代码。在同等运行条件下，它的运算时间只相当于第二版的 1%。\u003C\u002Fp\u003E\n\u003Cp\u003E这个套路其实和之前 n 阶乘的优化思路非常相像，那就是想方设法保存中间结果来节省后续递归的工作量，无论从形式上是值传递一个计算结果，还是引用传递一块缓存。如果为这个套路起一个专业点的名字，那么它就是 \u003Cstrong\u003E记忆化\u003C\u002Fstrong\u003E ( Memoization ) 。\u003C\u002Fp\u003E\n\u003Ch3 data-id=\"heading-11\"\u003E4.8.2 画龙点睛之 memoize()\u003C\u002Fh3\u003E\n\u003Cp\u003E我们已经从实例中理解并体会了函数记忆化带来的性能飞跃，体贴的 Groovy 同样也更理解我们。在其它语言中，我们可能会为了实现缓存而手写一段逻辑代码 ( 像第三版代码那样 ) 。但至少在 Groovy 中，实际的工作量就是在原有闭包的基础之上再补充上一个 \u003Ccode\u003Emomonize()\u003C\u002Fcode\u003E 方法调用。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs language-groovy copyable\" lang=\"groovy\"\u003Edef rodCuts\nrodCut = {\n    rod_prices, length -\u003E\n        if (length == 0) return new Plan(amount: 0, splits: [])\n        def max = new Plan(amount: -1, splits: [])\n        for (i in 1..length) {\n            def leftRod = rodCuts(rod_prices, length - i)\n            def try_ = new Plan(amount: rodPrices[i] + leftRod.amount, splits: leftRod.splits + i)\n            if (try_.amount \u003E max.amount) max = try_\n        }\n        return max\n}.memoize()\n\u003Cspan class=\"copy-code-btn\"\u003E复制代码\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EGroovy 会为此创建一个自带缓存空间的闭包，然后就像我们所做的一样，闭包在递归自身时会优先从缓存中读取运算结果，除此之外，Groovy 还考虑到了一些线程安全的内容。由于机制大体相同，因此这一版的运行效率跟第三版代码几乎差不多，而区别是 \"我们操心的活变得更少了\"。\u003C\u002Fp\u003E\n\u003Cp\u003E根据天下没有免费的午餐定理，争取运算时间的代价将是牺牲或多或少的空间。如果问题的规模变得夸张一些，那么对空间的占用就无法忽略 ( 尤其是在本例中，Plan 还是一个携带链表的类 ) 。Groovy 将选择的权利交给了我们，因此 \u003Ccode\u003Ememonized()\u003C\u002Fcode\u003E 还衍生出了 \u003Ccode\u003EmemonizeAtMost()\u003C\u002Fcode\u003E 方法以及其它变种。当缓存达到临界状态时，Groovy 采取 LRU ( Least Last Used ) 策略对缓存内容进行替换。\u003C\u002Fp\u003E",showSidebar:a,actionType:{FETCH:"view\u002Fcolumn\u002FFETCH",FETCH_CACHED_HTML:"view\u002Fcolumn\u002FFETCH_CACHED_HTML",FETCH_ADDITIONAL:"view\u002Fcolumn\u002FFETCH_ADDITIONAL",FETCH_SIDEBAR_ADENTRY:"view\u002Fcolumn\u002FFETCH_SIDEBAR_ADENTRY",FETCH_AUTHOR_EXTRA:"view\u002Fcolumn\u002FFETCH_AUTHOR_EXTRA",RESET:"view\u002Fcolumn\u002FRESET"},recommendedArticleList:{list:[],cursor:f,loading:a,skeleton:a,hasMore:a,articleId:e,actionType:{UPDATE_STATE:"view\u002Fcolumn\u002Frecommend-List\u002FUPDATE_STATE",FETCH_MORE:"view\u002Fcolumn\u002Frecommend-List\u002FFETCH_MORE",FETCH:"view\u002Fcolumn\u002Frecommend-List\u002FFETCH",RESET:"view\u002Fcolumn\u002Frecommend-List\u002FRESET"}}},collection:{collection:{author:{}},actionType:{FETCH:"@\u002Fview\u002Fcollection\u002FFETCH",REFRESH:"@\u002Fview\u002Fcollection\u002FREFRESH",RESET:"@\u002Fview\u002Fcollection\u002FRESET"},list:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fcollection\u002Flist\u002FUPDATE",FETCH:"@\u002Fview\u002Fcollection\u002Flist\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fcollection\u002Flist\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fcollection\u002Flist\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fcollection\u002Flist\u002FRESET"},id:e,sort:m}},gettingStarted:{category:{},actionType:{UPDATE_STATE:"@\u002Fview\u002FgettingStarted\u002FUPDATE_STATE",FOLLOW:"@\u002Fview\u002FgettingStarted\u002FFOLLOW",RESET:"@\u002Fview\u002FgettingStarted\u002FRESET",UPDATE_CATEGORY:"@\u002Fview\u002FgettingStarted\u002FUPDATE_CATEGORY"}},pin:{pin:{user:{},imageUrlList:[]},pinList:[],actionType:{FETCH:"@\u002Fview\u002Fpin\u002FFETCH",RESET:"@\u002Fview\u002Fpin\u002FRESET"},sidebar:{list:[],after:e,loading:a,isRecommend:a,hasNextPage:b,actionType:{UPDATE_STATE:"@\u002Fview\u002Fpin\u002Fsidebar\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fpin\u002Fsidebar\u002FFETCH_MORE",FETCH:"@\u002Fview\u002Fpin\u002Fsidebar\u002FFETCH",RESET:"@\u002Fview\u002Fpin\u002Fsidebar\u002FRESET"}},commentList:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fpin\u002FcommentList\u002FUPDATE",FETCH:"@\u002Fview\u002Fpin\u002FcommentList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fpin\u002FcommentList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fpin\u002FcommentList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fpin\u002FcommentList\u002FRESET"},pinId:c},subCommentList:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FUPDATE",FETCH:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FRESET"},commentId:c}},topic:{topic:e,followedTopicList:[],actionType:{FETCH:"@\u002Fview\u002Ftopic\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Ftopic\u002FUPDATE_STATE",RESET:"@\u002Fview\u002Ftopic\u002FRESET"},allTopicList:{pageSize:x,page:d,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FUPDATE",FETCH:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FRESET"},sortType:l},pinlist:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Ftopic\u002FpinList\u002FUPDATE",FETCH:"@\u002Fview\u002Ftopic\u002FpinList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Ftopic\u002FpinList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Ftopic\u002FpinList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Ftopic\u002FpinList\u002FRESET"},sortType:t},sidebar:{actionType:{RESET:"@\u002Fview\u002Ftopic\u002Fsidebar\u002FRESET",UPDATE_STATE:"@\u002Fview\u002Ftopic\u002Fsidebar\u002FUPDATE_STATE"},attender:{pageSize:h,page:g,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FUPDATE",FETCH:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FFETCH_MORE",RESET:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FRESET"},topicId:c}},followedList:{pageSize:x,page:d,total:d,pointer:c,lastPointer:c,list:[],loading:a,error:c,canPrev:b,canNext:b,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FUPDATE",FETCH:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FRESET"},after:d}},recommendationIndex:{actionType:{FETCH_USER:"@\u002Fview\u002Frecommendation\u002FFETCH_USER",FETCH_MORE:"@\u002Fview\u002Frecommendation\u002FFETCH_MORE",RESET:"@\u002Fview\u002Frecommendation\u002FRESET",FETCH:"@\u002Fview\u002Frecommendation\u002FFETCH"},cursor:e,hasMore:e,userList:[],loading:a,skeleton:b,category:k,categoryNavList:[],serverRenderUserList:a},event:{event:{},loading:a,user:{},actionType:{FETCH:"view\u002Fevent\u002FFETCH",RESET:"view\u002Fevent\u002FRESET"}},academyIndex:{academy:{},bannerList:[],qualitiedList:[],latestList:[],offlineList:[],loading:a,user:{},actionType:{FETCH:"view\u002Facademy\u002FFETCH",RESET:"view\u002Facademy\u002FRESET"}},coursesIndex:{loading:a,list:[],sort:"online",actionType:{FETCH:"view\u002Fcourses\u002FFETCH",RESET:"view\u002Fcourses\u002FRESET",FETCH_MORE:"view\u002Fcourses\u002FFETCH_MORE"}},team:{team:{},loading:b,actionType:{FETCH:"@\u002Fview\u002Fteam\u002FFETCH",RESET:"@\u002Fview\u002Fteam\u002FRESET",UPDATE:"@\u002Fview\u002Fteam\u002FUPDATE",FOLLOW:"@\u002Fview\u002Fteam\u002FFOLLOW"},detailList:{actionType:{RESET:"@\u002Fview\u002Fteam\u002FdetailList\u002FRESET"},posts:{list:[],hasMore:a,skeleton:a,loading:a,sort:m,actionType:{FETCH:"@\u002Fview\u002Fteam\u002FdetailList\u002Fposts\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fteam\u002FdetailList\u002Fposts\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fteam\u002FdetailList\u002Fposts\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fteam\u002FdetailList\u002Fposts\u002FRESET"}},pins:{list:[],hasMore:a,loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fteam\u002FdetailList\u002Fpins\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fteam\u002FdetailList\u002Fpins\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fteam\u002FdetailList\u002Fpins\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fteam\u002FdetailList\u002Fpins\u002FRESET"}},hire:{list:[],hasMore:a,cursor:f,loading:a,skeleton:b,actionType:{FETCH:"@\u002Fview\u002Fteam\u002FdetailList\u002Fhire\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fteam\u002FdetailList\u002Fhire\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fteam\u002FdetailList\u002Fhire\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fteam\u002FdetailList\u002Fhire\u002FRESET"}}}},couponList:{list:{"0":u,"1":u,"2":u}},payment:{selectedDiscount:{},bookletDetail:{},coupons:{availables:[],unavailables:[]}}},component:{indexAside:{bannerList:[],userList:[],actionType:{FETCH_BANNER:"@\u002Fcomponent\u002Faside\u002FFETCH_BANNER",FETCH_USER:"@\u002Fcomponent\u002Faside\u002FFETCH_USER",CLOSE_BANNER:"@\u002Fcomponent\u002Faside\u002FCLOSE_BANNER"}}},ore:{oreCount:d},avatarMenuInfo:{},common:{theme:"light"},env:{ua:"Mozilla\u002F5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F107.0.0.0 Safari\u002F537.36",serverEnv:"production"},auth:{user:c,clientId:e,token:e},tag:{subscribedTagList:[]},entry:{isLikeLoading:a},collection:{},comment:{},bookComment:{},repoComment:{},category:{list:[]},user:{subscribedTagList:[]},notification:{unreadCount:{user:d,system:d,total:d}},follow:{subscribedTagList:[]},error:{location:c,errorView:c,statusCode:200},abTest:{info:{}},suspensionPanel:{needSuspension:b},pinComment:{},pin:{deleteDialogVisible:a,reportDialogVisible:a,targetPin:c,isOnFocus:a},topic:{visible:a},activity:{"2020":{},offer:{is_show:d,start_time:d},voteData:{err_no:d,err_msg:"success",data:{face:{title:e,activity_id:"2024",start_time:1657814400,end_time:1668787200,status:n,image:"https:\u002F\u002Fp9-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002Fd4bdb22a62c64ebd9eadc0646d5b6a53~tplv-k3u1fbpfcp-zoom-1.image",close_image:"https:\u002F\u002Fp3-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002F882fc263e36347ffbf6d598de520870e~tplv-k3u1fbpfcp-image.image",url:"https:\u002F\u002Fjuejin.cn\u002Fmagic\u002Feco\u002Fruntime\u002Frelease\u002F636c6d57dd25b303e84121e9?appType=juejin&magic_page_no=1",is_show:d},top:{title:o,activity_id:p,start_time:q,end_time:r,status:g,image:"https:\u002F\u002Fp1-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002Fac22d16bd96248f48b9f63ab747a1e04~tplv-k3u1fbpfcp-zoom-1.image",close_image:"https:\u002F\u002Fp1-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002F4e7fb9a08a1d4f13889588806b35d2ba~tplv-k3u1fbpfcp-zoom-1.image?",url:"https:\u002F\u002Fjuejin.cn\u002Fchallenge\u002F1?utm_source=app_nav",is_show:g},web_top:{title:o,activity_id:p,start_time:q,end_time:r,status:g,image:j,close_image:j,url:"https:\u002F\u002Fjuejin.cn\u002Fchallenge\u002F1?utm_source=web_nav",is_show:g},plugin_top:{title:o,activity_id:p,start_time:q,end_time:r,status:g,image:j,close_image:j,url:"https:\u002F\u002Fjuejin.cn\u002Fchallenge\u002F1?utm_source=extension_nav",is_show:g},search_top:{title:"我的2021年度报告",activity_id:y,start_time:z,end_time:1642348799,status:n,image:A,close_image:B,url:"https:\u002F\u002Fjuejin.cn\u002Freport2021\u002Fmobile?utm_campaign=report_2021&utm_medium=app_search&share_title=2021%E6%8E%98%E5%8F%8B%E5%B9%B4%E5%BA%A6%E6%8A%A5%E5%91%8A&share_desc=%E8%A7%A3%E9%94%81%E5%B9%B4%E5%BA%A6%E6%8A%A5%E5%91%8A%EF%BC%8C%E9%A2%86%E5%8F%96%E4%B8%93%E5%B1%9E%E5%BE%BD%E7%AB%A0&share_image=https%3A%2F%2Fp9-juejin.byteimg.com%2Ftos-cn-i-k3u1fbpfcp%2F26a9012785e643a6a520ed63b513c57e~tplv-k3u1fbpfcp-image.image",is_show:d},web_search:{title:"字节内部课会员免费学",activity_id:y,start_time:z,end_time:1664121599,status:n,image:A,close_image:B,url:"https:\u002F\u002Fjuejin.cn\u002Fpost\u002F7143435263472041998?utm_source=search&utm_medium=OM&utm_campaign=vip_activity_kxj",is_show:d},jcode_top:{title:o,activity_id:p,start_time:q,end_time:r,status:g,image:j,close_image:j,url:"https:\u002F\u002Fjuejin.cn\u002Fchallenge\u002F1?utm_source=code_nav",is_show:g},offer:{title:e,activity_id:"2020",start_time:1617638400,end_time:1618934400,status:n,image:"https:\u002F\u002Fp9-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002F2879410508de459c91ae8b7509ca75f8~tplv-k3u1fbpfcp-zoom-1.image",close_image:"https:\u002F\u002Fp9-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002Fa38d640009e14c87a7d29cd95dee27dd~tplv-k3u1fbpfcp-zoom-1.image",url:"https:\u002F\u002Fjuejin-activity.bytedance.net\u002Frank",is_show:d}}}},header:{leadStep:d,isPopupZlink:a},tcc:{tccConfig:c},route:{name:"column",path:v,hash:e,query:{},params:{id:w},fullPath:v,meta:{},from:{name:c,path:C,hash:e,query:{},params:{},fullPath:C,meta:{}}}},serverRendered:b,routePath:v,config:{API_HOST:"api.juejin.cn",CAPTCHA_HOST:"verify.snssdk.com",PLATFORM_APPID:{wechat:1277,weibo:1276,github:1045,wechatApp:1070},SCM_VERSION:"1.0.0.5937",http:{}},globalRefs:{}}}(false,true,null,0,"","0",1,20,"topic","https:\u002F\u002Fp6-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002F759e2aa805c0461b840e0f0f09ed05fa~tplv-k3u1fbpfcp-zoom-1.image?","recommended","hot","newest",2,"1024 码上掘金编程挑战赛","2022",1666540800,1669823999,"following","popular",{},"\u002Fpost\u002F6956793861570035742","6956793861570035742",100,"2021",1641780000,"https:\u002F\u002Fp3-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002Fa06289e83d9640c4b8504d2626cfbbee~tplv-k3u1fbpfcp-image.image","https:\u002F\u002Fp9-juejin.byteimg.com\u002Ftos-cn-i-k3u1fbpfcp\u002Fe5199830276c4a85bc7c8cb8edecd54d~tplv-k3u1fbpfcp-image.image","\u002F"));</script><script src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/1962f0f.js.下载" defer=""></script><script src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/7e1140b.js.下载" defer=""></script><script src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/7b24b05.js.下载" defer=""></script><script src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/8abf2a2.js.下载" defer=""></script><script src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/2d95a65.js.下载" defer=""></script><script src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/4809dd4.js.下载" defer=""></script><script src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/def72f5.js.下载" defer=""></script>
  

<link href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/51.8344ef6.css" rel="stylesheet" type="text/css"><link href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/default.2050f18.css" rel="stylesheet" type="text/css"><div data-transfer="true" class="collection-list-modal byte-modal v-transfer-dom" data-v-6bd26e03="" data-v-b7c4e7d2=""><div class="byte-modal__mask" style="z-index: 1000; display: none;"></div><div class="byte-modal__wrapper" style="z-index: 1000; display: none;"><div class="byte-modal__content" style="width:520px;"><!----><div class="byte-modal__body"></div><!----></div></div></div><div data-v-6bd26e03="" data-v-4fa94e66="" data-transfer="true" class="collection-list-modal byte-modal v-transfer-dom"><div class="byte-modal__mask" style="z-index: 1001; display: none;"></div><div class="byte-modal__wrapper" style="z-index: 1001; display: none;"><div class="byte-modal__content" style="width: 520px;"><!----><div class="byte-modal__body"></div><!----></div></div></div><link href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/134.092fb39.css" rel="stylesheet" type="text/css"><link href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/177.290e99d.css" rel="stylesheet" type="text/css"><link href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/22.f94fff0.css" rel="stylesheet" type="text/css"><div data-v-41eefe39="" data-transfer="true" class="lead byte-modal v-transfer-dom"><div class="byte-modal__mask" style="z-index: 1002; display: none;"></div><div class="byte-modal__wrapper" style="z-index: 1002; display: none;"><div class="byte-modal__content" style="width: 500px;"><div class="byte-modal__header"><img data-v-41eefe39="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/MaskGroup.13dfc4f.png" alt="" loading="lazy" class="header-bgc"> <span data-v-41eefe39="" class="header-title">选择你感兴趣的技术方向</span><span aria-label="Close" class="byte-modal__headerbtn"><i class="byte-icon byte-icon--close"><svg t="1561638608887" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="441911" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M512 448l288-288c6.4-6.4 19.2-6.4 32 0l25.6 32c6.4 6.4 6.4 19.2 0 32L569.6 505.6l288 288c6.4 6.4 6.4 19.2 0 32l-32 32c-6.4 6.4-19.2 6.4-32 0L512 569.6l-288 288c-6.4 6.4-19.2 6.4-32 0l-32-32c-6.4-6.4-6.4-19.2 0-32L448 505.6 160 224c-6.4-12.8-6.4-25.6 0-32l32-32c6.4-6.4 19.2-6.4 32 0L512 448z" p-id="441912"></path><path d="M512 448l288-288c6.4-6.4 19.2-6.4 32 0l25.6 32c6.4 6.4 6.4 19.2 0 32L569.6 505.6l288 288c6.4 6.4 6.4 19.2 0 32l-32 32c-6.4 6.4-19.2 6.4-32 0L512 569.6l-288 288c-6.4 6.4-19.2 6.4-32 0l-32-32c-6.4-6.4-6.4-19.2 0-32L448 505.6 160 224c-6.4-12.8-6.4-25.6 0-32l32-32c6.4-6.4 19.2-6.4 32 0L512 448z" p-id="441913"></path></svg></i></span></div><div class="byte-modal__body"> <div data-v-41eefe39="" class="classify-box"><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><path data-v-41eefe39="" id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M2 2.5C1.44772 2.5 1 2.94772 1 3.5V11.5C1 12.0523 1.44772 12.5 2 12.5H14C14.5523 12.5 15 12.0523 15 11.5V3.5C15 2.94772 14.5523 2.5 14 2.5H2ZM4.5 7.5C4.22386 7.5 4 7.72386 4 8V10C4 10.2761 4.22386 10.5 4.5 10.5H5C5.27614 10.5 5.5 10.2761 5.5 10V8C5.5 7.72386 5.27614 7.5 5 7.5H4.5ZM7 5.5C7 5.22386 7.22386 5 7.5 5H8C8.27614 5 8.5 5.22386 8.5 5.5V10C8.5 10.2761 8.27614 10.5 8 10.5H7.5C7.22386 10.5 7 10.2761 7 10V5.5ZM10.5 6.5C10.2239 6.5 10 6.72386 10 7V10C10 10.2761 10.2239 10.5 10.5 10.5H11C11.2761 10.5 11.5 10.2761 11.5 10V7C11.5 6.72386 11.2761 6.5 11 6.5H10.5Z" fill="#86909C"></path><rect data-v-41eefe39="" id="Rectangle 282" x="3" y="13.5" width="10" height="1.3" rx="0.5" fill="#86909C"></rect></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              后端
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><path data-v-41eefe39="" id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M2 2.5C1.44772 2.5 1 2.94772 1 3.5V6.5H15V3.5C15 2.94772 14.5523 2.5 14 2.5H2ZM15 7.8H1V13.5C1 14.0523 1.44772 14.5 2 14.5H14C14.5523 14.5 15 14.0523 15 13.5V7.8ZM8.65811 8.52566C8.92009 8.61298 9.06167 8.89614 8.97434 9.15811L7.97434 12.1581C7.88702 12.4201 7.60386 12.5617 7.34189 12.4743C7.07991 12.387 6.93833 12.1039 7.02566 11.8419L8.02566 8.84189C8.11298 8.57991 8.39614 8.43833 8.65811 8.52566ZM3.5 5.5C3.77614 5.5 4 5.27614 4 5C4 4.72386 3.77614 4.5 3.5 4.5C3.22386 4.5 3 4.72386 3 5C3 5.27614 3.22386 5.5 3.5 5.5ZM5.5 5C5.5 5.27614 5.27614 5.5 5 5.5C4.72386 5.5 4.5 5.27614 4.5 5C4.5 4.72386 4.72386 4.5 5 4.5C5.27614 4.5 5.5 4.72386 5.5 5ZM6.5 5.5C6.77614 5.5 7 5.27614 7 5C7 4.72386 6.77614 4.5 6.5 4.5C6.22386 4.5 6 4.72386 6 5C6 5.27614 6.22386 5.5 6.5 5.5ZM6.44721 9.27639C6.57071 9.52338 6.4706 9.82372 6.22361 9.94721L5.11803 10.5L6.22361 11.0528C6.4706 11.1763 6.57071 11.4766 6.44721 11.7236C6.32372 11.9706 6.02338 12.0707 5.77639 11.9472L3.77639 10.9472C3.607 10.8625 3.5 10.6894 3.5 10.5C3.5 10.3106 3.607 10.1375 3.77639 10.0528L5.77639 9.05279C6.02338 8.92929 6.32372 9.0294 6.44721 9.27639ZM9.77639 9.94721C9.5294 9.82372 9.42929 9.52338 9.55279 9.27639C9.67628 9.0294 9.97662 8.92929 10.2236 9.05279L12.2236 10.0528C12.393 10.1375 12.5 10.3106 12.5 10.5C12.5 10.6894 12.393 10.8625 12.2236 10.9472L10.2236 11.9472C9.97662 12.0707 9.67628 11.9706 9.55279 11.7236C9.42929 11.4766 9.5294 11.1763 9.77639 11.0528L10.882 10.5L9.77639 9.94721Z" fill="#86909C"></path></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              前端
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><rect data-v-41eefe39="" id="Rectangle 287" x="5.7002" y="12.5" width="1.3" height="3" rx="0.5" fill="#86909C"></rect><rect data-v-41eefe39="" id="Rectangle 289" x="1" y="6.5" width="1.3" height="6" rx="0.5" fill="#86909C"></rect><rect data-v-41eefe39="" id="Rectangle 290" x="13.7002" y="6.5" width="1.3" height="6" rx="0.5" fill="#86909C"></rect><rect data-v-41eefe39="" id="Rectangle 288" x="9" y="12.5" width="1.3" height="3" rx="0.5" fill="#86909C"></rect><path data-v-41eefe39="" id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M13 5.86364V12.5C13 13.0523 12.5523 13.5 12 13.5H4C3.44772 13.5 3 13.0523 3 12.5V5.86364V5.77273C3 5.74067 3.00151 5.70897 3.00446 5.67768C3.11608 3.35397 5.30996 1.5 8 1.5C10.69 1.5 12.8839 3.35397 12.9955 5.67768C12.9985 5.70897 13 5.74067 13 5.77273V5.86364ZM7 6.25C7 6.66421 6.66421 7 6.25 7C5.83579 7 5.5 6.66421 5.5 6.25C5.5 5.83579 5.83579 5.5 6.25 5.5C6.66421 5.5 7 5.83579 7 6.25ZM9.75 7C10.1642 7 10.5 6.66421 10.5 6.25C10.5 5.83579 10.1642 5.5 9.75 5.5C9.33579 5.5 9 5.83579 9 6.25C9 6.66421 9.33579 7 9.75 7Z" fill="#86909C"></path></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              Android
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39=""><g data-v-41eefe39="" id="pingguo-2 1"><path data-v-41eefe39="" id="Vector" d="M11.821 8.9388C11.8035 7.16562 13.267 6.31556 13.3322 6.27312C12.5097 5.06956 11.2287 4.90506 10.7724 4.88581C9.6821 4.77556 8.64523 5.52763 8.09179 5.52763C7.5401 5.52763 6.6861 4.902 5.78179 4.91863C4.59354 4.93613 3.49761 5.60944 2.88598 6.67387C1.65136 8.8163 2.56967 11.9899 3.77323 13.7277C4.36123 14.5782 5.06254 15.5332 5.98304 15.4991C6.86942 15.4637 7.20498 14.9255 8.27642 14.9255C9.34785 14.9255 9.64929 15.4991 10.5877 15.4816C11.5415 15.4637 12.1461 14.6149 12.7302 13.7618C13.4052 12.7752 13.6835 11.8197 13.6997 11.7707C13.6787 11.7611 11.8394 11.0567 11.821 8.9388ZM10.0584 3.73563C10.547 3.14281 10.8769 2.32031 10.7868 1.5C10.0829 1.52888 9.22973 1.969 8.72485 2.56006C8.2716 3.08463 7.87523 3.922 7.98154 4.72613C8.76729 4.78737 9.56923 4.32669 10.0584 3.73563Z" fill="#86909C"></path></g></g><defs data-v-41eefe39=""></defs></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              iOS
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><rect data-v-41eefe39="" id="Rectangle 289" x="1" y="8.5" width="1.3" height="5" rx="0.5" fill="#86909C"></rect><rect data-v-41eefe39="" id="Rectangle 292" x="14" y="8.5" width="1.3" height="5" rx="0.5" fill="#86909C"></rect><rect data-v-41eefe39="" id="Rectangle 293" x="7.5" y="4.5" width="1" height="3" rx="0.5" fill="#86909C"></rect><circle data-v-41eefe39="" id="Ellipse 25" cx="8" cy="2.5" r="1" fill="#86909C"></circle><path data-v-41eefe39="" id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M3 7.5C3 6.94772 3.44772 6.5 4 6.5H12C12.5523 6.5 13 6.94772 13 7.5V14.5C13 15.0523 12.5523 15.5 12 15.5H4C3.44772 15.5 3 15.0523 3 14.5V7.5ZM7 11.25C7 11.6642 6.66421 12 6.25 12C5.83579 12 5.5 11.6642 5.5 11.25C5.5 10.8358 5.83579 10.5 6.25 10.5C6.66421 10.5 7 10.8358 7 11.25ZM9.75 12C10.1642 12 10.5 11.6642 10.5 11.25C10.5 10.8358 10.1642 10.5 9.75 10.5C9.33579 10.5 9 10.8358 9 11.25C9 11.6642 9.33579 12 9.75 12Z" fill="#86909C"></path></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              人工智能
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><g data-v-41eefe39="" id="kaifagongjuicon-hui 1"><path data-v-41eefe39="" id="Vector" d="M14.212 5.04986L13.497 5.76886C13.3158 5.95088 13.1005 6.09531 12.8633 6.19386C12.6261 6.29242 12.3718 6.34315 12.115 6.34315C11.8582 6.34315 11.6039 6.29242 11.3667 6.19386C11.1295 6.09531 10.9142 5.95088 10.733 5.76886C10.3664 5.39915 10.1606 4.89955 10.1606 4.37886C10.1606 3.85817 10.3664 3.35857 10.733 2.98886L11.448 2.26986C11.843 1.87286 11.579 1.40486 10.868 1.51686C10.028 1.64786 9.262 2.07586 8.709 2.72286C8.005 3.41786 7.682 4.66486 7.922 5.81786L1.927 11.8469C1.56096 12.2165 1.35562 12.7157 1.35562 13.2359C1.35562 13.7561 1.56096 14.2552 1.927 14.6249C2.10804 14.807 2.32329 14.9515 2.56038 15.0501C2.79747 15.1487 3.05172 15.1995 3.3085 15.1995C3.56528 15.1995 3.81953 15.1487 4.05662 15.0501C4.29371 14.9515 4.50896 14.807 4.69 14.6249L10.686 8.59486C11.2693 8.7189 11.8745 8.69473 12.446 8.52459C13.0176 8.35444 13.5375 8.04373 13.958 7.62086C14.5581 7.01861 14.9243 6.22244 14.991 5.37486C15.071 4.91886 14.607 4.65286 14.212 5.04986ZM3.768 13.6979C3.67659 13.7885 3.56041 13.85 3.4341 13.8747C3.30779 13.8994 3.17699 13.8861 3.05819 13.8366C2.93939 13.7871 2.8379 13.7036 2.76651 13.5965C2.69511 13.4894 2.65701 13.3636 2.657 13.2349C2.65647 13.0618 2.72462 12.8957 2.84649 12.7729C2.96836 12.6501 3.13399 12.5807 3.307 12.5799C3.487 12.5799 3.651 12.6529 3.768 12.7719C3.888 12.8889 3.96 13.0539 3.96 13.2349C3.9604 13.3209 3.94363 13.4062 3.91066 13.4857C3.87769 13.5652 3.82919 13.6373 3.768 13.6979ZM3.118 5.16786L5.377 7.43986L6.297 6.51286L4.04 4.24286L3.535 3.27086L1.92 2.11186L1 3.03986L2.151 4.66086L3.118 5.16786ZM10.672 9.98586C10.642 9.95526 10.6062 9.93095 10.5667 9.91436C10.5272 9.89776 10.4848 9.88921 10.442 9.88921C10.3992 9.88921 10.3568 9.89776 10.3173 9.91436C10.2778 9.93095 10.242 9.95526 10.212 9.98586L8.83 11.3759C8.79955 11.4062 8.7754 11.4423 8.75891 11.482C8.74243 11.5218 8.73395 11.5644 8.73395 11.6074C8.73395 11.6504 8.74243 11.693 8.75891 11.7327C8.7754 11.7724 8.79955 11.8085 8.83 11.8389L12.09 15.1169C12.2106 15.2383 12.3541 15.3348 12.5122 15.4006C12.6703 15.4663 12.8398 15.5002 13.011 15.5002C13.1822 15.5002 13.3517 15.4663 13.5098 15.4006C13.6679 15.3348 13.8114 15.2383 13.932 15.1169C14.442 14.6049 14.442 13.7769 13.932 13.2639L10.672 9.98586Z" fill="#86909C"></path></g></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              开发工具
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><path data-v-41eefe39="" id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M1 2.5C1 1.94772 1.44772 1.5 2 1.5H14C14.5523 1.5 15 1.94772 15 2.5V14.5C15 15.0523 14.5523 15.5 14 15.5H2C1.44772 15.5 1 15.0523 1 14.5V2.5ZM3 5C3 4.72386 3.22386 4.5 3.5 4.5H12.5C12.7761 4.5 13 4.72386 13 5V5.3C13 5.57614 12.7761 5.8 12.5 5.8H3.5C3.22386 5.8 3 5.57614 3 5.3V5ZM3.5 7.5C3.22386 7.5 3 7.72386 3 8V8.3C3 8.57614 3.22386 8.8 3.5 8.8H4.5C4.77614 8.8 5 8.57614 5 8.3V8C5 7.72386 4.77614 7.5 4.5 7.5H3.5ZM7 8C7 7.72386 7.22386 7.5 7.5 7.5H8.5C8.77614 7.5 9 7.72386 9 8V8.3C9 8.57614 8.77614 8.8 8.5 8.8H7.5C7.22386 8.8 7 8.57614 7 8.3V8ZM11.5 7.5C11.2239 7.5 11 7.72386 11 8V8.3C11 8.57614 11.2239 8.8 11.5 8.8H12.5C12.7761 8.8 13 8.57614 13 8.3V8C13 7.72386 12.7761 7.5 12.5 7.5H11.5ZM3 11C3 10.7239 3.22386 10.5 3.5 10.5H7.5C7.77614 10.5 8 10.7239 8 11V11.3C8 11.5761 7.77614 11.8 7.5 11.8H3.5C3.22386 11.8 3 11.5761 3 11.3V11ZM10.5 10.5C10.2239 10.5 10 10.7239 10 11V11.3C10 11.5761 10.2239 11.8 10.5 11.8H12.5C12.7761 11.8 13 11.5761 13 11.3V11C13 10.7239 12.7761 10.5 12.5 10.5H10.5Z" fill="#86909C"></path></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              代码人生
            </span></div></div></div><div data-v-41eefe39="" class="technology-box"><div data-v-41eefe39="" class="wrap"><svg data-v-41eefe39="" width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" class="left"><g data-v-41eefe39="" id="&amp;#230;&amp;#161;&amp;#136;&amp;#228;&amp;#190;&amp;#139;"><path data-v-41eefe39="" id="Subtract" fill-rule="evenodd" clip-rule="evenodd" d="M14.9187 7.03385C15.0999 7.26744 14.9466 7.7 14.651 7.7H6.32905V4.5H5.02905V7.7H3.6C2.16406 7.7 1 6.53594 1 5.1C1 3.66406 2.16406 2.5 3.6 2.5H14.651C14.9466 2.5 15.0999 2.93257 14.9188 3.16616C14.5064 3.69779 14.2602 4.36959 14.2602 5.10001C14.2602 5.83043 14.5064 6.50222 14.9187 7.03385Z" fill="#86909C"></path><path data-v-41eefe39="" id="Subtract_2" fill-rule="evenodd" clip-rule="evenodd" d="M1.34902 14.5008C1.0534 14.5008 0.900077 14.0682 1.08126 13.8346C1.49363 13.303 1.7398 12.6312 1.7398 11.9008C1.7398 11.1704 1.49362 10.4986 1.08125 9.96694C0.900064 9.73335 1.05339 9.30078 1.34901 9.30078H12.4C13.8359 9.30078 15 10.4648 15 11.9008C15 13.3367 13.8359 14.5008 12.4 14.5008H1.34902Z" fill="#86909C"></path></g></svg> <div data-v-41eefe39="" class="right"><span data-v-41eefe39="" class="descrip">
              阅读
            </span></div></div></div></div> <!----></div><div class="byte-modal__footer"><div data-v-41eefe39="" class="left">跳过</div> <div data-v-41eefe39="" class="mid" style="display: none;">上一步</div> <div data-v-41eefe39="" class="right">
      至少选择1个分类
    </div></div></div></div></div><div data-v-8bb78912="" data-transfer="true" class="upgrade-new-modal byte-modal v-transfer-dom"><div class="byte-modal__mask" style="z-index: 1003; display: none;"></div><div class="byte-modal__wrapper" style="z-index: 1003; display: none;"><div class="byte-modal__content" style="width: 311px;"><div class="byte-modal__header"><span class="byte-modal__title"></span><!----></div><div class="byte-modal__body"> <!----> <div data-v-8bb78912="" class="close-icon"><img data-v-8bb78912="" src="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/8867e249c23a7c0ea596c139befc04d7.svg" alt=""></div></div><!----></div></div></div><link href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/36.6f090be.css" rel="stylesheet" type="text/css"><link href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/153.4faa841.css" rel="stylesheet" type="text/css"><link href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/9.4cd501f.css" rel="stylesheet" type="text/css"><link href="./如何用 Groovy 闭包优雅地 FP 编程？ - 掘金_files/83.ca68669.css" rel="stylesheet" type="text/css"></body><div style="all: initial;"><div id="__hcfy__" style="all: initial;"></div></div></html>